[0m17:31:44.106920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6ab5b6fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6ab5b9fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6ab5b5cf50>]}


============================== 17:31:44.112949 | ac1ee546-589e-43fc-93d0-77ec78a8bda9 ==============================
[0m17:31:44.112949 [info ] [MainThread]: Running with dbt=1.7.13
[0m17:31:44.114015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:31:44.118364 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_profile'
[0m17:31:44.120549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6ab5f45990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6aba278d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6ab5b6bf90>]}
[0m17:31:44.121498 [debug] [MainThread]: Flushing usage events
[0m17:32:39.348844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ccbe462e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ccbe460110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ccbe461050>]}


============================== 17:32:39.353548 | 689b9fa7-bb28-462e-8750-42ee86e45102 ==============================
[0m17:32:39.353548 [info ] [MainThread]: Running with dbt=1.7.13
[0m17:32:39.354651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/peon/.dbt', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:32:39.359004 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'my_profile'
[0m17:32:39.360714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ccc2c78d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ccbe44ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ccbe44fed0>]}
[0m17:32:39.361679 [debug] [MainThread]: Flushing usage events
[0m17:36:02.334989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1e5148b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1e520f6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1e5148bd90>]}


============================== 17:36:02.340018 | eb000ac2-3401-4034-b269-0b0856e89201 ==============================
[0m17:36:02.340018 [info ] [MainThread]: Running with dbt=1.7.13
[0m17:36:02.341235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:36:02.345773 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'zap'
[0m17:36:02.347841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1e5145b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1e51459510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1e55ce4250>]}
[0m17:36:02.349148 [debug] [MainThread]: Flushing usage events
[0m17:36:53.852779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7113ee95f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7113ee9af850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7113ee97fa90>]}


============================== 17:36:53.858077 | dac7cccb-fc28-4b98-a7e4-baf12e1c0ffd ==============================
[0m17:36:53.858077 [info ] [MainThread]: Running with dbt=1.7.13
[0m17:36:53.859171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:36:54.297997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dac7cccb-fc28-4b98-a7e4-baf12e1c0ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7113eec39690>]}
[0m17:36:54.435337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dac7cccb-fc28-4b98-a7e4-baf12e1c0ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7113ee239a10>]}
[0m17:36:54.438561 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m17:36:54.464038 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m17:36:54.466002 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:36:54.467696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dac7cccb-fc28-4b98-a7e4-baf12e1c0ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7113ee9b99d0>]}
[0m17:36:54.474218 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading zap_imoveis: marts/sources.yml - Runtime Error
    Syntax error near line 8
    ------------------------------
    5  |     description: >
    6  |     This model contains data about apartments for rent in Sao Paulo.
    7  | 
    8  | sources:
    9  |   - name: zap_imoveis
    10 |     database: foo
    11 |     schema: zapimoveis
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 6, column 5
    could not find expected ':'
      in "<unicode string>", line 8, column 1
[0m17:36:54.476676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7113efc38cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7113eec392d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7113f3065ed0>]}
[0m17:36:54.478057 [debug] [MainThread]: Flushing usage events
[0m17:41:30.571844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa864d98f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa864d9f8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa864d6a0d0>]}


============================== 17:41:30.576508 | b27a7d2e-f829-404a-a47f-efa1c7293d07 ==============================
[0m17:41:30.576508 [info ] [MainThread]: Running with dbt=1.7.13
[0m17:41:30.577642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:41:30.855821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b27a7d2e-f829-404a-a47f-efa1c7293d07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa864621710>]}
[0m17:41:30.993564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b27a7d2e-f829-404a-a47f-efa1c7293d07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa864dcb310>]}
[0m17:41:30.994826 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m17:41:31.008620 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m17:41:31.010108 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:41:31.011175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b27a7d2e-f829-404a-a47f-efa1c7293d07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8646da790>]}
[0m17:41:31.016277 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading zap_imoveis: mart/schema.yml - Runtime Error
    Syntax error near line 7
    ------------------------------
    4  |   - name: gold_apartment_rent.sql
    5  |     description: >
    6  |     This model contains data about apartments for rent in Sao Paulo.
    
    Raw Error:
    ------------------------------
    while scanning a simple key
      in "<unicode string>", line 6, column 5
    could not find expected ':'
      in "<unicode string>", line 7, column 1
[0m17:41:31.018311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8695e4210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa864db2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa864db02d0>]}
[0m17:41:31.019285 [debug] [MainThread]: Flushing usage events
[0m17:42:16.337872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707944f8b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707944ea4390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707944ea78d0>]}


============================== 17:42:16.342482 | 8542cc8c-7dbf-4211-ba8e-85ebfcab3000 ==============================
[0m17:42:16.342482 [info ] [MainThread]: Running with dbt=1.7.13
[0m17:42:16.343713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:42:16.623095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8542cc8c-7dbf-4211-ba8e-85ebfcab3000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079447a8190>]}
[0m17:42:16.760734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8542cc8c-7dbf-4211-ba8e-85ebfcab3000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70794573e150>]}
[0m17:42:16.762010 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m17:42:16.775473 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m17:42:16.776875 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:42:16.777738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8542cc8c-7dbf-4211-ba8e-85ebfcab3000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70794488a450>]}
[0m17:42:18.053219 [error] [MainThread]: Encountered an error:
Compilation Error in model gold_apartment_rent (models/mart/gold_apartment_rent.sql)
  unexpected '}', expected ')'
    line 2
      SELECT * FROM {{ source('zap_imoveis', 'silver_zapimoveis' }}
[0m17:42:18.054903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707944e6f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707944eb9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079447424d0>]}
[0m17:42:18.055768 [debug] [MainThread]: Flushing usage events
[0m17:42:50.126031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ecf635310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ecf635510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ecf635f90>]}


============================== 17:42:50.130832 | f896c0df-3cf2-4210-aaf2-5475cde5a35c ==============================
[0m17:42:50.130832 [info ] [MainThread]: Running with dbt=1.7.13
[0m17:42:50.131916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:42:50.411670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f896c0df-3cf2-4210-aaf2-5475cde5a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ecf6aead0>]}
[0m17:42:50.556178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f896c0df-3cf2-4210-aaf2-5475cde5a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ecf0f3090>]}
[0m17:42:50.557454 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m17:42:50.570634 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m17:42:50.571937 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:42:50.573175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f896c0df-3cf2-4210-aaf2-5475cde5a35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ecefc1dd0>]}
[0m17:42:51.966697 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'gold_apartment_rent.sql' in the 'models' section of file 'models/mart/schema.yml'
[0m17:42:52.084706 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.zap_imoveis.gold_apartment_rent' (models/mart/gold_apartment_rent.sql) depends on a source named 'zap_imoveis.silver_zapimoveis' which was not found
[0m17:42:52.086314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ecf683990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ecf6837d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ed07881d0>]}
[0m17:42:52.087164 [debug] [MainThread]: Flushing usage events
[0m17:46:01.340734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a69d5663c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a69d5b1d950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a69d5663c50>]}


============================== 17:46:01.345332 | 0633c3f5-e83f-4d32-b334-c2d8217fafee ==============================
[0m17:46:01.345332 [info ] [MainThread]: Running with dbt=1.7.13
[0m17:46:01.346399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:46:01.625873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0633c3f5-e83f-4d32-b334-c2d8217fafee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a69d5686d50>]}
[0m17:46:01.768312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0633c3f5-e83f-4d32-b334-c2d8217fafee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a69d5686d50>]}
[0m17:46:01.769585 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m17:46:01.782432 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m17:46:01.783830 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:46:01.784886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0633c3f5-e83f-4d32-b334-c2d8217fafee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a69d517efd0>]}
[0m17:46:03.298397 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.zap_imoveis.gold_apartment_rent' (models/mart/gold_apartment_rent.sql) depends on a source named 'zap_imoveis.silver_zapimoveis' which was not found
[0m17:46:03.300509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a69d5661f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a69d5663c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a69d4f29510>]}
[0m17:46:03.301387 [debug] [MainThread]: Flushing usage events
[0m17:47:10.639687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790063356990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7900633878d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790063356890>]}


============================== 17:47:10.644311 | 9f01dc04-71bb-4f76-bf5d-eb9158d04378 ==============================
[0m17:47:10.644311 [info ] [MainThread]: Running with dbt=1.7.13
[0m17:47:10.645436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:47:10.933472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f01dc04-71bb-4f76-bf5d-eb9158d04378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790062c27e90>]}
[0m17:47:11.075168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f01dc04-71bb-4f76-bf5d-eb9158d04378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790062c19ed0>]}
[0m17:47:11.076449 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m17:47:11.089673 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m17:47:11.090948 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:47:11.091859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9f01dc04-71bb-4f76-bf5d-eb9158d04378', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790062c9e3d0>]}
[0m17:47:12.621125 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.zap_imoveis.gold_apartment_rent' (models/mart/gold_apartment_rent.sql) depends on a source named 'zap.silver_zapimoveis' which was not found
[0m17:47:12.622822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790063399450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790062673f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790063399010>]}
[0m17:47:12.623709 [debug] [MainThread]: Flushing usage events
[0m17:50:01.143176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bf50838d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bf514ee210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bf5083a790>]}


============================== 17:50:01.147943 | ab7cc00a-c162-496e-a2e9-4f33db816705 ==============================
[0m17:50:01.147943 [info ] [MainThread]: Running with dbt=1.7.13
[0m17:50:01.149047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:50:01.428603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab7cc00a-c162-496e-a2e9-4f33db816705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bf5083a410>]}
[0m17:50:01.565576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab7cc00a-c162-496e-a2e9-4f33db816705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bf50118650>]}
[0m17:50:01.566843 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m17:50:01.579924 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m17:50:01.581215 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:50:01.582159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ab7cc00a-c162-496e-a2e9-4f33db816705', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bf5011b710>]}
[0m17:50:03.119274 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.zap_imoveis.gold_apartment_rent' (models/mart/gold_apartment_rent.sql) depends on a source named 'zap.silver_zapimoveis' which was not found
[0m17:50:03.120993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bf50883910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bf500a4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bf4ffab750>]}
[0m17:50:03.121862 [debug] [MainThread]: Flushing usage events
[0m17:53:49.109632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac441931dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac4426b5050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac44109bd90>]}


============================== 17:53:49.114347 | eedf7b53-65c2-484b-9662-c36486a2739d ==============================
[0m17:53:49.114347 [info ] [MainThread]: Running with dbt=1.7.13
[0m17:53:49.115448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:53:49.399314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eedf7b53-65c2-484b-9662-c36486a2739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac440ae8cd0>]}
[0m17:53:49.539049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eedf7b53-65c2-484b-9662-c36486a2739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac441497450>]}
[0m17:53:49.540309 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m17:53:49.554079 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m17:53:49.555812 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:53:49.557000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eedf7b53-65c2-484b-9662-c36486a2739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac440af67d0>]}
[0m17:53:51.109755 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_rent
[0m17:53:51.119183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eedf7b53-65c2-484b-9662-c36486a2739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac440a7e490>]}
[0m17:53:51.144352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eedf7b53-65c2-484b-9662-c36486a2739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac4403cf450>]}
[0m17:53:51.145330 [info ] [MainThread]: Found 8 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:53:51.146116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eedf7b53-65c2-484b-9662-c36486a2739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac440b79c10>]}
[0m17:53:51.148811 [info ] [MainThread]: 
[0m17:53:51.150212 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:53:51.152408 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m17:53:51.172161 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m17:53:51.173115 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m17:53:51.173908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:51.239918 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:53:51.242123 [debug] [ThreadPool]: On list_foo: Close
[0m17:53:51.246734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m17:53:51.256449 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:53:51.257207 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m17:53:51.257849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:51.270637 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:53:51.271440 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:53:51.272122 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m17:53:51.278132 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:53:51.281034 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m17:53:51.282084 [debug] [ThreadPool]: On list_foo_zap: Close
[0m17:53:51.289941 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:51.290741 [debug] [MainThread]: On master: BEGIN
[0m17:53:51.291374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:51.304741 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:53:51.305527 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:51.306296 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:53:51.313737 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:53:51.317221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eedf7b53-65c2-484b-9662-c36486a2739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac440971090>]}
[0m17:53:51.318278 [debug] [MainThread]: On master: ROLLBACK
[0m17:53:51.319602 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:51.320405 [debug] [MainThread]: On master: BEGIN
[0m17:53:51.321539 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:53:51.322230 [debug] [MainThread]: On master: COMMIT
[0m17:53:51.322888 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:51.323492 [debug] [MainThread]: On master: COMMIT
[0m17:53:51.324412 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:53:51.325159 [debug] [MainThread]: On master: Close
[0m17:53:51.326950 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:53:51.327907 [info ] [MainThread]: 
[0m17:53:51.332558 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent
[0m17:53:51.333997 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent ............................ [RUN]
[0m17:53:51.335576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent)
[0m17:53:51.336433 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent
[0m17:53:51.349276 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent"
[0m17:53:51.350723 [debug] [Thread-1 (]: Timing info for model.zap_imoveis.gold_apartment_rent (compile): 17:53:51.337009 => 17:53:51.350263
[0m17:53:51.351474 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent
[0m17:53:51.412489 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent"
[0m17:53:51.413882 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m17:53:51.414679 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: BEGIN
[0m17:53:51.415380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:51.430647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:53:51.431477 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m17:53:51.432216 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */

  create view "foo"."zap"."gold_apartment_rent__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis"
)

SELECT * FROM source
WHERE kind == 'Apartamentos para Alugar'
  );
[0m17:53:51.433937 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: text == unknown
LINE 12: WHERE kind == 'Apartamentos para Alugar'
                    ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m17:53:51.434753 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: ROLLBACK
[0m17:53:51.436111 [debug] [Thread-1 (]: Timing info for model.zap_imoveis.gold_apartment_rent (execute): 17:53:51.351942 => 17:53:51.435660
[0m17:53:51.436882 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: Close
[0m17:53:51.445815 [debug] [Thread-1 (]: Database Error in model gold_apartment_rent (models/mart/gold_apartment_rent.sql)
  operator does not exist: text == unknown
  LINE 12: WHERE kind == 'Apartamentos para Alugar'
                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/zap_imoveis/models/mart/gold_apartment_rent.sql
[0m17:53:51.446791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eedf7b53-65c2-484b-9662-c36486a2739d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac440370fd0>]}
[0m17:53:51.447837 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model zap.gold_apartment_rent ................... [[31mERROR[0m in 0.11s]
[0m17:53:51.448987 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent
[0m17:53:51.453389 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:51.454231 [debug] [MainThread]: On master: BEGIN
[0m17:53:51.455023 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:51.467079 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:53:51.467954 [debug] [MainThread]: On master: COMMIT
[0m17:53:51.468672 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:51.469532 [debug] [MainThread]: On master: COMMIT
[0m17:53:51.470823 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:53:51.471878 [debug] [MainThread]: On master: Close
[0m17:53:51.473652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:51.474390 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent' was properly closed.
[0m17:53:51.475114 [info ] [MainThread]: 
[0m17:53:51.475842 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m17:53:51.477180 [debug] [MainThread]: Command end result
[0m17:53:51.490153 [info ] [MainThread]: 
[0m17:53:51.491094 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:53:51.491951 [info ] [MainThread]: 
[0m17:53:51.492871 [error] [MainThread]:   Database Error in model gold_apartment_rent (models/mart/gold_apartment_rent.sql)
  operator does not exist: text == unknown
  LINE 12: WHERE kind == 'Apartamentos para Alugar'
                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/zap_imoveis/models/mart/gold_apartment_rent.sql
[0m17:53:51.494149 [info ] [MainThread]: 
[0m17:53:51.495104 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:53:51.496765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac441060250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac44104e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac445765ed0>]}
[0m17:53:51.497655 [debug] [MainThread]: Flushing usage events
[0m17:54:17.293454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef111c74c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef111c744d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef111c45f90>]}


============================== 17:54:17.298055 | fb8a30e4-6307-4f0b-82e4-cf031e1aafca ==============================
[0m17:54:17.298055 [info ] [MainThread]: Running with dbt=1.7.13
[0m17:54:17.299169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:54:17.581601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb8a30e4-6307-4f0b-82e4-cf031e1aafca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef111c9d450>]}
[0m17:54:17.719024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb8a30e4-6307-4f0b-82e4-cf031e1aafca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef111998490>]}
[0m17:54:17.720334 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m17:54:17.735894 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m17:54:17.773892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:54:17.774648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:54:17.776085 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_rent
[0m17:54:17.785705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb8a30e4-6307-4f0b-82e4-cf031e1aafca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef1114e70d0>]}
[0m17:54:17.806119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb8a30e4-6307-4f0b-82e4-cf031e1aafca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef1115cd810>]}
[0m17:54:17.807394 [info ] [MainThread]: Found 8 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:54:17.808209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb8a30e4-6307-4f0b-82e4-cf031e1aafca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef111a45250>]}
[0m17:54:17.811074 [info ] [MainThread]: 
[0m17:54:17.812507 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:54:17.814566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m17:54:17.833815 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m17:54:17.834582 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m17:54:17.835220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:17.848998 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:54:17.851174 [debug] [ThreadPool]: On list_foo: Close
[0m17:54:17.855651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m17:54:17.866099 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:54:17.866875 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m17:54:17.867504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:17.879367 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:54:17.880141 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:54:17.880812 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m17:54:17.885384 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:54:17.888794 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m17:54:17.889945 [debug] [ThreadPool]: On list_foo_zap: Close
[0m17:54:17.898413 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:17.899207 [debug] [MainThread]: On master: BEGIN
[0m17:54:17.899879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:17.912939 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:54:17.913786 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:17.914559 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:54:17.920632 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:54:17.923261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb8a30e4-6307-4f0b-82e4-cf031e1aafca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef1119fe090>]}
[0m17:54:17.924126 [debug] [MainThread]: On master: ROLLBACK
[0m17:54:17.925173 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:17.925885 [debug] [MainThread]: On master: BEGIN
[0m17:54:17.926964 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:54:17.927683 [debug] [MainThread]: On master: COMMIT
[0m17:54:17.928329 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:17.928977 [debug] [MainThread]: On master: COMMIT
[0m17:54:17.929882 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:54:17.930606 [debug] [MainThread]: On master: Close
[0m17:54:17.931956 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:54:17.932785 [info ] [MainThread]: 
[0m17:54:17.937380 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent
[0m17:54:17.938499 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent ............................ [RUN]
[0m17:54:17.940056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent)
[0m17:54:17.940970 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent
[0m17:54:17.953947 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent"
[0m17:54:17.955311 [debug] [Thread-1 (]: Timing info for model.zap_imoveis.gold_apartment_rent (compile): 17:54:17.941509 => 17:54:17.954833
[0m17:54:17.956324 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent
[0m17:54:18.017955 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent"
[0m17:54:18.019209 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m17:54:18.020024 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: BEGIN
[0m17:54:18.020772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:18.032890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:54:18.033778 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m17:54:18.034553 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */

  create view "foo"."zap"."gold_apartment_rent__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis"
)

SELECT * FROM source
WHERE kind == 'Apartamentos para Alugar'
  );
[0m17:54:18.036138 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: text == unknown
LINE 12: WHERE kind == 'Apartamentos para Alugar'
                    ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m17:54:18.037003 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: ROLLBACK
[0m17:54:18.038410 [debug] [Thread-1 (]: Timing info for model.zap_imoveis.gold_apartment_rent (execute): 17:54:17.956928 => 17:54:18.037965
[0m17:54:18.039244 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: Close
[0m17:54:18.045042 [debug] [Thread-1 (]: Database Error in model gold_apartment_rent (models/mart/gold_apartment_rent.sql)
  operator does not exist: text == unknown
  LINE 12: WHERE kind == 'Apartamentos para Alugar'
                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/zap_imoveis/models/mart/gold_apartment_rent.sql
[0m17:54:18.046054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb8a30e4-6307-4f0b-82e4-cf031e1aafca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef1113eea90>]}
[0m17:54:18.047117 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model zap.gold_apartment_rent ................... [[31mERROR[0m in 0.11s]
[0m17:54:18.048294 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent
[0m17:54:18.053601 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:18.054446 [debug] [MainThread]: On master: BEGIN
[0m17:54:18.055209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:18.067420 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:54:18.068214 [debug] [MainThread]: On master: COMMIT
[0m17:54:18.068923 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:18.069692 [debug] [MainThread]: On master: COMMIT
[0m17:54:18.070997 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:54:18.071866 [debug] [MainThread]: On master: Close
[0m17:54:18.073423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:18.074192 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent' was properly closed.
[0m17:54:18.074925 [info ] [MainThread]: 
[0m17:54:18.075676 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m17:54:18.077048 [debug] [MainThread]: Command end result
[0m17:54:18.089739 [info ] [MainThread]: 
[0m17:54:18.090659 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:54:18.091441 [info ] [MainThread]: 
[0m17:54:18.092178 [error] [MainThread]:   Database Error in model gold_apartment_rent (models/mart/gold_apartment_rent.sql)
  operator does not exist: text == unknown
  LINE 12: WHERE kind == 'Apartamentos para Alugar'
                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/zap_imoveis/models/mart/gold_apartment_rent.sql
[0m17:54:18.093060 [info ] [MainThread]: 
[0m17:54:18.094319 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:54:18.096450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef111c5b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef111c583d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef116421f50>]}
[0m17:54:18.097380 [debug] [MainThread]: Flushing usage events
[0m17:56:02.383846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8ad0f5e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8ad0f5c8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8ad0f5c190>]}


============================== 17:56:02.388622 | 6c2d5684-5fcf-4284-ac2e-3474fc8fe490 ==============================
[0m17:56:02.388622 [info ] [MainThread]: Running with dbt=1.7.13
[0m17:56:02.389836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:56:02.686470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c2d5684-5fcf-4284-ac2e-3474fc8fe490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8ad0936150>]}
[0m17:56:02.826461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c2d5684-5fcf-4284-ac2e-3474fc8fe490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8ad2218590>]}
[0m17:56:02.827766 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m17:56:02.841089 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m17:56:02.880596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:56:02.881720 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_apartment_rent.sql
[0m17:56:03.169410 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_rent
[0m17:56:03.178360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c2d5684-5fcf-4284-ac2e-3474fc8fe490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8ad025c250>]}
[0m17:56:03.198374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c2d5684-5fcf-4284-ac2e-3474fc8fe490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8ad035d6d0>]}
[0m17:56:03.199275 [info ] [MainThread]: Found 8 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:56:03.199995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2d5684-5fcf-4284-ac2e-3474fc8fe490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8ad03d1250>]}
[0m17:56:03.202621 [info ] [MainThread]: 
[0m17:56:03.204248 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:56:03.206308 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m17:56:03.225962 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m17:56:03.226733 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m17:56:03.227359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:03.241650 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:56:03.244321 [debug] [ThreadPool]: On list_foo: Close
[0m17:56:03.248036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m17:56:03.259081 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:56:03.259862 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m17:56:03.260475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:03.272695 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:56:03.273446 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:56:03.274119 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m17:56:03.278935 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:56:03.281851 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m17:56:03.282915 [debug] [ThreadPool]: On list_foo_zap: Close
[0m17:56:03.290979 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:03.291761 [debug] [MainThread]: On master: BEGIN
[0m17:56:03.292391 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:56:03.305087 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:56:03.305989 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:03.306874 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:56:03.312915 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:56:03.385551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2d5684-5fcf-4284-ac2e-3474fc8fe490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8ad026bb10>]}
[0m17:56:03.386593 [debug] [MainThread]: On master: ROLLBACK
[0m17:56:03.387767 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:03.388511 [debug] [MainThread]: On master: BEGIN
[0m17:56:03.389677 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:56:03.390388 [debug] [MainThread]: On master: COMMIT
[0m17:56:03.391043 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:03.391692 [debug] [MainThread]: On master: COMMIT
[0m17:56:03.392627 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:56:03.393361 [debug] [MainThread]: On master: Close
[0m17:56:03.394866 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:56:03.395736 [info ] [MainThread]: 
[0m17:56:03.399839 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent
[0m17:56:03.400897 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent ............................ [RUN]
[0m17:56:03.402751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent)
[0m17:56:03.403729 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent
[0m17:56:03.415839 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent"
[0m17:56:03.417125 [debug] [Thread-1 (]: Timing info for model.zap_imoveis.gold_apartment_rent (compile): 17:56:03.404288 => 17:56:03.416698
[0m17:56:03.417910 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent
[0m17:56:03.477558 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent"
[0m17:56:03.478775 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m17:56:03.479507 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: BEGIN
[0m17:56:03.480229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:03.493148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:56:03.494003 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m17:56:03.494805 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */

  create view "foo"."zap"."gold_apartment_rent__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis"
)

SELECT * FROM source
WHERE kind = 'Apartamentos para Alugar'
  );
[0m17:56:03.507244 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:56:03.517797 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m17:56:03.518639 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
alter table "foo"."zap"."gold_apartment_rent__dbt_tmp" rename to "gold_apartment_rent"
[0m17:56:03.520362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:56:03.544301 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: COMMIT
[0m17:56:03.545154 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m17:56:03.545944 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: COMMIT
[0m17:56:03.548661 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:56:03.559093 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_rent__dbt_backup"
[0m17:56:03.568276 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m17:56:03.569132 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
drop view if exists "foo"."zap"."gold_apartment_rent__dbt_backup" cascade
[0m17:56:03.570596 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:56:03.573757 [debug] [Thread-1 (]: Timing info for model.zap_imoveis.gold_apartment_rent (execute): 17:56:03.418403 => 17:56:03.573234
[0m17:56:03.574760 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: Close
[0m17:56:03.576506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c2d5684-5fcf-4284-ac2e-3474fc8fe490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8ad08e2b50>]}
[0m17:56:03.577819 [info ] [Thread-1 (]: 1 of 1 OK created sql view model zap.gold_apartment_rent ....................... [[32mCREATE VIEW[0m in 0.17s]
[0m17:56:03.579256 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent
[0m17:56:03.582539 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:03.583545 [debug] [MainThread]: On master: BEGIN
[0m17:56:03.584467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:56:03.597781 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:56:03.599168 [debug] [MainThread]: On master: COMMIT
[0m17:56:03.600457 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:03.601689 [debug] [MainThread]: On master: COMMIT
[0m17:56:03.603221 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:56:03.604055 [debug] [MainThread]: On master: Close
[0m17:56:03.606098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:03.607294 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent' was properly closed.
[0m17:56:03.608468 [info ] [MainThread]: 
[0m17:56:03.609738 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m17:56:03.611160 [debug] [MainThread]: Command end result
[0m17:56:03.626114 [info ] [MainThread]: 
[0m17:56:03.627042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:56:03.628044 [info ] [MainThread]: 
[0m17:56:03.629052 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:56:03.630685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8ad58e4210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8ad5765e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8ad5765ed0>]}
[0m17:56:03.631766 [debug] [MainThread]: Flushing usage events
[0m23:31:18.860879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d849a87d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d849a519d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d849a73c50>]}


============================== 23:31:18.868004 | 856d6be0-7824-48c8-a39c-3e452bcef996 ==============================
[0m23:31:18.868004 [info ] [MainThread]: Running with dbt=1.7.13
[0m23:31:18.869261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:31:19.287287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '856d6be0-7824-48c8-a39c-3e452bcef996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d8494eef50>]}
[0m23:31:19.424919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '856d6be0-7824-48c8-a39c-3e452bcef996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d84950ea50>]}
[0m23:31:19.427584 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m23:31:19.441656 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m23:31:19.459569 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:31:19.460455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '856d6be0-7824-48c8-a39c-3e452bcef996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d849ad8d90>]}
[0m23:31:21.041202 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_rent
[0m23:31:21.050316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '856d6be0-7824-48c8-a39c-3e452bcef996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d848f35750>]}
[0m23:31:21.071173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '856d6be0-7824-48c8-a39c-3e452bcef996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d848d52510>]}
[0m23:31:21.072065 [info ] [MainThread]: Found 8 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:31:21.072782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '856d6be0-7824-48c8-a39c-3e452bcef996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d848f986d0>]}
[0m23:31:21.075416 [info ] [MainThread]: 
[0m23:31:21.076808 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:31:21.078777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m23:31:21.097493 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m23:31:21.098356 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m23:31:21.099236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:21.131277 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m23:31:21.133530 [debug] [ThreadPool]: On list_foo: Close
[0m23:31:21.137827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m23:31:21.147993 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m23:31:21.148742 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m23:31:21.149347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:21.161649 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:31:21.162436 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m23:31:21.163102 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m23:31:21.169184 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:31:21.172123 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m23:31:21.173236 [debug] [ThreadPool]: On list_foo_zap: Close
[0m23:31:21.181439 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:21.182204 [debug] [MainThread]: On master: BEGIN
[0m23:31:21.182836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:31:21.195495 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:31:21.196614 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:21.197491 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:31:21.204033 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m23:31:21.208235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '856d6be0-7824-48c8-a39c-3e452bcef996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d8492e9f10>]}
[0m23:31:21.209270 [debug] [MainThread]: On master: ROLLBACK
[0m23:31:21.210467 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:21.211302 [debug] [MainThread]: On master: BEGIN
[0m23:31:21.212709 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:31:21.213588 [debug] [MainThread]: On master: COMMIT
[0m23:31:21.214261 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:21.214893 [debug] [MainThread]: On master: COMMIT
[0m23:31:21.216045 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:31:21.216896 [debug] [MainThread]: On master: Close
[0m23:31:21.218271 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:31:21.219091 [info ] [MainThread]: 
[0m23:31:21.223633 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent
[0m23:31:21.224795 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent ............................ [RUN]
[0m23:31:21.226219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent)
[0m23:31:21.227148 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent
[0m23:31:21.239777 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent"
[0m23:31:21.241215 [debug] [Thread-1 (]: Timing info for model.zap_imoveis.gold_apartment_rent (compile): 23:31:21.227751 => 23:31:21.240712
[0m23:31:21.242031 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent
[0m23:31:21.306246 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent"
[0m23:31:21.307441 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:31:21.308201 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: BEGIN
[0m23:31:21.308891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:31:21.321252 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:31:21.322091 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:31:21.322824 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */

  create view "foo"."zap"."gold_apartment_rent__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis"
)

SELECT * FROM source
WHERE kind = 'Apartamentos para Alugar'
  );
[0m23:31:21.337133 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:31:21.347964 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:31:21.348794 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
alter table "foo"."zap"."gold_apartment_rent" rename to "gold_apartment_rent__dbt_backup"
[0m23:31:21.350540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:31:21.355794 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:31:21.356577 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
alter table "foo"."zap"."gold_apartment_rent__dbt_tmp" rename to "gold_apartment_rent"
[0m23:31:21.358253 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:31:21.386022 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: COMMIT
[0m23:31:21.386859 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:31:21.387554 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: COMMIT
[0m23:31:21.390997 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:31:21.401804 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_rent__dbt_backup"
[0m23:31:21.410731 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:31:21.411575 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
drop view if exists "foo"."zap"."gold_apartment_rent__dbt_backup" cascade
[0m23:31:21.416329 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:31:21.419010 [debug] [Thread-1 (]: Timing info for model.zap_imoveis.gold_apartment_rent (execute): 23:31:21.242496 => 23:31:21.418603
[0m23:31:21.419815 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: Close
[0m23:31:21.421337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '856d6be0-7824-48c8-a39c-3e452bcef996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d848fe2650>]}
[0m23:31:21.422498 [info ] [Thread-1 (]: 1 of 1 OK created sql view model zap.gold_apartment_rent ....................... [[32mCREATE VIEW[0m in 0.20s]
[0m23:31:21.423828 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent
[0m23:31:21.426352 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:21.427103 [debug] [MainThread]: On master: BEGIN
[0m23:31:21.427748 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:31:21.440145 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:31:21.440985 [debug] [MainThread]: On master: COMMIT
[0m23:31:21.441745 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:21.442460 [debug] [MainThread]: On master: COMMIT
[0m23:31:21.443405 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:31:21.444110 [debug] [MainThread]: On master: Close
[0m23:31:21.445421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:21.446298 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent' was properly closed.
[0m23:31:21.447220 [info ] [MainThread]: 
[0m23:31:21.448287 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m23:31:21.450035 [debug] [MainThread]: Command end result
[0m23:31:21.462205 [info ] [MainThread]: 
[0m23:31:21.463329 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:31:21.464211 [info ] [MainThread]: 
[0m23:31:21.465183 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:31:21.467855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d849ab09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d849a644d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d84e221f90>]}
[0m23:31:21.468780 [debug] [MainThread]: Flushing usage events
[0m23:34:33.744557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d7c35d5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d7c3431b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d7c3061c90>]}


============================== 23:34:33.749381 | 574e8ae1-03c4-4d03-bc9d-87ec6f712bee ==============================
[0m23:34:33.749381 [info ] [MainThread]: Running with dbt=1.7.13
[0m23:34:33.750503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:34:34.039823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '574e8ae1-03c4-4d03-bc9d-87ec6f712bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d7c2b8ea10>]}
[0m23:34:34.178714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '574e8ae1-03c4-4d03-bc9d-87ec6f712bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d7c2a1f2d0>]}
[0m23:34:34.179978 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m23:34:34.192883 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m23:34:34.231699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:34:34.232517 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:34:34.233922 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_rent
[0m23:34:34.243086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '574e8ae1-03c4-4d03-bc9d-87ec6f712bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d7c2a8ea10>]}
[0m23:34:34.262955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '574e8ae1-03c4-4d03-bc9d-87ec6f712bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d7c2a4ba50>]}
[0m23:34:34.264029 [info ] [MainThread]: Found 8 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:34:34.265054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '574e8ae1-03c4-4d03-bc9d-87ec6f712bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d7c2b5acd0>]}
[0m23:34:34.267796 [info ] [MainThread]: 
[0m23:34:34.269192 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:34:34.271278 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m23:34:34.291410 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m23:34:34.292186 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m23:34:34.292846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:34.307220 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m23:34:34.309409 [debug] [ThreadPool]: On list_foo: Close
[0m23:34:34.313245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m23:34:34.323473 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m23:34:34.324251 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m23:34:34.324910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:34:34.336935 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:34:34.337696 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m23:34:34.338361 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m23:34:34.342760 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:34:34.345662 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m23:34:34.346726 [debug] [ThreadPool]: On list_foo_zap: Close
[0m23:34:34.355411 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:34.356191 [debug] [MainThread]: On master: BEGIN
[0m23:34:34.356870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:34:34.369927 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:34:34.370760 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:34.371575 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:34:34.377740 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m23:34:34.381127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '574e8ae1-03c4-4d03-bc9d-87ec6f712bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d7c2a33f10>]}
[0m23:34:34.382048 [debug] [MainThread]: On master: ROLLBACK
[0m23:34:34.383364 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:34.384168 [debug] [MainThread]: On master: BEGIN
[0m23:34:34.385455 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:34:34.386223 [debug] [MainThread]: On master: COMMIT
[0m23:34:34.386882 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:34.387515 [debug] [MainThread]: On master: COMMIT
[0m23:34:34.388614 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:34:34.389425 [debug] [MainThread]: On master: Close
[0m23:34:34.390850 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:34:34.391681 [info ] [MainThread]: 
[0m23:34:34.395924 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent
[0m23:34:34.396995 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent ............................ [RUN]
[0m23:34:34.398529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent)
[0m23:34:34.399391 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent
[0m23:34:34.412331 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent"
[0m23:34:34.413727 [debug] [Thread-1 (]: Timing info for model.zap_imoveis.gold_apartment_rent (compile): 23:34:34.399948 => 23:34:34.413212
[0m23:34:34.414730 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent
[0m23:34:34.475212 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent"
[0m23:34:34.476396 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:34:34.477158 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: BEGIN
[0m23:34:34.477878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:34:34.490512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:34:34.491413 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:34:34.492163 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */

  create view "foo"."zap"."gold_apartment_rent__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis"
)

SELECT * FROM source
WHERE kind = 'Apartamentos para Alugar'
  );
[0m23:34:34.498694 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:34:34.509353 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:34:34.510201 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
alter table "foo"."zap"."gold_apartment_rent" rename to "gold_apartment_rent__dbt_backup"
[0m23:34:34.511943 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:34:34.517221 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:34:34.518059 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
alter table "foo"."zap"."gold_apartment_rent__dbt_tmp" rename to "gold_apartment_rent"
[0m23:34:34.519781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:34:34.547431 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: COMMIT
[0m23:34:34.548268 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:34:34.548973 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: COMMIT
[0m23:34:34.552514 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:34:34.563174 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_rent__dbt_backup"
[0m23:34:34.572207 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:34:34.573049 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
drop view if exists "foo"."zap"."gold_apartment_rent__dbt_backup" cascade
[0m23:34:34.577647 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:34:34.580462 [debug] [Thread-1 (]: Timing info for model.zap_imoveis.gold_apartment_rent (execute): 23:34:34.415270 => 23:34:34.580063
[0m23:34:34.581256 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: Close
[0m23:34:34.582705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '574e8ae1-03c4-4d03-bc9d-87ec6f712bee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d7c2417d90>]}
[0m23:34:34.583839 [info ] [Thread-1 (]: 1 of 1 OK created sql view model zap.gold_apartment_rent ....................... [[32mCREATE VIEW[0m in 0.18s]
[0m23:34:34.585080 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent
[0m23:34:34.588178 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:34.588953 [debug] [MainThread]: On master: BEGIN
[0m23:34:34.589641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:34:34.601894 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:34:34.602673 [debug] [MainThread]: On master: COMMIT
[0m23:34:34.603291 [debug] [MainThread]: Using postgres connection "master"
[0m23:34:34.603909 [debug] [MainThread]: On master: COMMIT
[0m23:34:34.604792 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:34:34.605496 [debug] [MainThread]: On master: Close
[0m23:34:34.606782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:34.607486 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent' was properly closed.
[0m23:34:34.608181 [info ] [MainThread]: 
[0m23:34:34.608994 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m23:34:34.610274 [debug] [MainThread]: Command end result
[0m23:34:34.625372 [info ] [MainThread]: 
[0m23:34:34.626289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:34:34.627090 [info ] [MainThread]: 
[0m23:34:34.628117 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:34:34.630352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d7c39323d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d7c79e45d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d7c7865e90>]}
[0m23:34:34.631644 [debug] [MainThread]: Flushing usage events
[0m23:36:43.782630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8bf468f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8bf468a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8bf468150>]}


============================== 23:36:43.787546 | b43ba8cc-cc2c-439f-b269-f1031a25dc2a ==============================
[0m23:36:43.787546 [info ] [MainThread]: Running with dbt=1.7.13
[0m23:36:43.788796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:36:44.070899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b43ba8cc-cc2c-439f-b269-f1031a25dc2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8bed17850>]}
[0m23:36:44.209026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b43ba8cc-cc2c-439f-b269-f1031a25dc2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8bed34250>]}
[0m23:36:44.210286 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m23:36:44.224289 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m23:36:44.263115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:36:44.263938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:36:44.265279 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_rent
[0m23:36:44.274706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b43ba8cc-cc2c-439f-b269-f1031a25dc2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8bed04910>]}
[0m23:36:44.295550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b43ba8cc-cc2c-439f-b269-f1031a25dc2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8bed92dd0>]}
[0m23:36:44.296692 [info ] [MainThread]: Found 8 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:36:44.297671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b43ba8cc-cc2c-439f-b269-f1031a25dc2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8bed43010>]}
[0m23:36:44.300438 [info ] [MainThread]: 
[0m23:36:44.301948 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:36:44.304171 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m23:36:44.324035 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m23:36:44.324815 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m23:36:44.325441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:44.339734 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m23:36:44.342164 [debug] [ThreadPool]: On list_foo: Close
[0m23:36:44.346585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m23:36:44.356821 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m23:36:44.357577 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m23:36:44.358197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:44.369949 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:36:44.370966 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m23:36:44.371849 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m23:36:44.376715 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m23:36:44.380126 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m23:36:44.381177 [debug] [ThreadPool]: On list_foo_zap: Close
[0m23:36:44.389619 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:44.390393 [debug] [MainThread]: On master: BEGIN
[0m23:36:44.391049 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:36:44.403890 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:36:44.404676 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:44.405437 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:36:44.412172 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m23:36:44.415213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b43ba8cc-cc2c-439f-b269-f1031a25dc2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8bec76b50>]}
[0m23:36:44.416078 [debug] [MainThread]: On master: ROLLBACK
[0m23:36:44.417119 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:44.417825 [debug] [MainThread]: On master: BEGIN
[0m23:36:44.419051 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:36:44.419767 [debug] [MainThread]: On master: COMMIT
[0m23:36:44.420402 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:44.421060 [debug] [MainThread]: On master: COMMIT
[0m23:36:44.422048 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:36:44.422787 [debug] [MainThread]: On master: Close
[0m23:36:44.424136 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:36:44.424967 [info ] [MainThread]: 
[0m23:36:44.429352 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent
[0m23:36:44.430447 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent ............................ [RUN]
[0m23:36:44.432019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent)
[0m23:36:44.433070 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent
[0m23:36:44.445771 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent"
[0m23:36:44.447318 [debug] [Thread-1 (]: Timing info for model.zap_imoveis.gold_apartment_rent (compile): 23:36:44.433659 => 23:36:44.446779
[0m23:36:44.448233 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent
[0m23:36:44.508891 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent"
[0m23:36:44.510076 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:36:44.510860 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: BEGIN
[0m23:36:44.511572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:44.526799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m23:36:44.527647 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:36:44.528360 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */

  create view "foo"."zap"."gold_apartment_rent__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis"
)

SELECT * FROM source
WHERE kind = 'Apartamentos para Alugar'
  );
[0m23:36:44.535981 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:36:44.546828 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:36:44.547650 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
alter table "foo"."zap"."gold_apartment_rent" rename to "gold_apartment_rent__dbt_backup"
[0m23:36:44.549411 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:36:44.554645 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:36:44.555448 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
alter table "foo"."zap"."gold_apartment_rent__dbt_tmp" rename to "gold_apartment_rent"
[0m23:36:44.557153 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:36:44.585256 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: COMMIT
[0m23:36:44.586110 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:36:44.586831 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: COMMIT
[0m23:36:44.589727 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:36:44.600221 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_rent__dbt_backup"
[0m23:36:44.609183 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:36:44.610030 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
drop view if exists "foo"."zap"."gold_apartment_rent__dbt_backup" cascade
[0m23:36:44.614616 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:36:44.617830 [debug] [Thread-1 (]: Timing info for model.zap_imoveis.gold_apartment_rent (execute): 23:36:44.448734 => 23:36:44.617423
[0m23:36:44.618618 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: Close
[0m23:36:44.620112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b43ba8cc-cc2c-439f-b269-f1031a25dc2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8bec8ea90>]}
[0m23:36:44.621303 [info ] [Thread-1 (]: 1 of 1 OK created sql view model zap.gold_apartment_rent ....................... [[32mCREATE VIEW[0m in 0.19s]
[0m23:36:44.622513 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent
[0m23:36:44.625597 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:44.626340 [debug] [MainThread]: On master: BEGIN
[0m23:36:44.626959 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:36:44.639231 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:36:44.639998 [debug] [MainThread]: On master: COMMIT
[0m23:36:44.640618 [debug] [MainThread]: Using postgres connection "master"
[0m23:36:44.641234 [debug] [MainThread]: On master: COMMIT
[0m23:36:44.642278 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:36:44.643089 [debug] [MainThread]: On master: Close
[0m23:36:44.645012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:44.645946 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent' was properly closed.
[0m23:36:44.646872 [info ] [MainThread]: 
[0m23:36:44.647693 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m23:36:44.649017 [debug] [MainThread]: Command end result
[0m23:36:44.663398 [info ] [MainThread]: 
[0m23:36:44.664406 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:36:44.665282 [info ] [MainThread]: 
[0m23:36:44.666043 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:36:44.667898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8c3ce4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8c3ce4390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b8bf452c90>]}
[0m23:36:44.668822 [debug] [MainThread]: Flushing usage events
[0m23:56:21.571803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b9b90f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4baa623e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4baa62380>]}


============================== 23:56:21.576318 | 5ce33ef7-30ff-4761-a471-aec058c401bb ==============================
[0m23:56:21.576318 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:56:21.577379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:56:21.585340 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m23:56:21.586741 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "zap", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m23:56:21.590389 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.12460658, "process_in_blocks": "5216", "process_kernel_time": 0.153896, "process_mem_max_rss": "86800", "process_out_blocks": "16", "process_user_time": 2.212514}
[0m23:56:21.591514 [debug] [MainThread]: Command `dbt run` failed at 23:56:21.591249 after 0.13 seconds
[0m23:56:21.592407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4b9b90f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4baa63280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4baa63c70>]}
[0m23:56:21.593290 [debug] [MainThread]: Flushing usage events
[0m23:56:22.885505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:57:32.020583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8c2f94eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8c3e62380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8c3e62320>]}


============================== 23:57:32.025152 | 380230f3-b0c3-48de-93cc-04d16f1dc5b5 ==============================
[0m23:57:32.025152 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:57:32.026327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:57:32.362004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '380230f3-b0c3-48de-93cc-04d16f1dc5b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8c1fd23b0>]}
[0m23:57:32.472721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '380230f3-b0c3-48de-93cc-04d16f1dc5b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8c2d1c7f0>]}
[0m23:57:32.474156 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:57:32.672190 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:57:32.862243 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m23:57:32.863188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '380230f3-b0c3-48de-93cc-04d16f1dc5b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8c27752a0>]}
[0m23:57:35.124733 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_rent
[0m23:57:35.151212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '380230f3-b0c3-48de-93cc-04d16f1dc5b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8c0d7fe20>]}
[0m23:57:35.312756 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m23:57:35.318116 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m23:57:35.342711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '380230f3-b0c3-48de-93cc-04d16f1dc5b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8c0d47580>]}
[0m23:57:35.343749 [info ] [MainThread]: Found 8 models, 1 source, 431 macros
[0m23:57:35.344529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '380230f3-b0c3-48de-93cc-04d16f1dc5b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8c0d474f0>]}
[0m23:57:35.347451 [info ] [MainThread]: 
[0m23:57:35.348297 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:57:35.348996 [info ] [MainThread]: 
[0m23:57:35.350223 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:57:35.353011 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m23:57:35.420309 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m23:57:35.421143 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m23:57:35.421813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:35.448531 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.027 seconds
[0m23:57:35.450996 [debug] [ThreadPool]: On list_foo: Close
[0m23:57:35.462071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m23:57:35.474957 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m23:57:35.475786 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m23:57:35.476415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:57:35.488830 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m23:57:35.489979 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m23:57:35.490802 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m23:57:35.495927 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m23:57:35.499371 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m23:57:35.500506 [debug] [ThreadPool]: On list_foo_zap: Close
[0m23:57:35.510776 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:35.511594 [debug] [MainThread]: On master: BEGIN
[0m23:57:35.512241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:57:35.526033 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m23:57:35.526977 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:35.527778 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:57:35.534043 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m23:57:35.537452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '380230f3-b0c3-48de-93cc-04d16f1dc5b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8c1fd3400>]}
[0m23:57:35.538347 [debug] [MainThread]: On master: ROLLBACK
[0m23:57:35.539451 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:35.540193 [debug] [MainThread]: On master: BEGIN
[0m23:57:35.541496 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:57:35.542222 [debug] [MainThread]: On master: COMMIT
[0m23:57:35.542928 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:35.543643 [debug] [MainThread]: On master: COMMIT
[0m23:57:35.544672 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:57:35.545405 [debug] [MainThread]: On master: Close
[0m23:57:35.549616 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent
[0m23:57:35.550799 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent ............................ [RUN]
[0m23:57:35.551861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent)
[0m23:57:35.552725 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent
[0m23:57:35.568988 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent"
[0m23:57:35.570186 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent
[0m23:57:35.640572 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent"
[0m23:57:35.641914 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:57:35.642759 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: BEGIN
[0m23:57:35.643503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:57:35.655984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:57:35.656921 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:57:35.657715 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */

  create view "foo"."zap"."gold_apartment_rent__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis"
)

SELECT * FROM source
WHERE kind = 'Apartamentos para Alugar'
  );
[0m23:57:35.661896 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m23:57:35.675255 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:57:35.676164 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
alter table "foo"."zap"."gold_apartment_rent" rename to "gold_apartment_rent__dbt_backup"
[0m23:57:35.678005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:57:35.684262 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:57:35.685152 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
alter table "foo"."zap"."gold_apartment_rent__dbt_tmp" rename to "gold_apartment_rent"
[0m23:57:35.686923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:57:35.720537 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: COMMIT
[0m23:57:35.721451 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:57:35.722229 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: COMMIT
[0m23:57:35.725347 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:57:35.738056 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_rent__dbt_backup"
[0m23:57:35.746835 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:57:35.747738 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
drop view if exists "foo"."zap"."gold_apartment_rent__dbt_backup" cascade
[0m23:57:35.752393 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m23:57:35.757434 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: Close
[0m23:57:35.760952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '380230f3-b0c3-48de-93cc-04d16f1dc5b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8c0537250>]}
[0m23:57:35.762407 [info ] [Thread-1 (]: 1 of 1 OK created sql view model zap.gold_apartment_rent ....................... [[32mCREATE VIEW[0m in 0.21s]
[0m23:57:35.763798 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent
[0m23:57:35.766348 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:35.767196 [debug] [MainThread]: On master: BEGIN
[0m23:57:35.768027 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:57:35.780845 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m23:57:35.781718 [debug] [MainThread]: On master: COMMIT
[0m23:57:35.782426 [debug] [MainThread]: Using postgres connection "master"
[0m23:57:35.783116 [debug] [MainThread]: On master: COMMIT
[0m23:57:35.784373 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:57:35.785731 [debug] [MainThread]: On master: Close
[0m23:57:35.787318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:35.788121 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent' was properly closed.
[0m23:57:35.788901 [info ] [MainThread]: 
[0m23:57:35.789684 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m23:57:35.791121 [debug] [MainThread]: Command end result
[0m23:57:35.835590 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m23:57:35.838303 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m23:57:35.850840 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m23:57:35.851684 [info ] [MainThread]: 
[0m23:57:35.852521 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:57:35.853238 [info ] [MainThread]: 
[0m23:57:35.854003 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:57:35.855645 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9450948, "process_in_blocks": "13872", "process_kernel_time": 0.288132, "process_mem_max_rss": "115528", "process_out_blocks": "2616", "process_user_time": 5.836688}
[0m23:57:35.856555 [debug] [MainThread]: Command `dbt run` succeeded at 23:57:35.856379 after 3.95 seconds
[0m23:57:35.857349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8c2f94eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8c2d1c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d8c2e52bc0>]}
[0m23:57:35.858320 [debug] [MainThread]: Flushing usage events
[0m23:57:37.225043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:59:23.442147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7199094f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7199f663e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7199f66380>]}


============================== 23:59:23.447110 | 09f4a67c-d09b-4e69-9538-a3614884d8c8 ==============================
[0m23:59:23.447110 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:59:23.448201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:59:23.759756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09f4a67c-d09b-4e69-9538-a3614884d8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d719a0bb910>]}
[0m23:59:23.870754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09f4a67c-d09b-4e69-9538-a3614884d8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d719887a800>]}
[0m23:59:23.872160 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:59:24.063951 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:59:24.287536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:59:24.288301 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:59:24.300711 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_rent
[0m23:59:24.370406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09f4a67c-d09b-4e69-9538-a3614884d8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d719745c160>]}
[0m23:59:24.533276 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m23:59:24.538861 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m23:59:24.556918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09f4a67c-d09b-4e69-9538-a3614884d8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7197412920>]}
[0m23:59:24.557956 [info ] [MainThread]: Found 8 models, 1 source, 431 macros
[0m23:59:24.558803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09f4a67c-d09b-4e69-9538-a3614884d8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7197412b60>]}
[0m23:59:24.561706 [info ] [MainThread]: 
[0m23:59:24.562555 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:59:24.563332 [info ] [MainThread]: 
[0m23:59:24.564408 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:59:24.566376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m23:59:24.633729 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m23:59:24.634641 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m23:59:24.635376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:59:24.649688 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m23:59:24.652202 [debug] [ThreadPool]: On list_foo: Close
[0m23:59:24.662317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m23:59:24.675153 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m23:59:24.675967 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m23:59:24.676626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:59:24.689305 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m23:59:24.690238 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m23:59:24.690929 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m23:59:24.695742 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m23:59:24.698117 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m23:59:24.699231 [debug] [ThreadPool]: On list_foo_zap: Close
[0m23:59:24.709792 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:24.710599 [debug] [MainThread]: On master: BEGIN
[0m23:59:24.711238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:59:24.724526 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m23:59:24.725388 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:24.726164 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:59:24.732715 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m23:59:24.735869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09f4a67c-d09b-4e69-9538-a3614884d8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d719a309ae0>]}
[0m23:59:24.736776 [debug] [MainThread]: On master: ROLLBACK
[0m23:59:24.737890 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:24.738625 [debug] [MainThread]: On master: BEGIN
[0m23:59:24.739783 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:59:24.740524 [debug] [MainThread]: On master: COMMIT
[0m23:59:24.741241 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:24.741900 [debug] [MainThread]: On master: COMMIT
[0m23:59:24.742869 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:59:24.743676 [debug] [MainThread]: On master: Close
[0m23:59:24.747701 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent
[0m23:59:24.748903 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent ............................ [RUN]
[0m23:59:24.749965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent)
[0m23:59:24.750820 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent
[0m23:59:24.768853 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent"
[0m23:59:24.770072 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent
[0m23:59:24.839166 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent"
[0m23:59:24.840526 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:59:24.841345 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: BEGIN
[0m23:59:24.842107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:59:24.855269 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:59:24.856191 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:59:24.856993 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */

  create view "foo"."zap"."gold_apartment_rent__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis"
)

SELECT * FROM source
WHERE kind = 'Apartamentos para Alugar'
  );
[0m23:59:24.861833 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m23:59:24.874649 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:59:24.875555 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
alter table "foo"."zap"."gold_apartment_rent" rename to "gold_apartment_rent__dbt_backup"
[0m23:59:24.877362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:59:24.883561 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:59:24.884413 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
alter table "foo"."zap"."gold_apartment_rent__dbt_tmp" rename to "gold_apartment_rent"
[0m23:59:24.886204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:59:24.919505 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: COMMIT
[0m23:59:24.920419 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:59:24.921202 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: COMMIT
[0m23:59:24.924557 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:59:24.936824 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_rent__dbt_backup"
[0m23:59:24.945667 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent"
[0m23:59:24.946579 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent"} */
drop view if exists "foo"."zap"."gold_apartment_rent__dbt_backup" cascade
[0m23:59:24.951074 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:59:24.955903 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent: Close
[0m23:59:24.959440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09f4a67c-d09b-4e69-9538-a3614884d8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7196db37f0>]}
[0m23:59:24.960967 [info ] [Thread-1 (]: 1 of 1 OK created sql view model zap.gold_apartment_rent ....................... [[32mCREATE VIEW[0m in 0.21s]
[0m23:59:24.962329 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent
[0m23:59:24.964596 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:24.965368 [debug] [MainThread]: On master: BEGIN
[0m23:59:24.966053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:59:24.978935 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m23:59:24.979995 [debug] [MainThread]: On master: COMMIT
[0m23:59:24.981165 [debug] [MainThread]: Using postgres connection "master"
[0m23:59:24.981995 [debug] [MainThread]: On master: COMMIT
[0m23:59:24.983370 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:59:24.984348 [debug] [MainThread]: On master: Close
[0m23:59:24.985444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:59:24.986156 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent' was properly closed.
[0m23:59:24.986925 [info ] [MainThread]: 
[0m23:59:24.987712 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m23:59:24.989058 [debug] [MainThread]: Command end result
[0m23:59:25.033135 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m23:59:25.036134 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m23:59:25.048629 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m23:59:25.049402 [info ] [MainThread]: 
[0m23:59:25.050413 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:59:25.051431 [info ] [MainThread]: 
[0m23:59:25.052396 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:59:25.054215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7186539, "process_in_blocks": "0", "process_kernel_time": 0.241198, "process_mem_max_rss": "110580", "process_out_blocks": "1768", "process_user_time": 3.701046}
[0m23:59:25.055156 [debug] [MainThread]: Command `dbt run` succeeded at 23:59:25.054992 after 1.72 seconds
[0m23:59:25.056113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7199094f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d719a0bb910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7198f5e200>]}
[0m23:59:25.057088 [debug] [MainThread]: Flushing usage events
[0m23:59:26.282018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:26:06.500867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d9dd4ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dac624a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dac62440>]}


============================== 08:26:06.504517 | 0685982a-c8db-46f6-97bc-5626100a4438 ==============================
[0m08:26:06.504517 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:26:06.505357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:26:06.722071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0685982a-c8db-46f6-97bc-5626100a4438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dac59c30>]}
[0m08:26:06.797648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0685982a-c8db-46f6-97bc-5626100a4438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dac5a200>]}
[0m08:26:06.798717 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:26:06.930442 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:26:07.082747 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 1 files added, 0 files changed.
[0m08:26:07.083502 [debug] [MainThread]: Partial parsing: added file: zap_imoveis://models/mart/gold_kitnet_rent .sql
[0m08:26:07.083995 [debug] [MainThread]: Partial parsing: deleted file: zap_imoveis://models/mart/gold_apartment_rent.sql
[0m08:26:07.084426 [debug] [MainThread]: Partial parsing: deleted file: zap_imoveis://models/mart/gold_apartment_sale.sql
[0m08:26:07.084861 [debug] [MainThread]: Partial parsing: deleted file: zap_imoveis://models/mart/gold_studio_sale.sql
[0m08:26:07.085282 [debug] [MainThread]: Partial parsing: deleted file: zap_imoveis://models/mart/gold_flat_sale.sql
[0m08:26:07.085704 [debug] [MainThread]: Partial parsing: deleted file: zap_imoveis://models/mart/gold_house_sale.sql
[0m08:26:07.408649 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'gold_apartment_rent' in the 'models' section of file 'models/mart/schema.yml'
[0m08:26:07.495639 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m08:26:07.496375 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m08:26:07.496915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0685982a-c8db-46f6-97bc-5626100a4438', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d7f40280>]}
[0m08:26:07.498101 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_rent
[0m08:26:07.520328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0685982a-c8db-46f6-97bc-5626100a4438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d7bb1330>]}
[0m08:26:07.628737 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:26:07.632679 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:26:07.645311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0685982a-c8db-46f6-97bc-5626100a4438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d81f1900>]}
[0m08:26:07.646073 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m08:26:07.646618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0685982a-c8db-46f6-97bc-5626100a4438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d81f17b0>]}
[0m08:26:07.648887 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:26:07.649816 [debug] [MainThread]: Command end result
[0m08:26:07.675855 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:26:07.677941 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:26:07.682188 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m08:26:07.683388 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2603312, "process_in_blocks": "0", "process_kernel_time": 0.160065, "process_mem_max_rss": "106172", "process_out_blocks": "2536", "process_user_time": 2.585065}
[0m08:26:07.684034 [debug] [MainThread]: Command `dbt run` succeeded at 08:26:07.683926 after 1.26 seconds
[0m08:26:07.684546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d9dd4ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d9c9c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dac5a200>]}
[0m08:26:07.685088 [debug] [MainThread]: Flushing usage events
[0m08:26:09.327939 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:26:50.306255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ede35a8ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ede3695a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ede3695a260>]}


============================== 08:26:50.309487 | d24b87e0-4b76-42ce-939e-985eadb6074a ==============================
[0m08:26:50.309487 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:26:50.310321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:26:50.523038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd24b87e0-4b76-42ce-939e-985eadb6074a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ede34db95a0>]}
[0m08:26:50.598737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd24b87e0-4b76-42ce-939e-985eadb6074a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ede3519fb50>]}
[0m08:26:50.599798 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:26:50.732044 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:26:50.861050 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:26:50.861794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd24b87e0-4b76-42ce-939e-985eadb6074a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ede3527b100>]}
[0m08:26:52.128518 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'gold_apartment_rent' in the 'models' section of file 'models/mart/schema.yml'
[0m08:26:52.354926 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m08:26:52.355657 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m08:26:52.356304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd24b87e0-4b76-42ce-939e-985eadb6074a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ede341bcca0>]}
[0m08:26:52.357374 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_ren_avg_prices
[0m08:26:52.375660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd24b87e0-4b76-42ce-939e-985eadb6074a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ede33b90be0>]}
[0m08:26:52.481164 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:26:52.485562 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:26:52.498034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd24b87e0-4b76-42ce-939e-985eadb6074a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ede33cf4640>]}
[0m08:26:52.498775 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m08:26:52.499302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd24b87e0-4b76-42ce-939e-985eadb6074a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ede33cf4610>]}
[0m08:26:52.501149 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:26:52.502139 [debug] [MainThread]: Command end result
[0m08:26:52.528924 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:26:52.530836 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:26:52.534881 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m08:26:52.536108 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3023891, "process_in_blocks": "0", "process_kernel_time": 0.164018, "process_mem_max_rss": "105912", "process_out_blocks": "2536", "process_user_time": 3.617398}
[0m08:26:52.536749 [debug] [MainThread]: Command `dbt run` succeeded at 08:26:52.536637 after 2.30 seconds
[0m08:26:52.537287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ede35a8ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ede3519fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ede35955480>]}
[0m08:26:52.537844 [debug] [MainThread]: Flushing usage events
[0m08:26:53.871454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:28:11.790245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78997f818f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7899806d62c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7899806d6260>]}


============================== 08:28:11.794289 | 08f79cbc-c1af-4d79-bbc1-ed57491c273e ==============================
[0m08:28:11.794289 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:28:11.795112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:28:11.945907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08f79cbc-c1af-4d79-bbc1-ed57491c273e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7899806e3580>]}
[0m08:28:11.956974 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23948231, "process_in_blocks": "0", "process_kernel_time": 0.097091, "process_mem_max_rss": "89268", "process_out_blocks": "16", "process_user_time": 1.631534}
[0m08:28:11.957645 [debug] [MainThread]: Command `dbt clean` succeeded at 08:28:11.957531 after 0.24 seconds
[0m08:28:11.958163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78997f818f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7899806e2ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78997e772620>]}
[0m08:28:11.958707 [debug] [MainThread]: Flushing usage events
[0m08:28:12.758371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:28:22.982879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04961d4ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0497062380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0497062320>]}


============================== 08:28:22.986135 | 7397bc17-eb01-4ae5-b1b0-43e9992255aa ==============================
[0m08:28:22.986135 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:28:22.986900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:28:23.195820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7397bc17-eb01-4ae5-b1b0-43e9992255aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04951ce3b0>]}
[0m08:28:23.270696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7397bc17-eb01-4ae5-b1b0-43e9992255aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0495f58850>]}
[0m08:28:23.271766 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:28:23.404024 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:28:23.404964 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:28:23.405491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7397bc17-eb01-4ae5-b1b0-43e9992255aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0494b8fa30>]}
[0m08:28:24.718354 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'gold_apartment_rent' in the 'models' section of file 'models/mart/schema.yml'
[0m08:28:24.948044 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m08:28:24.948773 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m08:28:24.949333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7397bc17-eb01-4ae5-b1b0-43e9992255aa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04945f6110>]}
[0m08:28:24.950387 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_ren_avg_prices
[0m08:28:24.968076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7397bc17-eb01-4ae5-b1b0-43e9992255aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04943e0340>]}
[0m08:28:25.076532 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:28:25.080205 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:28:25.092258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7397bc17-eb01-4ae5-b1b0-43e9992255aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e049438e0b0>]}
[0m08:28:25.093009 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m08:28:25.093520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7397bc17-eb01-4ae5-b1b0-43e9992255aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e049438e1a0>]}
[0m08:28:25.095601 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:28:25.096517 [debug] [MainThread]: Command end result
[0m08:28:25.124321 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:28:25.126496 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:28:25.130745 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m08:28:25.131967 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2213295, "process_in_blocks": "0", "process_kernel_time": 0.144948, "process_mem_max_rss": "104632", "process_out_blocks": "2536", "process_user_time": 3.596726}
[0m08:28:25.132599 [debug] [MainThread]: Command `dbt run` succeeded at 08:28:25.132492 after 2.22 seconds
[0m08:28:25.133134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04961d4ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0495f58850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e0493f34430>]}
[0m08:28:25.133693 [debug] [MainThread]: Flushing usage events
[0m08:28:25.930235 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:29:32.693005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a87ba95ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a87bb806320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a87bb8062c0>]}


============================== 08:29:32.696322 | 8b00e67b-cf30-40c0-b62f-f85a6624250c ==============================
[0m08:29:32.696322 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:29:32.697177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:29:32.905626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b00e67b-cf30-40c0-b62f-f85a6624250c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a87bb9838b0>]}
[0m08:29:32.982295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b00e67b-cf30-40c0-b62f-f85a6624250c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a87bb8221a0>]}
[0m08:29:32.983338 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:29:33.116322 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:29:33.268061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:29:33.268817 [debug] [MainThread]: Partial parsing: added file: zap_imoveis://models/mart/gold_apartment_rent_avg_prices.sql
[0m08:29:33.512618 [error] [MainThread]: Encountered an error:
Compilation Error in model gold_apartment_rent_avg_prices (models/mart/gold_apartment_rent_avg_prices.sql)
  The source name (first) argument to source() must be a string, got <class 'dbt_common.clients.jinja.create_undefined.<locals>.Undefined'>
[0m08:29:33.513911 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8933864, "process_in_blocks": "0", "process_kernel_time": 0.149148, "process_mem_max_rss": "101480", "process_out_blocks": "24", "process_user_time": 2.23923}
[0m08:29:33.514578 [debug] [MainThread]: Command `dbt run` failed at 08:29:33.514464 after 0.89 seconds
[0m08:29:33.515190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a87ba95ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a87b8b12a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a87b8d2b3d0>]}
[0m08:29:33.515747 [debug] [MainThread]: Flushing usage events
[0m08:29:34.873388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:29:53.989319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a446e5cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a447d2e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a447d2e380>]}


============================== 08:29:53.992651 | ad19002d-9a5e-47de-a092-45e9c0bdbb7d ==============================
[0m08:29:53.992651 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:29:53.993413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:29:54.204022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad19002d-9a5e-47de-a092-45e9c0bdbb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a447e83910>]}
[0m08:29:54.279658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad19002d-9a5e-47de-a092-45e9c0bdbb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a446642800>]}
[0m08:29:54.280699 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:29:54.412279 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:29:54.564682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:29:54.565431 [debug] [MainThread]: Partial parsing: added file: zap_imoveis://models/mart/gold_apartment_rent_avg_prices.sql
[0m08:29:54.888041 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m08:29:54.888774 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m08:29:54.889403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ad19002d-9a5e-47de-a092-45e9c0bdbb7d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a446640d60>]}
[0m08:29:54.890529 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_ren_avg_prices
[0m08:29:54.911882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad19002d-9a5e-47de-a092-45e9c0bdbb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a4450dbfd0>]}
[0m08:29:55.020981 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:29:55.024895 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:29:55.038042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad19002d-9a5e-47de-a092-45e9c0bdbb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a4455df250>]}
[0m08:29:55.038818 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m08:29:55.039454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad19002d-9a5e-47de-a092-45e9c0bdbb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a44516a0e0>]}
[0m08:29:55.041605 [info ] [MainThread]: 
[0m08:29:55.042260 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:29:55.042741 [info ] [MainThread]: 
[0m08:29:55.043492 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:29:55.045253 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m08:29:55.090913 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m08:29:55.091525 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m08:29:55.091985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:55.103196 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m08:29:55.104948 [debug] [ThreadPool]: On list_foo: Close
[0m08:29:55.112872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m08:29:55.122302 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:29:55.122908 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m08:29:55.123352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:29:55.132336 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m08:29:55.132938 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:29:55.133399 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m08:29:55.136489 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m08:29:55.138679 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m08:29:55.139500 [debug] [ThreadPool]: On list_foo_zap: Close
[0m08:29:55.146308 [debug] [MainThread]: Using postgres connection "master"
[0m08:29:55.146902 [debug] [MainThread]: On master: BEGIN
[0m08:29:55.147327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:29:55.156677 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:29:55.157309 [debug] [MainThread]: Using postgres connection "master"
[0m08:29:55.157846 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:29:55.162225 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m08:29:55.164541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad19002d-9a5e-47de-a092-45e9c0bdbb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a447cdd6c0>]}
[0m08:29:55.165191 [debug] [MainThread]: On master: ROLLBACK
[0m08:29:55.166013 [debug] [MainThread]: Using postgres connection "master"
[0m08:29:55.166509 [debug] [MainThread]: On master: BEGIN
[0m08:29:55.167345 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:29:55.167861 [debug] [MainThread]: On master: COMMIT
[0m08:29:55.168330 [debug] [MainThread]: Using postgres connection "master"
[0m08:29:55.168761 [debug] [MainThread]: On master: COMMIT
[0m08:29:55.169502 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:29:55.170037 [debug] [MainThread]: On master: Close
[0m08:29:55.172895 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m08:29:55.173737 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent_avg_prices ................. [RUN]
[0m08:29:55.174520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent_avg_prices)
[0m08:29:55.175127 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m08:29:55.187037 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:29:55.188343 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m08:29:55.290563 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:29:55.291765 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:29:55.292488 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: BEGIN
[0m08:29:55.293074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:29:55.302020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m08:29:55.302706 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:29:55.303303 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */

  create view "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
)


with final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent::numeric), 2) as price_rent_avg,
	ROUND(avg(price_condominium::numeric), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo::numeric),2) as rent_plus_condo_avg,
	ROUND((avg(price_rent::numeric)/avg(floor_size)) , 2) as price_rent_per_m2_avg,
	ROUND((sum(rent_plus_condo)/sum(floor_size)/count(id))::numeric, 2) as rent_plus_condo__per_m2_avg
	from zap.gold_apartment_rent gar 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m08:29:55.304342 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "WHERE"
LINE 9:     WHERE WHERE kind in ('Apartamentos à Venda', 'Apartament...
                  ^

[0m08:29:55.304991 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: ROLLBACK
[0m08:29:55.305971 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: Close
[0m08:29:55.310427 [debug] [Thread-1 (]: Database Error in model gold_apartment_rent_avg_prices (models/mart/gold_apartment_rent_avg_prices.sql)
  syntax error at or near "WHERE"
  LINE 9:     WHERE WHERE kind in ('Apartamentos à Venda', 'Apartament...
                    ^
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_rent_avg_prices.sql
[0m08:29:55.312796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad19002d-9a5e-47de-a092-45e9c0bdbb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a44573c8b0>]}
[0m08:29:55.313793 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model zap.gold_apartment_rent_avg_prices ........ [[31mERROR[0m in 0.14s]
[0m08:29:55.314672 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m08:29:55.316093 [debug] [Thread-7 (]: Marking all children of 'model.zap_imoveis.gold_apartment_rent_avg_prices' to be skipped because of status 'error'.  Reason: Database Error in model gold_apartment_rent_avg_prices (models/mart/gold_apartment_rent_avg_prices.sql)
  syntax error at or near "WHERE"
  LINE 9:     WHERE WHERE kind in ('Apartamentos à Venda', 'Apartament...
                    ^
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_rent_avg_prices.sql.
[0m08:29:55.318576 [debug] [MainThread]: Using postgres connection "master"
[0m08:29:55.319406 [debug] [MainThread]: On master: BEGIN
[0m08:29:55.319983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:29:55.329113 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:29:55.329722 [debug] [MainThread]: On master: COMMIT
[0m08:29:55.330220 [debug] [MainThread]: Using postgres connection "master"
[0m08:29:55.330663 [debug] [MainThread]: On master: COMMIT
[0m08:29:55.331331 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:29:55.331838 [debug] [MainThread]: On master: Close
[0m08:29:55.332710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:29:55.333438 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent_avg_prices' was properly closed.
[0m08:29:55.334166 [info ] [MainThread]: 
[0m08:29:55.334853 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m08:29:55.336090 [debug] [MainThread]: Command end result
[0m08:29:55.364337 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:29:55.366384 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:29:55.376247 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m08:29:55.376831 [info ] [MainThread]: 
[0m08:29:55.377394 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:29:55.377938 [info ] [MainThread]: 
[0m08:29:55.378502 [error] [MainThread]:   Database Error in model gold_apartment_rent_avg_prices (models/mart/gold_apartment_rent_avg_prices.sql)
  syntax error at or near "WHERE"
  LINE 9:     WHERE WHERE kind in ('Apartamentos à Venda', 'Apartament...
                    ^
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_rent_avg_prices.sql
[0m08:29:55.378991 [info ] [MainThread]: 
[0m08:29:55.379484 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:29:55.380627 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4635838, "process_in_blocks": "56", "process_kernel_time": 0.1881, "process_mem_max_rss": "113844", "process_out_blocks": "2592", "process_user_time": 2.72445}
[0m08:29:55.381313 [debug] [MainThread]: Command `dbt run` failed at 08:29:55.381188 after 1.46 seconds
[0m08:29:55.381865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a446e5cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a44513fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a44513fc70>]}
[0m08:29:55.382449 [debug] [MainThread]: Flushing usage events
[0m08:29:56.964866 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:30:06.208978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4eba60ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4ec92e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4ec92e440>]}


============================== 08:30:06.212240 | 6f9ab155-ce2b-4cae-99ac-7e7f9269acd8 ==============================
[0m08:30:06.212240 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:30:06.213065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:30:06.423404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f9ab155-ce2b-4cae-99ac-7e7f9269acd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4ec925c30>]}
[0m08:30:06.499924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f9ab155-ce2b-4cae-99ac-7e7f9269acd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4ec926200>]}
[0m08:30:06.501005 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:30:06.633431 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:30:06.790728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:30:06.791591 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_apartment_rent_avg_prices.sql
[0m08:30:07.123294 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m08:30:07.124063 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m08:30:07.124735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6f9ab155-ce2b-4cae-99ac-7e7f9269acd8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4ea7670d0>]}
[0m08:30:07.125930 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_ren_avg_prices
[0m08:30:07.147835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f9ab155-ce2b-4cae-99ac-7e7f9269acd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4e9cd4100>]}
[0m08:30:07.256575 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:30:07.260558 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:30:07.273853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f9ab155-ce2b-4cae-99ac-7e7f9269acd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4e9d575e0>]}
[0m08:30:07.274661 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m08:30:07.275523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f9ab155-ce2b-4cae-99ac-7e7f9269acd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4e9ca1ba0>]}
[0m08:30:07.277742 [info ] [MainThread]: 
[0m08:30:07.278385 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:30:07.278890 [info ] [MainThread]: 
[0m08:30:07.279635 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:30:07.281307 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m08:30:07.326251 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m08:30:07.326862 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m08:30:07.327331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:30:07.337866 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m08:30:07.339574 [debug] [ThreadPool]: On list_foo: Close
[0m08:30:07.347187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m08:30:07.355954 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:30:07.356539 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m08:30:07.357002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:30:07.366197 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m08:30:07.366820 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:30:07.367330 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m08:30:07.370485 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m08:30:07.373074 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m08:30:07.373911 [debug] [ThreadPool]: On list_foo_zap: Close
[0m08:30:07.381126 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:07.381708 [debug] [MainThread]: On master: BEGIN
[0m08:30:07.382158 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:30:07.390557 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m08:30:07.391172 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:07.391706 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:30:07.396469 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m08:30:07.399463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f9ab155-ce2b-4cae-99ac-7e7f9269acd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4ec8df5b0>]}
[0m08:30:07.400140 [debug] [MainThread]: On master: ROLLBACK
[0m08:30:07.400904 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:07.401425 [debug] [MainThread]: On master: BEGIN
[0m08:30:07.402295 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:30:07.402839 [debug] [MainThread]: On master: COMMIT
[0m08:30:07.403309 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:07.403743 [debug] [MainThread]: On master: COMMIT
[0m08:30:07.404434 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:30:07.404983 [debug] [MainThread]: On master: Close
[0m08:30:07.408038 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m08:30:07.408924 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent_avg_prices ................. [RUN]
[0m08:30:07.409731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent_avg_prices)
[0m08:30:07.410362 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m08:30:07.422225 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:30:07.423215 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m08:30:07.524726 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:30:07.525747 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:30:07.526362 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: BEGIN
[0m08:30:07.526954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:30:07.536321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m08:30:07.537051 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:30:07.537622 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */

  create view "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
)


with final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent::numeric), 2) as price_rent_avg,
	ROUND(avg(price_condominium::numeric), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo::numeric),2) as rent_plus_condo_avg,
	ROUND((avg(price_rent::numeric)/avg(floor_size)) , 2) as price_rent_per_m2_avg,
	ROUND((sum(rent_plus_condo)/sum(floor_size)/count(id))::numeric, 2) as rent_plus_condo__per_m2_avg
	from zap.gold_apartment_rent gar 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m08:30:07.538577 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "with"
LINE 13: with final as (
         ^

[0m08:30:07.539209 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: ROLLBACK
[0m08:30:07.540148 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: Close
[0m08:30:07.542611 [debug] [Thread-1 (]: Database Error in model gold_apartment_rent_avg_prices (models/mart/gold_apartment_rent_avg_prices.sql)
  syntax error at or near "with"
  LINE 13: with final as (
           ^
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_rent_avg_prices.sql
[0m08:30:07.545082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f9ab155-ce2b-4cae-99ac-7e7f9269acd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4e9d46c50>]}
[0m08:30:07.546120 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model zap.gold_apartment_rent_avg_prices ........ [[31mERROR[0m in 0.13s]
[0m08:30:07.547019 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m08:30:07.548238 [debug] [Thread-7 (]: Marking all children of 'model.zap_imoveis.gold_apartment_rent_avg_prices' to be skipped because of status 'error'.  Reason: Database Error in model gold_apartment_rent_avg_prices (models/mart/gold_apartment_rent_avg_prices.sql)
  syntax error at or near "with"
  LINE 13: with final as (
           ^
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_rent_avg_prices.sql.
[0m08:30:07.550818 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:07.551428 [debug] [MainThread]: On master: BEGIN
[0m08:30:07.551982 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:30:07.560820 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:30:07.561425 [debug] [MainThread]: On master: COMMIT
[0m08:30:07.561927 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:07.562370 [debug] [MainThread]: On master: COMMIT
[0m08:30:07.563067 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:30:07.563593 [debug] [MainThread]: On master: Close
[0m08:30:07.564359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:30:07.564905 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent_avg_prices' was properly closed.
[0m08:30:07.565420 [info ] [MainThread]: 
[0m08:30:07.566000 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m08:30:07.567047 [debug] [MainThread]: Command end result
[0m08:30:07.594807 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:30:07.596850 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:30:07.606061 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m08:30:07.606674 [info ] [MainThread]: 
[0m08:30:07.607410 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:30:07.607999 [info ] [MainThread]: 
[0m08:30:07.608556 [error] [MainThread]:   Database Error in model gold_apartment_rent_avg_prices (models/mart/gold_apartment_rent_avg_prices.sql)
  syntax error at or near "with"
  LINE 13: with final as (
           ^
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_rent_avg_prices.sql
[0m08:30:07.609052 [info ] [MainThread]: 
[0m08:30:07.609560 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:30:07.610735 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4744949, "process_in_blocks": "0", "process_kernel_time": 0.178976, "process_mem_max_rss": "113852", "process_out_blocks": "2592", "process_user_time": 2.747636}
[0m08:30:07.611395 [debug] [MainThread]: Command `dbt run` failed at 08:30:07.611289 after 1.48 seconds
[0m08:30:07.611927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4eba60ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4ea13be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da4ea13bb50>]}
[0m08:30:07.612533 [debug] [MainThread]: Flushing usage events
[0m08:30:08.942147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:30:58.348020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fc55394e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fc56262320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fc562622c0>]}


============================== 08:30:58.351281 | edfcea09-3648-4071-93c8-da961e9d3bdf ==============================
[0m08:30:58.351281 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:30:58.352046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:30:58.561574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edfcea09-3648-4071-93c8-da961e9d3bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fc563bb880>]}
[0m08:30:58.636863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edfcea09-3648-4071-93c8-da961e9d3bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fc5625a1a0>]}
[0m08:30:58.637923 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:30:58.771657 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:30:58.923360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:30:58.924176 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_apartment_rent_avg_prices.sql
[0m08:30:59.248605 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m08:30:59.249463 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m08:30:59.250167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'edfcea09-3648-4071-93c8-da961e9d3bdf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fc53680fa0>]}
[0m08:30:59.251302 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_ren_avg_prices
[0m08:30:59.271641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edfcea09-3648-4071-93c8-da961e9d3bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fc535d7fd0>]}
[0m08:30:59.380710 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:30:59.384707 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:30:59.400860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edfcea09-3648-4071-93c8-da961e9d3bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fc535aaa70>]}
[0m08:30:59.401978 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m08:30:59.402917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edfcea09-3648-4071-93c8-da961e9d3bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fc5364d360>]}
[0m08:30:59.405653 [info ] [MainThread]: 
[0m08:30:59.406375 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:30:59.407276 [info ] [MainThread]: 
[0m08:30:59.408753 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:30:59.410456 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m08:30:59.456422 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m08:30:59.457045 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m08:30:59.457529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:30:59.469515 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m08:30:59.471826 [debug] [ThreadPool]: On list_foo: Close
[0m08:30:59.478641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m08:30:59.487409 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:30:59.488016 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m08:30:59.488475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:30:59.497872 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m08:30:59.498482 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:30:59.498992 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m08:30:59.503019 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m08:30:59.504763 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m08:30:59.505539 [debug] [ThreadPool]: On list_foo_zap: Close
[0m08:30:59.512813 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:59.513398 [debug] [MainThread]: On master: BEGIN
[0m08:30:59.513840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:30:59.522905 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:30:59.523498 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:59.524035 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:30:59.528669 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m08:30:59.531107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edfcea09-3648-4071-93c8-da961e9d3bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fc543ce8f0>]}
[0m08:30:59.531748 [debug] [MainThread]: On master: ROLLBACK
[0m08:30:59.532561 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:59.533087 [debug] [MainThread]: On master: BEGIN
[0m08:30:59.534116 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:30:59.534642 [debug] [MainThread]: On master: COMMIT
[0m08:30:59.535116 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:59.535552 [debug] [MainThread]: On master: COMMIT
[0m08:30:59.536233 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:30:59.536741 [debug] [MainThread]: On master: Close
[0m08:30:59.539528 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m08:30:59.540387 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent_avg_prices ................. [RUN]
[0m08:30:59.541226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent_avg_prices)
[0m08:30:59.541843 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m08:30:59.553406 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:30:59.554881 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m08:30:59.657478 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:30:59.658498 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:30:59.659110 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: BEGIN
[0m08:30:59.659658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:30:59.669242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m08:30:59.669971 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:30:59.670561 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */

  create view "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
)
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent::numeric), 2) as price_rent_avg,
	ROUND(avg(price_condominium::numeric), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo::numeric),2) as rent_plus_condo_avg,
	ROUND((avg(price_rent::numeric)/avg(floor_size)) , 2) as price_rent_per_m2_avg,
	ROUND((sum(rent_plus_condo)/sum(floor_size)/count(id))::numeric, 2) as rent_plus_condo__per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m08:30:59.671492 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "final"
LINE 11: final as (
         ^

[0m08:30:59.672131 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: ROLLBACK
[0m08:30:59.673085 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: Close
[0m08:30:59.675540 [debug] [Thread-1 (]: Database Error in model gold_apartment_rent_avg_prices (models/mart/gold_apartment_rent_avg_prices.sql)
  syntax error at or near "final"
  LINE 11: final as (
           ^
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_rent_avg_prices.sql
[0m08:30:59.678066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edfcea09-3648-4071-93c8-da961e9d3bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fc52a56dd0>]}
[0m08:30:59.679090 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model zap.gold_apartment_rent_avg_prices ........ [[31mERROR[0m in 0.14s]
[0m08:30:59.679984 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m08:30:59.681193 [debug] [Thread-7 (]: Marking all children of 'model.zap_imoveis.gold_apartment_rent_avg_prices' to be skipped because of status 'error'.  Reason: Database Error in model gold_apartment_rent_avg_prices (models/mart/gold_apartment_rent_avg_prices.sql)
  syntax error at or near "final"
  LINE 11: final as (
           ^
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_rent_avg_prices.sql.
[0m08:30:59.684243 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:59.684998 [debug] [MainThread]: On master: BEGIN
[0m08:30:59.685554 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:30:59.694030 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m08:30:59.694629 [debug] [MainThread]: On master: COMMIT
[0m08:30:59.695115 [debug] [MainThread]: Using postgres connection "master"
[0m08:30:59.695552 [debug] [MainThread]: On master: COMMIT
[0m08:30:59.696201 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:30:59.696685 [debug] [MainThread]: On master: Close
[0m08:30:59.697529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:30:59.698258 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent_avg_prices' was properly closed.
[0m08:30:59.698998 [info ] [MainThread]: 
[0m08:30:59.699665 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m08:30:59.700906 [debug] [MainThread]: Command end result
[0m08:30:59.728389 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:30:59.730449 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:30:59.739477 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m08:30:59.740125 [info ] [MainThread]: 
[0m08:30:59.740757 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:30:59.741336 [info ] [MainThread]: 
[0m08:30:59.741917 [error] [MainThread]:   Database Error in model gold_apartment_rent_avg_prices (models/mart/gold_apartment_rent_avg_prices.sql)
  syntax error at or near "final"
  LINE 11: final as (
           ^
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_rent_avg_prices.sql
[0m08:30:59.742422 [info ] [MainThread]: 
[0m08:30:59.742970 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:30:59.744184 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4678434, "process_in_blocks": "0", "process_kernel_time": 0.168992, "process_mem_max_rss": "113988", "process_out_blocks": "2600", "process_user_time": 2.743876}
[0m08:30:59.744853 [debug] [MainThread]: Command `dbt run` failed at 08:30:59.744725 after 1.47 seconds
[0m08:30:59.745386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fc55394e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fc53b66110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75fc5364cbb0>]}
[0m08:30:59.745950 [debug] [MainThread]: Flushing usage events
[0m08:31:01.782310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:31:09.644370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74baae478f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74baaf2f63e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74baaf2f6380>]}


============================== 08:31:09.648180 | 70fb60c0-0de3-47ef-bef3-3ff4d5a63e58 ==============================
[0m08:31:09.648180 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:31:09.648968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:31:09.859912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70fb60c0-0de3-47ef-bef3-3ff4d5a63e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74baaf48f910>]}
[0m08:31:09.936720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70fb60c0-0de3-47ef-bef3-3ff4d5a63e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74baadc3e800>]}
[0m08:31:09.937795 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:31:10.070910 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:31:10.223340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:31:10.224182 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_apartment_rent_avg_prices.sql
[0m08:31:10.548577 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m08:31:10.549342 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m08:31:10.549979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '70fb60c0-0de3-47ef-bef3-3ff4d5a63e58', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74baae33dc00>]}
[0m08:31:10.551122 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_ren_avg_prices
[0m08:31:10.572313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70fb60c0-0de3-47ef-bef3-3ff4d5a63e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74baac6c0130>]}
[0m08:31:10.679517 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:31:10.683441 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:31:10.696467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70fb60c0-0de3-47ef-bef3-3ff4d5a63e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74baac7370d0>]}
[0m08:31:10.697224 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m08:31:10.697736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70fb60c0-0de3-47ef-bef3-3ff4d5a63e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74baac736f20>]}
[0m08:31:10.699887 [info ] [MainThread]: 
[0m08:31:10.700650 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:31:10.701200 [info ] [MainThread]: 
[0m08:31:10.701944 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:31:10.703686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m08:31:10.748995 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m08:31:10.749597 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m08:31:10.750124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:10.760633 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m08:31:10.762383 [debug] [ThreadPool]: On list_foo: Close
[0m08:31:10.770056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m08:31:10.778412 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:31:10.779008 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m08:31:10.779446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:31:10.789103 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m08:31:10.789715 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:31:10.790200 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m08:31:10.793549 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m08:31:10.796032 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m08:31:10.796857 [debug] [ThreadPool]: On list_foo_zap: Close
[0m08:31:10.804058 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:10.804640 [debug] [MainThread]: On master: BEGIN
[0m08:31:10.805100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:31:10.814147 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:31:10.814801 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:10.815386 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:31:10.820062 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m08:31:10.822617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70fb60c0-0de3-47ef-bef3-3ff4d5a63e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74baaf2c96c0>]}
[0m08:31:10.823277 [debug] [MainThread]: On master: ROLLBACK
[0m08:31:10.824087 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:10.824587 [debug] [MainThread]: On master: BEGIN
[0m08:31:10.825545 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:31:10.826087 [debug] [MainThread]: On master: COMMIT
[0m08:31:10.826562 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:10.827013 [debug] [MainThread]: On master: COMMIT
[0m08:31:10.827740 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:31:10.828288 [debug] [MainThread]: On master: Close
[0m08:31:10.831189 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m08:31:10.832095 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent_avg_prices ................. [RUN]
[0m08:31:10.832861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent_avg_prices)
[0m08:31:10.833503 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m08:31:10.844768 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:31:10.845728 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m08:31:10.951425 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:31:10.952456 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:31:10.953039 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: BEGIN
[0m08:31:10.953551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:31:10.962388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m08:31:10.963065 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:31:10.963618 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */

  create view "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent::numeric), 2) as price_rent_avg,
	ROUND(avg(price_condominium::numeric), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo::numeric),2) as rent_plus_condo_avg,
	ROUND((avg(price_rent::numeric)/avg(floor_size)) , 2) as price_rent_per_m2_avg,
	ROUND((sum(rent_plus_condo)/sum(floor_size)/count(id))::numeric, 2) as rent_plus_condo__per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m08:31:10.967558 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m08:31:10.976676 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:31:10.977471 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
alter table "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp" rename to "gold_apartment_rent_avg_prices"
[0m08:31:10.978669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:31:11.000454 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: COMMIT
[0m08:31:11.001448 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:31:11.002443 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: COMMIT
[0m08:31:11.006010 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:31:11.017134 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_rent_avg_prices__dbt_backup"
[0m08:31:11.024291 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m08:31:11.024988 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_rent_avg_prices__dbt_backup" cascade
[0m08:31:11.026289 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:31:11.030991 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: Close
[0m08:31:11.034425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70fb60c0-0de3-47ef-bef3-3ff4d5a63e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74baabb46dd0>]}
[0m08:31:11.035757 [info ] [Thread-1 (]: 1 of 1 OK created sql view model zap.gold_apartment_rent_avg_prices ............ [[32mCREATE VIEW[0m in 0.20s]
[0m08:31:11.036754 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m08:31:11.038357 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:11.039017 [debug] [MainThread]: On master: BEGIN
[0m08:31:11.039510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:31:11.049026 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:31:11.049810 [debug] [MainThread]: On master: COMMIT
[0m08:31:11.050414 [debug] [MainThread]: Using postgres connection "master"
[0m08:31:11.050919 [debug] [MainThread]: On master: COMMIT
[0m08:31:11.051674 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:31:11.052302 [debug] [MainThread]: On master: Close
[0m08:31:11.053328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:31:11.054469 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent_avg_prices' was properly closed.
[0m08:31:11.055770 [info ] [MainThread]: 
[0m08:31:11.056885 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m08:31:11.058276 [debug] [MainThread]: Command end result
[0m08:31:11.089033 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:31:11.091816 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:31:11.100531 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m08:31:11.101132 [info ] [MainThread]: 
[0m08:31:11.101712 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:31:11.102229 [info ] [MainThread]: 
[0m08:31:11.102839 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:31:11.104590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5331414, "process_in_blocks": "0", "process_kernel_time": 0.165732, "process_mem_max_rss": "113784", "process_out_blocks": "2592", "process_user_time": 2.82245}
[0m08:31:11.105388 [debug] [MainThread]: Command `dbt run` succeeded at 08:31:11.105259 after 1.53 seconds
[0m08:31:11.105932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74baae478f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bab0d62ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74baaeabbeb0>]}
[0m08:31:11.106489 [debug] [MainThread]: Flushing usage events
[0m08:31:12.534026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:12:18.764897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca72f18f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca73d963e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca73d96380>]}


============================== 09:12:18.768218 | 4c1036bc-6151-4ea5-8e4f-86f0c4394d1c ==============================
[0m09:12:18.768218 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:12:18.769052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:12:18.978234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c1036bc-6151-4ea5-8e4f-86f0c4394d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca73f33910>]}
[0m09:12:19.056002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c1036bc-6151-4ea5-8e4f-86f0c4394d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca726e2800>]}
[0m09:12:19.057084 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:12:19.214332 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:12:19.365802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:12:19.366385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:12:19.366971 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m09:12:19.367586 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m09:12:19.368109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4c1036bc-6151-4ea5-8e4f-86f0c4394d1c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca71323730>]}
[0m09:12:19.377265 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_ren_avg_prices
[0m09:12:19.427361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c1036bc-6151-4ea5-8e4f-86f0c4394d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca7136ead0>]}
[0m09:12:19.538099 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:12:19.542034 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:12:19.554818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c1036bc-6151-4ea5-8e4f-86f0c4394d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca71248af0>]}
[0m09:12:19.555665 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m09:12:19.556325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c1036bc-6151-4ea5-8e4f-86f0c4394d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca71248a30>]}
[0m09:12:19.558402 [info ] [MainThread]: 
[0m09:12:19.558986 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:12:19.559476 [info ] [MainThread]: 
[0m09:12:19.560188 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:12:19.561421 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m09:12:19.608458 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m09:12:19.609098 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m09:12:19.609601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:19.620220 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m09:12:19.621938 [debug] [ThreadPool]: On list_foo: Close
[0m09:12:19.629124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m09:12:19.638272 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:12:19.638858 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m09:12:19.639317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:12:19.647235 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:12:19.647830 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:12:19.648314 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m09:12:19.651909 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m09:12:19.654487 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m09:12:19.655330 [debug] [ThreadPool]: On list_foo_zap: Close
[0m09:12:19.661950 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:19.662550 [debug] [MainThread]: On master: BEGIN
[0m09:12:19.662981 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:12:19.671634 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:12:19.672241 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:19.672760 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:12:19.676789 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m09:12:19.678833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c1036bc-6151-4ea5-8e4f-86f0c4394d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca741a5ae0>]}
[0m09:12:19.679510 [debug] [MainThread]: On master: ROLLBACK
[0m09:12:19.680334 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:19.680862 [debug] [MainThread]: On master: BEGIN
[0m09:12:19.681698 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:12:19.682224 [debug] [MainThread]: On master: COMMIT
[0m09:12:19.682673 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:19.683131 [debug] [MainThread]: On master: COMMIT
[0m09:12:19.683800 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:12:19.684353 [debug] [MainThread]: On master: Close
[0m09:12:19.687457 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:12:19.688719 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent_avg_prices ................. [RUN]
[0m09:12:19.689827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent_avg_prices)
[0m09:12:19.690677 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:12:19.702901 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:12:19.704059 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:12:19.752570 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:12:19.753597 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:12:19.754183 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: BEGIN
[0m09:12:19.754689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:12:19.763257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m09:12:19.763914 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:12:19.764492 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */

  create view "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent::numeric), 2) as price_rent_avg,
	ROUND(avg(price_condominium::numeric), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo::numeric),2) as rent_plus_condo_avg,
	ROUND((avg(price_rent::numeric)/avg(floor_size)) , 2) as price_rent_per_m2_avg,
	ROUND((sum(rent_plus_condo)/sum(floor_size)/count(id))::numeric, 2) as rent_plus_condo__per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m09:12:19.767874 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:12:19.777433 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:12:19.778475 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
alter table "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp" rename to "gold_apartment_rent_avg_prices"
[0m09:12:19.780240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:12:19.809575 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: COMMIT
[0m09:12:19.810564 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:12:19.811436 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: COMMIT
[0m09:12:19.814462 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:12:19.827096 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_rent_avg_prices__dbt_backup"
[0m09:12:19.836188 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:12:19.837152 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_rent_avg_prices__dbt_backup" cascade
[0m09:12:19.838475 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:12:19.843361 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: Close
[0m09:12:19.846679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c1036bc-6151-4ea5-8e4f-86f0c4394d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca70baf7f0>]}
[0m09:12:19.848456 [info ] [Thread-1 (]: 1 of 1 OK created sql view model zap.gold_apartment_rent_avg_prices ............ [[32mCREATE VIEW[0m in 0.16s]
[0m09:12:19.850161 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:12:19.852305 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:19.853042 [debug] [MainThread]: On master: BEGIN
[0m09:12:19.853779 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:12:19.865048 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m09:12:19.866131 [debug] [MainThread]: On master: COMMIT
[0m09:12:19.867160 [debug] [MainThread]: Using postgres connection "master"
[0m09:12:19.868213 [debug] [MainThread]: On master: COMMIT
[0m09:12:19.869651 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:12:19.870724 [debug] [MainThread]: On master: Close
[0m09:12:19.876432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:19.877420 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent_avg_prices' was properly closed.
[0m09:12:19.878506 [info ] [MainThread]: 
[0m09:12:19.879694 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m09:12:19.881558 [debug] [MainThread]: Command end result
[0m09:12:19.924751 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:12:19.927702 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:12:19.942387 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m09:12:19.942992 [info ] [MainThread]: 
[0m09:12:19.943687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:12:19.944215 [info ] [MainThread]: 
[0m09:12:19.944725 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:12:19.945904 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.253449, "process_in_blocks": "0", "process_kernel_time": 0.179385, "process_mem_max_rss": "110332", "process_out_blocks": "1752", "process_user_time": 2.513395}
[0m09:12:19.946589 [debug] [MainThread]: Command `dbt run` succeeded at 09:12:19.946473 after 1.25 seconds
[0m09:12:19.947124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca72f18f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca73f33910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ca72dd2200>]}
[0m09:12:19.947666 [debug] [MainThread]: Flushing usage events
[0m09:12:21.114340 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:16:43.976778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b01021cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0110ba4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0110ba440>]}


============================== 09:16:43.980228 | 05610f59-2f9e-4f1f-8ec6-1f8ab2a8040a ==============================
[0m09:16:43.980228 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:16:43.981175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:16:44.231080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05610f59-2f9e-4f1f-8ec6-1f8ab2a8040a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0110b1c30>]}
[0m09:16:44.323250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05610f59-2f9e-4f1f-8ec6-1f8ab2a8040a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b0110b2200>]}
[0m09:16:44.324336 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:16:44.456555 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:16:44.609133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:16:44.609989 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_apartment_rent_avg_prices.sql
[0m09:16:44.970287 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m09:16:44.971092 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m09:16:44.971820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '05610f59-2f9e-4f1f-8ec6-1f8ab2a8040a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b00f1ff0d0>]}
[0m09:16:44.973235 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_ren_avg_prices
[0m09:16:44.995427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05610f59-2f9e-4f1f-8ec6-1f8ab2a8040a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b00e3bc100>]}
[0m09:16:45.108984 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:16:45.112967 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:16:45.126971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05610f59-2f9e-4f1f-8ec6-1f8ab2a8040a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b00e4335e0>]}
[0m09:16:45.127734 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m09:16:45.128265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05610f59-2f9e-4f1f-8ec6-1f8ab2a8040a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b00e37dba0>]}
[0m09:16:45.130314 [info ] [MainThread]: 
[0m09:16:45.131002 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:16:45.131589 [info ] [MainThread]: 
[0m09:16:45.132404 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:16:45.134208 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m09:16:45.180158 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m09:16:45.180808 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m09:16:45.181358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:45.192204 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m09:16:45.194361 [debug] [ThreadPool]: On list_foo: Close
[0m09:16:45.202324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m09:16:45.210733 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:16:45.211354 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m09:16:45.211813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:16:45.221002 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:16:45.221645 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:16:45.222155 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m09:16:45.225227 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m09:16:45.226967 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m09:16:45.227724 [debug] [ThreadPool]: On list_foo_zap: Close
[0m09:16:45.235627 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:45.236235 [debug] [MainThread]: On master: BEGIN
[0m09:16:45.236684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:16:45.245624 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:16:45.246233 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:45.246839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:16:45.251967 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m09:16:45.254149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05610f59-2f9e-4f1f-8ec6-1f8ab2a8040a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b01106b5b0>]}
[0m09:16:45.254833 [debug] [MainThread]: On master: ROLLBACK
[0m09:16:45.255648 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:45.256168 [debug] [MainThread]: On master: BEGIN
[0m09:16:45.257125 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:16:45.257657 [debug] [MainThread]: On master: COMMIT
[0m09:16:45.258153 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:45.258597 [debug] [MainThread]: On master: COMMIT
[0m09:16:45.259332 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:16:45.259855 [debug] [MainThread]: On master: Close
[0m09:16:45.262922 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:16:45.264091 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent_avg_prices ................. [RUN]
[0m09:16:45.265075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent_avg_prices)
[0m09:16:45.265785 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:16:45.277221 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:16:45.278171 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:16:45.388513 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:16:45.389570 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:16:45.390176 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: BEGIN
[0m09:16:45.390731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:45.399919 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:16:45.400743 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:16:45.401898 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */

  create view "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent::numeric), 2) as price_rent_avg,
	ROUND(avg(price_condominium::numeric), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo::numeric),2) as rent_plus_condo_avg,
	ROUND((avg(price_rent::numeric)/avg(floor_size)) , 2) as price_rent_per_m2_avg,
	ROUND((sum(rent_plus_condo)/sum(floor_size)/count(id))::numeric, 2) as rent_plus_condo__per_m2_avg,
	avg(price_sale) as price_sale_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m09:16:45.405495 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:16:45.415795 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:16:45.416568 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
alter table "foo"."zap"."gold_apartment_rent_avg_prices" rename to "gold_apartment_rent_avg_prices__dbt_backup"
[0m09:16:45.418155 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:45.422766 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:16:45.423435 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
alter table "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp" rename to "gold_apartment_rent_avg_prices"
[0m09:16:45.424831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:16:45.448387 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: COMMIT
[0m09:16:45.449180 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:16:45.449860 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: COMMIT
[0m09:16:45.452539 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:16:45.461916 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_rent_avg_prices__dbt_backup"
[0m09:16:45.468741 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:16:45.469585 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_rent_avg_prices__dbt_backup" cascade
[0m09:16:45.473099 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:16:45.477487 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: Close
[0m09:16:45.480204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05610f59-2f9e-4f1f-8ec6-1f8ab2a8040a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b00d842dd0>]}
[0m09:16:45.481391 [info ] [Thread-1 (]: 1 of 1 OK created sql view model zap.gold_apartment_rent_avg_prices ............ [[32mCREATE VIEW[0m in 0.21s]
[0m09:16:45.482502 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:16:45.484403 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:45.485367 [debug] [MainThread]: On master: BEGIN
[0m09:16:45.486027 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:16:45.494689 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:16:45.495338 [debug] [MainThread]: On master: COMMIT
[0m09:16:45.495822 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:45.496295 [debug] [MainThread]: On master: COMMIT
[0m09:16:45.497279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:16:45.498075 [debug] [MainThread]: On master: Close
[0m09:16:45.499580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:16:45.500577 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent_avg_prices' was properly closed.
[0m09:16:45.501547 [info ] [MainThread]: 
[0m09:16:45.502474 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m09:16:45.503667 [debug] [MainThread]: Command end result
[0m09:16:45.534245 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:16:45.537189 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:16:45.546283 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m09:16:45.546892 [info ] [MainThread]: 
[0m09:16:45.547600 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:16:45.548215 [info ] [MainThread]: 
[0m09:16:45.548826 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:16:45.550221 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.652499, "process_in_blocks": "0", "process_kernel_time": 0.19407, "process_mem_max_rss": "113700", "process_out_blocks": "2592", "process_user_time": 3.163156}
[0m09:16:45.550971 [debug] [MainThread]: Command `dbt run` succeeded at 09:16:45.550815 after 1.65 seconds
[0m09:16:45.551700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b01021cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b00e396da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74b00ff9ca60>]}
[0m09:16:45.552355 [debug] [MainThread]: Flushing usage events
[0m09:16:46.931205 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:19:18.949604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351c4818f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351c56ba3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351c56ba380>]}


============================== 09:19:18.952942 | 3002fc70-2da3-417b-8667-fc9717c68616 ==============================
[0m09:19:18.952942 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:19:18.953815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:19:19.164249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3002fc70-2da3-417b-8667-fc9717c68616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351c5667220>]}
[0m09:19:19.240212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3002fc70-2da3-417b-8667-fc9717c68616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351c3790eb0>]}
[0m09:19:19.241265 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:19:19.374507 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:19:19.527520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:19:19.528358 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_apartment_rent_avg_prices.sql
[0m09:19:19.852687 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m09:19:19.853445 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m09:19:19.854128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3002fc70-2da3-417b-8667-fc9717c68616', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351c3fdc490>]}
[0m09:19:19.855288 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_ren_avg_prices
[0m09:19:19.875788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3002fc70-2da3-417b-8667-fc9717c68616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351c29bc130>]}
[0m09:19:19.984820 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:19:19.988738 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:19:20.002672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3002fc70-2da3-417b-8667-fc9717c68616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351c2bcb9d0>]}
[0m09:19:20.003548 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m09:19:20.004149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3002fc70-2da3-417b-8667-fc9717c68616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351c29fae00>]}
[0m09:19:20.006171 [info ] [MainThread]: 
[0m09:19:20.006793 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:19:20.007398 [info ] [MainThread]: 
[0m09:19:20.008518 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:19:20.010616 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m09:19:20.055787 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m09:19:20.056441 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m09:19:20.056925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:20.067518 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m09:19:20.069258 [debug] [ThreadPool]: On list_foo: Close
[0m09:19:20.076624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m09:19:20.085513 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:19:20.086121 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m09:19:20.086570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:20.095777 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:19:20.096398 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:19:20.096866 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m09:19:20.100851 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m09:19:20.102629 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m09:19:20.103492 [debug] [ThreadPool]: On list_foo_zap: Close
[0m09:19:20.110817 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:20.111554 [debug] [MainThread]: On master: BEGIN
[0m09:19:20.112078 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:19:20.120728 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:19:20.121336 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:20.121857 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:19:20.126264 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m09:19:20.129154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3002fc70-2da3-417b-8667-fc9717c68616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351c5666290>]}
[0m09:19:20.129801 [debug] [MainThread]: On master: ROLLBACK
[0m09:19:20.130616 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:20.131139 [debug] [MainThread]: On master: BEGIN
[0m09:19:20.131962 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:19:20.132506 [debug] [MainThread]: On master: COMMIT
[0m09:19:20.132963 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:20.133416 [debug] [MainThread]: On master: COMMIT
[0m09:19:20.134182 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:19:20.134741 [debug] [MainThread]: On master: Close
[0m09:19:20.137930 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:19:20.138864 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent_avg_prices ................. [RUN]
[0m09:19:20.139689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent_avg_prices)
[0m09:19:20.140330 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:19:20.151696 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:19:20.152639 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:19:20.256438 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:19:20.257449 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:19:20.258038 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: BEGIN
[0m09:19:20.258583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:19:20.268239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m09:19:20.268904 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:19:20.269532 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */

  create view "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	avg(price_rent) as price_rent_avg,
	avg(price_condominium) as price_condominium_avg,
	avg(rent_plus_condo) as rent_plus_condo_avg,
	avg(price_rent) / avg(floor_size) as price_rent_per_m2_avg,
	avg(rent_plus_condo) / avg(floor_size) as rent_plus_condo__per_m2_avg,
	avg(price_sale) as price_sale_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m09:19:20.273357 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:19:20.283823 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:19:20.284510 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
alter table "foo"."zap"."gold_apartment_rent_avg_prices" rename to "gold_apartment_rent_avg_prices__dbt_backup"
[0m09:19:20.286032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:19:20.290344 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:19:20.290954 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
alter table "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp" rename to "gold_apartment_rent_avg_prices"
[0m09:19:20.292448 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:19:20.315163 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: COMMIT
[0m09:19:20.315853 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:19:20.316415 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: COMMIT
[0m09:19:20.318516 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:19:20.327681 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_rent_avg_prices__dbt_backup"
[0m09:19:20.333844 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:19:20.334568 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_rent_avg_prices__dbt_backup" cascade
[0m09:19:20.338570 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:19:20.343081 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: Close
[0m09:19:20.345731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3002fc70-2da3-417b-8667-fc9717c68616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351c1e42dd0>]}
[0m09:19:20.346766 [info ] [Thread-1 (]: 1 of 1 OK created sql view model zap.gold_apartment_rent_avg_prices ............ [[32mCREATE VIEW[0m in 0.20s]
[0m09:19:20.347809 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:19:20.349643 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:20.350225 [debug] [MainThread]: On master: BEGIN
[0m09:19:20.350681 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:19:20.360050 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:19:20.360715 [debug] [MainThread]: On master: COMMIT
[0m09:19:20.361215 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:20.361645 [debug] [MainThread]: On master: COMMIT
[0m09:19:20.362375 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:19:20.362903 [debug] [MainThread]: On master: Close
[0m09:19:20.363669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:19:20.364197 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent_avg_prices' was properly closed.
[0m09:19:20.364706 [info ] [MainThread]: 
[0m09:19:20.365283 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m09:19:20.366317 [debug] [MainThread]: Command end result
[0m09:19:20.396865 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:19:20.399411 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:19:20.408248 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m09:19:20.408809 [info ] [MainThread]: 
[0m09:19:20.409409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:19:20.409915 [info ] [MainThread]: 
[0m09:19:20.410434 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:19:20.411667 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5344938, "process_in_blocks": "0", "process_kernel_time": 0.18297, "process_mem_max_rss": "113576", "process_out_blocks": "2608", "process_user_time": 2.785551}
[0m09:19:20.412354 [debug] [MainThread]: Command `dbt run` succeeded at 09:19:20.412236 after 1.54 seconds
[0m09:19:20.412869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351c4818f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351c3790eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7351c3b8d750>]}
[0m09:19:20.413418 [debug] [MainThread]: Flushing usage events
[0m09:19:21.774908 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:20:33.055600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a0bb94df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a0ca623b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a0ca62350>]}


============================== 09:20:33.059398 | 464d909e-2544-416b-9c6f-8d4a5f7bda37 ==============================
[0m09:20:33.059398 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:20:33.060171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:20:33.270981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '464d909e-2544-416b-9c6f-8d4a5f7bda37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a0cbbb7f0>]}
[0m09:20:33.346692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '464d909e-2544-416b-9c6f-8d4a5f7bda37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a0b9193f0>]}
[0m09:20:33.347767 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:20:33.482126 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:20:33.633997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:20:33.634820 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_apartment_rent_avg_prices.sql
[0m09:20:33.957229 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m09:20:33.958034 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m09:20:33.958688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '464d909e-2544-416b-9c6f-8d4a5f7bda37', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a0abce770>]}
[0m09:20:33.959830 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_ren_avg_prices
[0m09:20:33.981343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '464d909e-2544-416b-9c6f-8d4a5f7bda37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a09dd3eb0>]}
[0m09:20:34.088295 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:20:34.092276 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:20:34.105280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '464d909e-2544-416b-9c6f-8d4a5f7bda37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a09fe7940>]}
[0m09:20:34.106036 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m09:20:34.106554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '464d909e-2544-416b-9c6f-8d4a5f7bda37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a09fe58d0>]}
[0m09:20:34.108665 [info ] [MainThread]: 
[0m09:20:34.109466 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:20:34.110136 [info ] [MainThread]: 
[0m09:20:34.110922 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:20:34.112544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m09:20:34.158402 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m09:20:34.158998 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m09:20:34.159454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:34.169546 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m09:20:34.171298 [debug] [ThreadPool]: On list_foo: Close
[0m09:20:34.178284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m09:20:34.187254 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:20:34.187840 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m09:20:34.188304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:20:34.197841 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:20:34.198584 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:20:34.199488 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m09:20:34.203831 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m09:20:34.205892 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m09:20:34.206725 [debug] [ThreadPool]: On list_foo_zap: Close
[0m09:20:34.213319 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:34.213918 [debug] [MainThread]: On master: BEGIN
[0m09:20:34.214399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:20:34.223437 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:20:34.224062 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:34.224622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:20:34.229501 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m09:20:34.232063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '464d909e-2544-416b-9c6f-8d4a5f7bda37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a0abcd0c0>]}
[0m09:20:34.232730 [debug] [MainThread]: On master: ROLLBACK
[0m09:20:34.233535 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:34.234063 [debug] [MainThread]: On master: BEGIN
[0m09:20:34.234997 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:20:34.235564 [debug] [MainThread]: On master: COMMIT
[0m09:20:34.236068 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:34.236529 [debug] [MainThread]: On master: COMMIT
[0m09:20:34.237228 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:20:34.237768 [debug] [MainThread]: On master: Close
[0m09:20:34.240911 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:20:34.241799 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent_avg_prices ................. [RUN]
[0m09:20:34.242654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent_avg_prices)
[0m09:20:34.243269 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:20:34.254981 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:20:34.255896 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:20:34.359378 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:20:34.360376 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:20:34.360960 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: BEGIN
[0m09:20:34.361540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:34.370609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:20:34.371304 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:20:34.371870 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */

  create view "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent::numeric), 2) as price_rent_avg,
	ROUND(avg(price_condominium::numeric), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo::numeric),2) as rent_plus_condo_avg,
	ROUND((avg(price_rent::numeric)/avg(floor_size)) , 2) as price_rent_per_m2_avg,
	ROUND((sum(rent_plus_condo)/sum(floor_size)/count(id))::numeric, 2) as rent_plus_condo__per_m2_avg
	ROUND(avg(price_sale), 2) as price_sale_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m09:20:34.372984 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "ROUND"
LINE 20:  ROUND(avg(price_sale), 2) as price_sale_avg
          ^

[0m09:20:34.373608 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: ROLLBACK
[0m09:20:34.374571 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: Close
[0m09:20:34.377103 [debug] [Thread-1 (]: Database Error in model gold_apartment_rent_avg_prices (models/mart/gold_apartment_rent_avg_prices.sql)
  syntax error at or near "ROUND"
  LINE 20:  ROUND(avg(price_sale), 2) as price_sale_avg
            ^
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_rent_avg_prices.sql
[0m09:20:34.379560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464d909e-2544-416b-9c6f-8d4a5f7bda37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a0a434a60>]}
[0m09:20:34.380574 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model zap.gold_apartment_rent_avg_prices ........ [[31mERROR[0m in 0.14s]
[0m09:20:34.381459 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:20:34.382837 [debug] [Thread-7 (]: Marking all children of 'model.zap_imoveis.gold_apartment_rent_avg_prices' to be skipped because of status 'error'.  Reason: Database Error in model gold_apartment_rent_avg_prices (models/mart/gold_apartment_rent_avg_prices.sql)
  syntax error at or near "ROUND"
  LINE 20:  ROUND(avg(price_sale), 2) as price_sale_avg
            ^
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_rent_avg_prices.sql.
[0m09:20:34.385916 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:34.386523 [debug] [MainThread]: On master: BEGIN
[0m09:20:34.387136 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:20:34.396751 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:20:34.397569 [debug] [MainThread]: On master: COMMIT
[0m09:20:34.398187 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:34.398646 [debug] [MainThread]: On master: COMMIT
[0m09:20:34.399352 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:20:34.399849 [debug] [MainThread]: On master: Close
[0m09:20:34.400621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:20:34.401170 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent_avg_prices' was properly closed.
[0m09:20:34.401730 [info ] [MainThread]: 
[0m09:20:34.402343 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m09:20:34.403439 [debug] [MainThread]: Command end result
[0m09:20:34.430966 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:20:34.433476 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:20:34.442837 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m09:20:34.443436 [info ] [MainThread]: 
[0m09:20:34.444051 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:20:34.444719 [info ] [MainThread]: 
[0m09:20:34.445390 [error] [MainThread]:   Database Error in model gold_apartment_rent_avg_prices (models/mart/gold_apartment_rent_avg_prices.sql)
  syntax error at or near "ROUND"
  LINE 20:  ROUND(avg(price_sale), 2) as price_sale_avg
            ^
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_rent_avg_prices.sql
[0m09:20:34.445873 [info ] [MainThread]: 
[0m09:20:34.446410 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:20:34.447582 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4664407, "process_in_blocks": "0", "process_kernel_time": 0.177933, "process_mem_max_rss": "113552", "process_out_blocks": "2592", "process_user_time": 2.747973}
[0m09:20:34.448284 [debug] [MainThread]: Command `dbt run` failed at 09:20:34.448161 after 1.47 seconds
[0m09:20:34.448838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a0bb94df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a0a39b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a09f824a0>]}
[0m09:20:34.449598 [debug] [MainThread]: Flushing usage events
[0m09:20:35.810337 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:20:50.547814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7432a48ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74338c2380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74338c2320>]}


============================== 09:20:50.551091 | b6f4bda1-1b0d-4d59-88ce-f41de58df1ef ==============================
[0m09:20:50.551091 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:20:50.551978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:20:50.773638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6f4bda1-1b0d-4d59-88ce-f41de58df1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74319ba3b0>]}
[0m09:20:50.850979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6f4bda1-1b0d-4d59-88ce-f41de58df1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74327c8850>]}
[0m09:20:50.852067 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:20:50.988175 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:20:51.141096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:20:51.141921 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_apartment_rent_avg_prices.sql
[0m09:20:51.479050 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m09:20:51.479848 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m09:20:51.480637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b6f4bda1-1b0d-4d59-88ce-f41de58df1ef', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7432208d60>]}
[0m09:20:51.481920 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_ren_avg_prices
[0m09:20:51.512747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6f4bda1-1b0d-4d59-88ce-f41de58df1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7430bc4130>]}
[0m09:20:51.633899 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:20:51.637885 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:20:51.651190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6f4bda1-1b0d-4d59-88ce-f41de58df1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7430c39990>]}
[0m09:20:51.651942 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m09:20:51.652523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6f4bda1-1b0d-4d59-88ce-f41de58df1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7430c395d0>]}
[0m09:20:51.654592 [info ] [MainThread]: 
[0m09:20:51.655204 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:20:51.655803 [info ] [MainThread]: 
[0m09:20:51.656598 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:20:51.658161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m09:20:51.703114 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m09:20:51.703717 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m09:20:51.704222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:51.714663 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m09:20:51.716703 [debug] [ThreadPool]: On list_foo: Close
[0m09:20:51.724194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m09:20:51.733037 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:20:51.733628 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m09:20:51.734073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:20:51.742677 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m09:20:51.743475 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:20:51.743937 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m09:20:51.747650 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m09:20:51.749611 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m09:20:51.750387 [debug] [ThreadPool]: On list_foo_zap: Close
[0m09:20:51.758179 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:51.758767 [debug] [MainThread]: On master: BEGIN
[0m09:20:51.759216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:20:51.768198 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:20:51.768790 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:51.769394 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:20:51.774130 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m09:20:51.776694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6f4bda1-1b0d-4d59-88ce-f41de58df1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74319bb400>]}
[0m09:20:51.777359 [debug] [MainThread]: On master: ROLLBACK
[0m09:20:51.778175 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:51.778682 [debug] [MainThread]: On master: BEGIN
[0m09:20:51.779571 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:20:51.780104 [debug] [MainThread]: On master: COMMIT
[0m09:20:51.780574 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:51.781040 [debug] [MainThread]: On master: COMMIT
[0m09:20:51.781799 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:20:51.782355 [debug] [MainThread]: On master: Close
[0m09:20:51.785318 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:20:51.786250 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent_avg_prices ................. [RUN]
[0m09:20:51.787116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent_avg_prices)
[0m09:20:51.787727 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:20:51.798637 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:20:51.799597 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:20:51.901769 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:20:51.902784 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:20:51.903365 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: BEGIN
[0m09:20:51.903891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:51.913525 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m09:20:51.914212 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:20:51.915408 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */

  create view "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent::numeric), 2) as price_rent_avg,
	ROUND(avg(price_condominium::numeric), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo::numeric),2) as rent_plus_condo_avg,
	ROUND((avg(price_rent::numeric)/avg(floor_size)) , 2) as price_rent_per_m2_avg,
	ROUND((sum(rent_plus_condo)/sum(floor_size)/count(id))::numeric, 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m09:20:51.918994 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:20:51.928765 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:20:51.929455 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
alter table "foo"."zap"."gold_apartment_rent_avg_prices" rename to "gold_apartment_rent_avg_prices__dbt_backup"
[0m09:20:51.930818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:20:51.935128 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:20:51.935747 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
alter table "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp" rename to "gold_apartment_rent_avg_prices"
[0m09:20:51.937254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:20:51.959644 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: COMMIT
[0m09:20:51.960353 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:20:51.960911 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: COMMIT
[0m09:20:51.963505 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:20:51.972141 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_rent_avg_prices__dbt_backup"
[0m09:20:51.978230 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:20:51.978897 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_rent_avg_prices__dbt_backup" cascade
[0m09:20:51.982663 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:20:51.987216 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: Close
[0m09:20:51.989877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f4bda1-1b0d-4d59-88ce-f41de58df1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b743004add0>]}
[0m09:20:51.990931 [info ] [Thread-1 (]: 1 of 1 OK created sql view model zap.gold_apartment_rent_avg_prices ............ [[32mCREATE VIEW[0m in 0.20s]
[0m09:20:51.991870 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:20:51.993839 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:51.994427 [debug] [MainThread]: On master: BEGIN
[0m09:20:51.994877 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:20:52.005379 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:20:52.006355 [debug] [MainThread]: On master: COMMIT
[0m09:20:52.007130 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:52.007830 [debug] [MainThread]: On master: COMMIT
[0m09:20:52.008745 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:20:52.009325 [debug] [MainThread]: On master: Close
[0m09:20:52.010079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:20:52.010589 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent_avg_prices' was properly closed.
[0m09:20:52.011130 [info ] [MainThread]: 
[0m09:20:52.011734 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m09:20:52.012775 [debug] [MainThread]: Command end result
[0m09:20:52.043657 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:20:52.046288 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:20:52.055282 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m09:20:52.055862 [info ] [MainThread]: 
[0m09:20:52.056535 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:20:52.057102 [info ] [MainThread]: 
[0m09:20:52.057658 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:20:52.058885 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5838025, "process_in_blocks": "0", "process_kernel_time": 0.205764, "process_mem_max_rss": "113836", "process_out_blocks": "2592", "process_user_time": 2.96761}
[0m09:20:52.059564 [debug] [MainThread]: Command `dbt run` succeeded at 09:20:52.059451 after 1.58 seconds
[0m09:20:52.060099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7432a48ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b743225f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74319ba3b0>]}
[0m09:20:52.060633 [debug] [MainThread]: Flushing usage events
[0m09:20:53.320142 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:23:33.878536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de38818f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de396ba3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de396ba380>]}


============================== 09:23:33.881793 | 2b80c8d7-f73e-4bdc-9a1e-d3d0d30a939d ==============================
[0m09:23:33.881793 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:23:33.882576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:23:34.095309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b80c8d7-f73e-4bdc-9a1e-d3d0d30a939d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de39833910>]}
[0m09:23:34.170730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b80c8d7-f73e-4bdc-9a1e-d3d0d30a939d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de37fde800>]}
[0m09:23:34.171779 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:23:34.302714 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:23:34.453757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:23:34.454590 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_apartment_rent_avg_prices.sql
[0m09:23:34.777708 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m09:23:34.778494 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m09:23:34.779155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2b80c8d7-f73e-4bdc-9a1e-d3d0d30a939d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de386d1c00>]}
[0m09:23:34.780390 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_ren_avg_prices
[0m09:23:34.801260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b80c8d7-f73e-4bdc-9a1e-d3d0d30a939d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de369bc130>]}
[0m09:23:34.908497 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:23:34.912441 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:23:34.925370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b80c8d7-f73e-4bdc-9a1e-d3d0d30a939d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de36a330d0>]}
[0m09:23:34.926167 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m09:23:34.926689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b80c8d7-f73e-4bdc-9a1e-d3d0d30a939d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de36a32f20>]}
[0m09:23:34.928878 [info ] [MainThread]: 
[0m09:23:34.929655 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:23:34.930185 [info ] [MainThread]: 
[0m09:23:34.930906 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:23:34.932643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m09:23:34.978391 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m09:23:34.979036 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m09:23:34.979518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:34.989324 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m09:23:34.991057 [debug] [ThreadPool]: On list_foo: Close
[0m09:23:34.998786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m09:23:35.008456 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:23:35.009065 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m09:23:35.009527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:23:35.018886 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:23:35.019499 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:23:35.019964 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m09:23:35.023381 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m09:23:35.025118 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m09:23:35.025946 [debug] [ThreadPool]: On list_foo_zap: Close
[0m09:23:35.034366 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:35.034955 [debug] [MainThread]: On master: BEGIN
[0m09:23:35.035442 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:23:35.044763 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:23:35.045364 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:35.045885 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:23:35.050317 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m09:23:35.052475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b80c8d7-f73e-4bdc-9a1e-d3d0d30a939d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de396696c0>]}
[0m09:23:35.053165 [debug] [MainThread]: On master: ROLLBACK
[0m09:23:35.053970 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:35.054524 [debug] [MainThread]: On master: BEGIN
[0m09:23:35.055371 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:23:35.055883 [debug] [MainThread]: On master: COMMIT
[0m09:23:35.056374 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:35.056811 [debug] [MainThread]: On master: COMMIT
[0m09:23:35.057574 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:23:35.058105 [debug] [MainThread]: On master: Close
[0m09:23:35.060780 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:23:35.061673 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent_avg_prices ................. [RUN]
[0m09:23:35.062529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent_avg_prices)
[0m09:23:35.063118 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:23:35.074247 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:23:35.075160 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:23:35.177748 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:23:35.178748 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:23:35.179330 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: BEGIN
[0m09:23:35.179960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:23:35.189322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:23:35.189977 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:23:35.190897 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */

  create view "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(sum(rent_plus_condo) / sum(floor_size) / count(id), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m09:23:35.192975 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 16:  ROUND(avg(price_condominium), 2) as price_condominium_avg,
          ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m09:23:35.193668 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: ROLLBACK
[0m09:23:35.194616 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: Close
[0m09:23:35.197098 [debug] [Thread-1 (]: Database Error in model gold_apartment_rent_avg_prices (models/mart/gold_apartment_rent_avg_prices.sql)
  function round(double precision, integer) does not exist
  LINE 16:  ROUND(avg(price_condominium), 2) as price_condominium_avg,
            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_rent_avg_prices.sql
[0m09:23:35.199576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b80c8d7-f73e-4bdc-9a1e-d3d0d30a939d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de37018e50>]}
[0m09:23:35.200585 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model zap.gold_apartment_rent_avg_prices ........ [[31mERROR[0m in 0.14s]
[0m09:23:35.201553 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:23:35.203073 [debug] [Thread-7 (]: Marking all children of 'model.zap_imoveis.gold_apartment_rent_avg_prices' to be skipped because of status 'error'.  Reason: Database Error in model gold_apartment_rent_avg_prices (models/mart/gold_apartment_rent_avg_prices.sql)
  function round(double precision, integer) does not exist
  LINE 16:  ROUND(avg(price_condominium), 2) as price_condominium_avg,
            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_rent_avg_prices.sql.
[0m09:23:35.206243 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:35.206952 [debug] [MainThread]: On master: BEGIN
[0m09:23:35.207641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:23:35.217564 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:23:35.218190 [debug] [MainThread]: On master: COMMIT
[0m09:23:35.218682 [debug] [MainThread]: Using postgres connection "master"
[0m09:23:35.219152 [debug] [MainThread]: On master: COMMIT
[0m09:23:35.219816 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:23:35.220346 [debug] [MainThread]: On master: Close
[0m09:23:35.221126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:35.221656 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent_avg_prices' was properly closed.
[0m09:23:35.222205 [info ] [MainThread]: 
[0m09:23:35.222816 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m09:23:35.223913 [debug] [MainThread]: Command end result
[0m09:23:35.252524 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:23:35.254896 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:23:35.264184 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m09:23:35.264811 [info ] [MainThread]: 
[0m09:23:35.265417 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:23:35.265952 [info ] [MainThread]: 
[0m09:23:35.266582 [error] [MainThread]:   Database Error in model gold_apartment_rent_avg_prices (models/mart/gold_apartment_rent_avg_prices.sql)
  function round(double precision, integer) does not exist
  LINE 16:  ROUND(avg(price_condominium), 2) as price_condominium_avg,
            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_rent_avg_prices.sql
[0m09:23:35.267103 [info ] [MainThread]: 
[0m09:23:35.267661 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:23:35.268964 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4628298, "process_in_blocks": "0", "process_kernel_time": 0.175254, "process_mem_max_rss": "113720", "process_out_blocks": "2600", "process_user_time": 2.753996}
[0m09:23:35.269648 [debug] [MainThread]: Command `dbt run` failed at 09:23:35.269530 after 1.46 seconds
[0m09:23:35.270206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de38818f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de36b716c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de36a159f0>]}
[0m09:23:35.270765 [debug] [MainThread]: Flushing usage events
[0m09:23:36.447873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:24:55.058420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dca311ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dca3fba380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dca3fba320>]}


============================== 09:24:55.063266 | 07c21b8e-60f7-4d2d-8cb0-593f22a751ee ==============================
[0m09:24:55.063266 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:24:55.064128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:24:55.299727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07c21b8e-60f7-4d2d-8cb0-593f22a751ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dca24063b0>]}
[0m09:24:55.375243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07c21b8e-60f7-4d2d-8cb0-593f22a751ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dca2e987f0>]}
[0m09:24:55.376297 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:24:55.516438 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:24:55.683562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:24:55.684468 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:24:55.685581 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m09:24:55.686492 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m09:24:55.687084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '07c21b8e-60f7-4d2d-8cb0-593f22a751ee', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dca15236d0>]}
[0m09:24:55.697690 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_ren_avg_prices
[0m09:24:55.750691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07c21b8e-60f7-4d2d-8cb0-593f22a751ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dca156ef80>]}
[0m09:24:55.885142 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:24:55.889621 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:24:55.908202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07c21b8e-60f7-4d2d-8cb0-593f22a751ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dca15cca90>]}
[0m09:24:55.909265 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m09:24:55.910305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07c21b8e-60f7-4d2d-8cb0-593f22a751ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dca15cfa90>]}
[0m09:24:55.912842 [info ] [MainThread]: 
[0m09:24:55.913523 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:24:55.914031 [info ] [MainThread]: 
[0m09:24:55.914911 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:24:55.916422 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m09:24:55.967182 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m09:24:55.967845 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m09:24:55.968413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:24:55.979177 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m09:24:55.981254 [debug] [ThreadPool]: On list_foo: Close
[0m09:24:55.988504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m09:24:55.997968 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:24:55.998672 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m09:24:55.999255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:24:56.009197 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m09:24:56.009850 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:24:56.010409 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m09:24:56.013765 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m09:24:56.016182 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m09:24:56.017066 [debug] [ThreadPool]: On list_foo_zap: Close
[0m09:24:56.024161 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:56.024986 [debug] [MainThread]: On master: BEGIN
[0m09:24:56.025716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:24:56.035648 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:24:56.036337 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:56.036925 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:24:56.041755 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m09:24:56.044408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07c21b8e-60f7-4d2d-8cb0-593f22a751ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dca2407400>]}
[0m09:24:56.045367 [debug] [MainThread]: On master: ROLLBACK
[0m09:24:56.046356 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:56.046982 [debug] [MainThread]: On master: BEGIN
[0m09:24:56.047766 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:24:56.048292 [debug] [MainThread]: On master: COMMIT
[0m09:24:56.048767 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:56.049279 [debug] [MainThread]: On master: COMMIT
[0m09:24:56.050163 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:24:56.050941 [debug] [MainThread]: On master: Close
[0m09:24:56.054473 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:24:56.055585 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent_avg_prices ................. [RUN]
[0m09:24:56.056532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent_avg_prices)
[0m09:24:56.057132 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:24:56.068947 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:24:56.070033 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:24:56.121396 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:24:56.122552 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:24:56.123357 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: BEGIN
[0m09:24:56.123881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:56.132746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:24:56.133432 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:24:56.133983 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */

  create view "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(sum(rent_plus_condo) / sum(floor_size) / count(id), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m09:24:56.137505 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:24:56.147472 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:24:56.148150 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
alter table "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp" rename to "gold_apartment_rent_avg_prices"
[0m09:24:56.149702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:24:56.171124 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: COMMIT
[0m09:24:56.171892 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:24:56.172435 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: COMMIT
[0m09:24:56.174099 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:24:56.183582 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_rent_avg_prices__dbt_backup"
[0m09:24:56.190266 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:24:56.190919 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_rent_avg_prices__dbt_backup" cascade
[0m09:24:56.192074 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:24:56.196412 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: Close
[0m09:24:56.199532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07c21b8e-60f7-4d2d-8cb0-593f22a751ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dca0db77f0>]}
[0m09:24:56.200605 [info ] [Thread-1 (]: 1 of 1 OK created sql view model zap.gold_apartment_rent_avg_prices ............ [[32mCREATE VIEW[0m in 0.14s]
[0m09:24:56.201568 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:24:56.203498 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:56.204090 [debug] [MainThread]: On master: BEGIN
[0m09:24:56.204538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:24:56.213776 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:24:56.214409 [debug] [MainThread]: On master: COMMIT
[0m09:24:56.214883 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:56.215438 [debug] [MainThread]: On master: COMMIT
[0m09:24:56.216447 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:24:56.216986 [debug] [MainThread]: On master: Close
[0m09:24:56.217736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:56.218262 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent_avg_prices' was properly closed.
[0m09:24:56.218777 [info ] [MainThread]: 
[0m09:24:56.219404 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m09:24:56.220553 [debug] [MainThread]: Command end result
[0m09:24:56.250446 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:24:56.252883 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:24:56.262180 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m09:24:56.262786 [info ] [MainThread]: 
[0m09:24:56.263390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:24:56.263850 [info ] [MainThread]: 
[0m09:24:56.264348 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:24:56.265500 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2976687, "process_in_blocks": "0", "process_kernel_time": 0.188966, "process_mem_max_rss": "110272", "process_out_blocks": "1752", "process_user_time": 2.623529}
[0m09:24:56.266179 [debug] [MainThread]: Command `dbt run` succeeded at 09:24:56.266059 after 1.30 seconds
[0m09:24:56.266696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dca311ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dca2e987f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dca2fd6bc0>]}
[0m09:24:56.267240 [debug] [MainThread]: Flushing usage events
[0m09:24:57.546193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:26:21.307278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726046f5ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726047e2a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726047e2a2c0>]}


============================== 09:26:21.310535 | d8b2dd9e-4b24-43bb-9057-c9938ddc86cd ==============================
[0m09:26:21.310535 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:26:21.311395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:26:21.519033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8b2dd9e-4b24-43bb-9057-c9938ddc86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726047f83880>]}
[0m09:26:21.594111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8b2dd9e-4b24-43bb-9057-c9938ddc86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726047e1e1a0>]}
[0m09:26:21.595174 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:26:21.727205 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:26:21.880325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:26:21.881151 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_apartment_rent_avg_prices.sql
[0m09:26:22.207481 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m09:26:22.208322 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m09:26:22.209037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd8b2dd9e-4b24-43bb-9057-c9938ddc86cd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726045280fa0>]}
[0m09:26:22.210321 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mart.gold_apartments_ren_avg_prices
[0m09:26:22.235632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8b2dd9e-4b24-43bb-9057-c9938ddc86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7260451dbfd0>]}
[0m09:26:22.346834 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:26:22.351254 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:26:22.365496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8b2dd9e-4b24-43bb-9057-c9938ddc86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7260451b6a70>]}
[0m09:26:22.366259 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m09:26:22.366785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8b2dd9e-4b24-43bb-9057-c9938ddc86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72604524d360>]}
[0m09:26:22.368857 [info ] [MainThread]: 
[0m09:26:22.369512 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:26:22.369994 [info ] [MainThread]: 
[0m09:26:22.370750 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:26:22.372144 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m09:26:22.417710 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m09:26:22.418341 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m09:26:22.418813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:26:22.432221 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m09:26:22.433945 [debug] [ThreadPool]: On list_foo: Close
[0m09:26:22.441611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m09:26:22.450045 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:26:22.450631 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m09:26:22.451075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:26:22.459807 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m09:26:22.460433 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:26:22.460905 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m09:26:22.464111 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m09:26:22.466255 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m09:26:22.467098 [debug] [ThreadPool]: On list_foo_zap: Close
[0m09:26:22.473730 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:22.474344 [debug] [MainThread]: On master: BEGIN
[0m09:26:22.474803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:26:22.483529 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:26:22.484168 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:22.484717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:26:22.489404 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m09:26:22.491600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8b2dd9e-4b24-43bb-9057-c9938ddc86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726045fce8f0>]}
[0m09:26:22.492324 [debug] [MainThread]: On master: ROLLBACK
[0m09:26:22.493319 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:22.493964 [debug] [MainThread]: On master: BEGIN
[0m09:26:22.495060 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:26:22.495749 [debug] [MainThread]: On master: COMMIT
[0m09:26:22.496431 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:22.497027 [debug] [MainThread]: On master: COMMIT
[0m09:26:22.497989 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:26:22.498655 [debug] [MainThread]: On master: Close
[0m09:26:22.502032 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:26:22.502944 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_apartment_rent_avg_prices ................. [RUN]
[0m09:26:22.503746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_rent_avg_prices)
[0m09:26:22.504479 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:26:22.516066 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:26:22.517033 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:26:22.623420 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:26:22.624445 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:26:22.625028 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: BEGIN
[0m09:26:22.625578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:26:22.634265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:26:22.634921 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:26:22.635506 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */

  create view "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m09:26:22.638642 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m09:26:22.647945 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:26:22.648632 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
alter table "foo"."zap"."gold_apartment_rent_avg_prices" rename to "gold_apartment_rent_avg_prices__dbt_backup"
[0m09:26:22.649773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:26:22.654087 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:26:22.654698 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
alter table "foo"."zap"."gold_apartment_rent_avg_prices__dbt_tmp" rename to "gold_apartment_rent_avg_prices"
[0m09:26:22.655802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:26:22.678193 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: COMMIT
[0m09:26:22.678870 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:26:22.679410 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: COMMIT
[0m09:26:22.682253 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:26:22.690761 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_rent_avg_prices__dbt_backup"
[0m09:26:22.696939 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_rent_avg_prices"
[0m09:26:22.697597 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_rent_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_rent_avg_prices__dbt_backup" cascade
[0m09:26:22.701121 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:26:22.704816 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_rent_avg_prices: Close
[0m09:26:22.708047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8b2dd9e-4b24-43bb-9057-c9938ddc86cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726044652dd0>]}
[0m09:26:22.709295 [info ] [Thread-1 (]: 1 of 1 OK created sql view model zap.gold_apartment_rent_avg_prices ............ [[32mCREATE VIEW[0m in 0.20s]
[0m09:26:22.710217 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_rent_avg_prices
[0m09:26:22.712079 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:22.712657 [debug] [MainThread]: On master: BEGIN
[0m09:26:22.713111 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:26:22.722197 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:26:22.722802 [debug] [MainThread]: On master: COMMIT
[0m09:26:22.723287 [debug] [MainThread]: Using postgres connection "master"
[0m09:26:22.723724 [debug] [MainThread]: On master: COMMIT
[0m09:26:22.724494 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:26:22.725060 [debug] [MainThread]: On master: Close
[0m09:26:22.725935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:26:22.726732 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_rent_avg_prices' was properly closed.
[0m09:26:22.727551 [info ] [MainThread]: 
[0m09:26:22.728406 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m09:26:22.729510 [debug] [MainThread]: Command end result
[0m09:26:22.758254 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:26:22.760893 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:26:22.770345 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m09:26:22.770948 [info ] [MainThread]: 
[0m09:26:22.771778 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:26:22.772359 [info ] [MainThread]: 
[0m09:26:22.772850 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:26:22.774022 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5390984, "process_in_blocks": "0", "process_kernel_time": 0.198686, "process_mem_max_rss": "113576", "process_out_blocks": "2600", "process_user_time": 2.782609}
[0m09:26:22.774751 [debug] [MainThread]: Command `dbt run` succeeded at 09:26:22.774589 after 1.54 seconds
[0m09:26:22.775307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726046f5ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726047f83880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726046e26980>]}
[0m09:26:22.775876 [debug] [MainThread]: Flushing usage events
[0m09:26:24.381525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:41:49.526952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0b32dd4df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0b33c623b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0b33c62350>]}


============================== 01:41:49.533224 | 4acdba8f-ae64-43bc-acf3-d492866618ac ==============================
[0m01:41:49.533224 [info ] [MainThread]: Running with dbt=1.9.2
[0m01:41:49.534779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:41:49.862859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4acdba8f-ae64-43bc-acf3-d492866618ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0b33dbb7f0>]}
[0m01:41:49.994917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4acdba8f-ae64-43bc-acf3-d492866618ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0b32b5d3f0>]}
[0m01:41:49.998357 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:41:50.203435 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m01:41:50.404148 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:41:50.405120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4acdba8f-ae64-43bc-acf3-d492866618ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0b325c70d0>]}
[0m01:41:52.386574 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'gold_apartment_rent' in the 'models' section of file 'models/mart/schema.yml'
[0m01:41:52.734278 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m01:41:52.735516 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m01:41:52.736444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4acdba8f-ae64-43bc-acf3-d492866618ac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0b311a5db0>]}
[0m01:41:52.738097 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m01:41:52.764447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4acdba8f-ae64-43bc-acf3-d492866618ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0b30b810c0>]}
[0m01:41:52.927914 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m01:41:52.933496 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m01:41:52.963830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4acdba8f-ae64-43bc-acf3-d492866618ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0b30b58fd0>]}
[0m01:41:52.964839 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m01:41:52.965749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4acdba8f-ae64-43bc-acf3-d492866618ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0b3256fc10>]}
[0m01:41:52.968970 [info ] [MainThread]: 
[0m01:41:52.969847 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:41:52.970720 [info ] [MainThread]: 
[0m01:41:52.972489 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:41:52.986058 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m01:41:53.061018 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m01:41:53.061841 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m01:41:53.062473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:53.077470 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m01:41:53.080274 [debug] [ThreadPool]: On list_foo: Close
[0m01:41:53.084192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m01:41:53.096418 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m01:41:53.097237 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m01:41:53.097909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:53.110844 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m01:41:53.111963 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m01:41:53.112645 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m01:41:53.120334 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m01:41:53.123237 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m01:41:53.124384 [debug] [ThreadPool]: On list_foo_zap: Close
[0m01:41:53.134470 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:53.135317 [debug] [MainThread]: On master: BEGIN
[0m01:41:53.136000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:41:53.148102 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m01:41:53.149446 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:53.150377 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:41:53.156188 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m01:41:53.159200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4acdba8f-ae64-43bc-acf3-d492866618ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0b315b2f80>]}
[0m01:41:53.160245 [debug] [MainThread]: On master: ROLLBACK
[0m01:41:53.161347 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:53.162075 [debug] [MainThread]: On master: BEGIN
[0m01:41:53.163326 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:41:53.164066 [debug] [MainThread]: On master: COMMIT
[0m01:41:53.164773 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:53.165502 [debug] [MainThread]: On master: COMMIT
[0m01:41:53.166820 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:41:53.167790 [debug] [MainThread]: On master: Close
[0m01:41:53.171797 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m01:41:53.172766 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m01:41:53.173876 [info ] [Thread-1 (]: 1 of 2 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m01:41:53.175311 [info ] [Thread-2 (]: 2 of 2 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m01:41:53.176617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m01:41:53.177753 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m01:41:53.178632 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m01:41:53.179493 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m01:41:53.204077 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:41:53.207797 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m01:41:53.209422 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m01:41:53.210898 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m01:41:53.366329 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:41:53.367846 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m01:41:53.369934 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:41:53.370922 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m01:41:53.371795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:53.373307 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:41:53.374435 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m01:41:53.375314 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:41:53.384604 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:41:53.385602 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:41:53.386678 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m01:41:53.389032 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m01:41:53.390204 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:41:53.391163 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m01:41:53.402805 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m01:41:53.403972 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m01:41:53.422522 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:41:53.424812 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:41:53.425911 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m01:41:53.427020 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m01:41:53.428771 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:41:53.429670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:41:53.484618 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m01:41:53.486211 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m01:41:53.487096 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:41:53.487955 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:41:53.488880 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m01:41:53.489878 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m01:41:53.494032 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m01:41:53.495110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m01:41:53.514084 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m01:41:53.517796 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m01:41:53.526976 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:41:53.529692 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:41:53.530976 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m01:41:53.532162 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m01:41:53.533896 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:41:53.534958 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:41:53.539811 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m01:41:53.542401 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m01:41:53.547926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4acdba8f-ae64-43bc-acf3-d492866618ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0b3033a4a0>]}
[0m01:41:53.549048 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4acdba8f-ae64-43bc-acf3-d492866618ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0b30f1f700>]}
[0m01:41:53.550435 [info ] [Thread-1 (]: 1 of 2 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.37s]
[0m01:41:53.551928 [info ] [Thread-2 (]: 2 of 2 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.37s]
[0m01:41:53.553269 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m01:41:53.554458 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m01:41:53.557218 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:53.558143 [debug] [MainThread]: On master: BEGIN
[0m01:41:53.558980 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:41:53.571949 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m01:41:53.573009 [debug] [MainThread]: On master: COMMIT
[0m01:41:53.573729 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:53.574364 [debug] [MainThread]: On master: COMMIT
[0m01:41:53.575298 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:41:53.576052 [debug] [MainThread]: On master: Close
[0m01:41:53.577249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:41:53.578238 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m01:41:53.579148 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m01:41:53.580192 [info ] [MainThread]: 
[0m01:41:53.581297 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m01:41:53.583882 [debug] [MainThread]: Command end result
[0m01:41:53.627687 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m01:41:53.630369 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m01:41:53.643671 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m01:41:53.644447 [info ] [MainThread]: 
[0m01:41:53.645270 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:41:53.646018 [info ] [MainThread]: 
[0m01:41:53.646756 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:41:53.648766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.236804, "process_in_blocks": "37256", "process_kernel_time": 0.317421, "process_mem_max_rss": "116764", "process_out_blocks": "2632", "process_user_time": 6.16718}
[0m01:41:53.649792 [debug] [MainThread]: Command `dbt run` succeeded at 01:41:53.649581 after 4.24 seconds
[0m01:41:53.650538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0b32dd4df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0b3256fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0b32b5d3f0>]}
[0m01:41:53.651499 [debug] [MainThread]: Flushing usage events
[0m01:41:54.896695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:57:00.789566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768ce82d4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768ce9162320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768ce91622c0>]}


============================== 01:57:00.794077 | 7e7365db-ad74-4df4-a65a-cdecfb1db09d ==============================
[0m01:57:00.794077 [info ] [MainThread]: Running with dbt=1.9.2
[0m01:57:00.795200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:57:01.108233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e7365db-ad74-4df4-a65a-cdecfb1db09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768ce9113970>]}
[0m01:57:01.224563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e7365db-ad74-4df4-a65a-cdecfb1db09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768ce75e8e20>]}
[0m01:57:01.226019 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:57:01.428466 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m01:57:01.624587 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:57:01.625532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e7365db-ad74-4df4-a65a-cdecfb1db09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768ce7ab5270>]}
[0m01:57:03.553144 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'gold_apartment_rent' in the 'models' section of file 'models/mart/schema.yml'
[0m01:57:03.890509 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m01:57:03.891509 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m01:57:03.892439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7e7365db-ad74-4df4-a65a-cdecfb1db09d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768ce678f8e0>]}
[0m01:57:03.894110 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m01:57:03.919072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e7365db-ad74-4df4-a65a-cdecfb1db09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768ce6185120>]}
[0m01:57:04.083409 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m01:57:04.088985 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m01:57:04.107501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e7365db-ad74-4df4-a65a-cdecfb1db09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768ce6163310>]}
[0m01:57:04.108501 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m01:57:04.109234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e7365db-ad74-4df4-a65a-cdecfb1db09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768ce7a6b970>]}
[0m01:57:04.112376 [info ] [MainThread]: 
[0m01:57:04.113236 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:57:04.113928 [info ] [MainThread]: 
[0m01:57:04.115075 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:57:04.125381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m01:57:04.191053 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m01:57:04.191977 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m01:57:04.192803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:57:04.207926 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m01:57:04.210692 [debug] [ThreadPool]: On list_foo: Close
[0m01:57:04.214648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m01:57:04.226950 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m01:57:04.227798 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m01:57:04.228458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:57:04.242045 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m01:57:04.242923 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m01:57:04.243670 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m01:57:04.249044 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m01:57:04.252242 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m01:57:04.253452 [debug] [ThreadPool]: On list_foo_zap: Close
[0m01:57:04.262920 [debug] [MainThread]: Using postgres connection "master"
[0m01:57:04.263736 [debug] [MainThread]: On master: BEGIN
[0m01:57:04.264409 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:57:04.277263 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m01:57:04.278077 [debug] [MainThread]: Using postgres connection "master"
[0m01:57:04.278886 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:57:04.285622 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m01:57:04.289508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e7365db-ad74-4df4-a65a-cdecfb1db09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768ce876c1c0>]}
[0m01:57:04.290491 [debug] [MainThread]: On master: ROLLBACK
[0m01:57:04.291605 [debug] [MainThread]: Using postgres connection "master"
[0m01:57:04.292330 [debug] [MainThread]: On master: BEGIN
[0m01:57:04.293603 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:57:04.294369 [debug] [MainThread]: On master: COMMIT
[0m01:57:04.295044 [debug] [MainThread]: Using postgres connection "master"
[0m01:57:04.295688 [debug] [MainThread]: On master: COMMIT
[0m01:57:04.296742 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:57:04.297479 [debug] [MainThread]: On master: Close
[0m01:57:04.301099 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m01:57:04.302220 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m01:57:04.303830 [info ] [Thread-1 (]: 1 of 2 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m01:57:04.305312 [info ] [Thread-2 (]: 2 of 2 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m01:57:04.306733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m01:57:04.307840 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m01:57:04.308752 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m01:57:04.309587 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m01:57:04.334252 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:57:04.336320 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m01:57:04.337621 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m01:57:04.338582 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m01:57:04.480443 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m01:57:04.483772 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:57:04.485376 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:57:04.486377 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:57:04.487224 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m01:57:04.488077 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m01:57:04.488940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:57:04.489780 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:57:04.502230 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m01:57:04.503231 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:57:04.504087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m01:57:04.504961 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m01:57:04.505896 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:57:04.506923 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m01:57:04.511166 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:57:04.512378 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:57:04.530764 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:57:04.534024 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:57:04.535174 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m01:57:04.536162 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m01:57:04.538120 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:57:04.539103 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:57:04.595450 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m01:57:04.601675 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:57:04.602470 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m01:57:04.603328 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m01:57:04.604220 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:57:04.605182 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m01:57:04.606505 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m01:57:04.607940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:57:04.632296 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m01:57:04.640838 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m01:57:04.646087 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:57:04.647046 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m01:57:04.649722 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:57:04.650643 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m01:57:04.652084 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m01:57:04.656832 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m01:57:04.660812 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m01:57:04.663654 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m01:57:04.664600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e7365db-ad74-4df4-a65a-cdecfb1db09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768ce85913c0>]}
[0m01:57:04.666577 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e7365db-ad74-4df4-a65a-cdecfb1db09d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768ce5554ca0>]}
[0m01:57:04.668077 [info ] [Thread-1 (]: 1 of 2 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.35s]
[0m01:57:04.669770 [info ] [Thread-2 (]: 2 of 2 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.36s]
[0m01:57:04.671472 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m01:57:04.672917 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m01:57:04.675678 [debug] [MainThread]: Using postgres connection "master"
[0m01:57:04.676548 [debug] [MainThread]: On master: BEGIN
[0m01:57:04.677309 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:57:04.690202 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m01:57:04.691304 [debug] [MainThread]: On master: COMMIT
[0m01:57:04.692254 [debug] [MainThread]: Using postgres connection "master"
[0m01:57:04.692968 [debug] [MainThread]: On master: COMMIT
[0m01:57:04.694191 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:57:04.695020 [debug] [MainThread]: On master: Close
[0m01:57:04.696079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:57:04.696818 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m01:57:04.697419 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m01:57:04.698255 [info ] [MainThread]: 
[0m01:57:04.699034 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m01:57:04.700727 [debug] [MainThread]: Command end result
[0m01:57:04.742536 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m01:57:04.745299 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m01:57:04.758584 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m01:57:04.759376 [info ] [MainThread]: 
[0m01:57:04.760270 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:57:04.761159 [info ] [MainThread]: 
[0m01:57:04.761940 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:57:04.763534 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.079942, "process_in_blocks": "0", "process_kernel_time": 0.243115, "process_mem_max_rss": "117280", "process_out_blocks": "2632", "process_user_time": 6.020868}
[0m01:57:04.764480 [debug] [MainThread]: Command `dbt run` succeeded at 01:57:04.764309 after 4.08 seconds
[0m01:57:04.765303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768ce82d4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768ce85913c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768ce819e9e0>]}
[0m01:57:04.766121 [debug] [MainThread]: Flushing usage events
[0m01:57:08.152832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:14.493443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6add90e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6aec3e320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6aec3e2c0>]}


============================== 13:59:14.497468 | cf7f871e-8b3b-4cc9-a5c6-5ec894947e79 ==============================
[0m13:59:14.497468 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:59:14.498535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:59:14.755413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf7f871e-8b3b-4cc9-a5c6-5ec894947e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6aedbb880>]}
[0m13:59:14.839868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf7f871e-8b3b-4cc9-a5c6-5ec894947e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6aec5a1a0>]}
[0m13:59:14.842096 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:59:14.987717 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:59:15.169317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:15.169989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:15.170616 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m13:59:15.171264 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m13:59:15.171854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cf7f871e-8b3b-4cc9-a5c6-5ec894947e79', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6ac1336a0>]}
[0m13:59:15.181050 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m13:59:15.238185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf7f871e-8b3b-4cc9-a5c6-5ec894947e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6ac1a27a0>]}
[0m13:59:15.356389 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m13:59:15.360342 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m13:59:15.384686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf7f871e-8b3b-4cc9-a5c6-5ec894947e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6ac02df30>]}
[0m13:59:15.385537 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m13:59:15.386115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf7f871e-8b3b-4cc9-a5c6-5ec894947e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6ac07f0d0>]}
[0m13:59:15.388268 [info ] [MainThread]: 
[0m13:59:15.388883 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:59:15.389359 [info ] [MainThread]: 
[0m13:59:15.390115 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:59:15.396395 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m13:59:15.452763 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m13:59:15.453389 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m13:59:15.453872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:15.473895 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m13:59:15.475606 [debug] [ThreadPool]: On list_foo: Close
[0m13:59:15.478083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m13:59:15.487711 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m13:59:15.488296 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m13:59:15.488765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:15.497695 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:59:15.498354 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m13:59:15.499068 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m13:59:15.517463 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.018 seconds
[0m13:59:15.519524 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m13:59:15.520429 [debug] [ThreadPool]: On list_foo_zap: Close
[0m13:59:15.527984 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:15.528585 [debug] [MainThread]: On master: BEGIN
[0m13:59:15.529073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:15.538987 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:59:15.539616 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:15.540211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:59:15.547717 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m13:59:15.550195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf7f871e-8b3b-4cc9-a5c6-5ec894947e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6ac076260>]}
[0m13:59:15.551158 [debug] [MainThread]: On master: ROLLBACK
[0m13:59:15.552110 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:15.552670 [debug] [MainThread]: On master: BEGIN
[0m13:59:15.553430 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:59:15.553950 [debug] [MainThread]: On master: COMMIT
[0m13:59:15.554408 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:15.554860 [debug] [MainThread]: On master: COMMIT
[0m13:59:15.555475 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:59:15.556012 [debug] [MainThread]: On master: Close
[0m13:59:15.558790 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m13:59:15.559490 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m13:59:15.560375 [info ] [Thread-1 (]: 1 of 2 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m13:59:15.561270 [info ] [Thread-2 (]: 2 of 2 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m13:59:15.562195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m13:59:15.562960 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m13:59:15.563568 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m13:59:15.564133 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m13:59:15.579489 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m13:59:15.583955 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:59:15.585550 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m13:59:15.586512 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m13:59:15.680468 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m13:59:15.681998 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:59:15.683469 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:59:15.684633 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m13:59:15.685399 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m13:59:15.686087 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m13:59:15.686680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:15.687332 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:59:15.696645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:59:15.697417 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m13:59:15.698453 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:59:15.699563 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m13:59:15.700790 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m13:59:15.701929 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m13:59:15.723510 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m13:59:15.730055 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m13:59:15.734342 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m13:59:15.739469 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:59:15.740427 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m13:59:15.741302 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m13:59:15.742589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:15.743249 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:59:15.783026 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m13:59:15.779873 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m13:59:15.784346 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:59:15.785164 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m13:59:15.785890 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m13:59:15.786516 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m13:59:15.788703 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m13:59:15.794834 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m13:59:15.799123 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m13:59:15.803686 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m13:59:15.810798 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m13:59:15.812556 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:59:15.813240 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m13:59:15.813896 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m13:59:15.815120 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:59:15.816261 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:59:15.820314 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m13:59:15.822844 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m13:59:15.827548 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf7f871e-8b3b-4cc9-a5c6-5ec894947e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6ab9b7f70>]}
[0m13:59:15.828410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf7f871e-8b3b-4cc9-a5c6-5ec894947e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6ab58ee60>]}
[0m13:59:15.829730 [info ] [Thread-2 (]: 2 of 2 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.26s]
[0m13:59:15.830769 [info ] [Thread-1 (]: 1 of 2 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.26s]
[0m13:59:15.831854 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m13:59:15.832853 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m13:59:15.834974 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:15.835637 [debug] [MainThread]: On master: BEGIN
[0m13:59:15.836362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:15.845348 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:59:15.846216 [debug] [MainThread]: On master: COMMIT
[0m13:59:15.847033 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:15.847524 [debug] [MainThread]: On master: COMMIT
[0m13:59:15.848751 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:59:15.849994 [debug] [MainThread]: On master: Close
[0m13:59:15.851886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:15.853031 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m13:59:15.853764 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m13:59:15.854474 [info ] [MainThread]: 
[0m13:59:15.855152 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m13:59:15.856336 [debug] [MainThread]: Command end result
[0m13:59:15.949785 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m13:59:15.952249 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m13:59:15.961066 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m13:59:15.961649 [info ] [MainThread]: 
[0m13:59:15.962216 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:15.962748 [info ] [MainThread]: 
[0m13:59:15.963260 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:59:15.964532 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5510677, "process_in_blocks": "51328", "process_kernel_time": 0.261335, "process_mem_max_rss": "110788", "process_out_blocks": "1792", "process_user_time": 2.874691}
[0m13:59:15.965384 [debug] [MainThread]: Command `dbt run` succeeded at 13:59:15.965217 after 1.55 seconds
[0m13:59:15.966135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6add90e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6b06defb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6aedbab60>]}
[0m13:59:15.966922 [debug] [MainThread]: Flushing usage events
[0m13:59:17.387087 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:05:46.589090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739dc7994e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739dc8862320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739dc88622c0>]}


============================== 23:05:46.596218 | 51a19b95-0cdb-4738-848c-287b9852991d ==============================
[0m23:05:46.596218 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:05:46.597866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:05:46.932997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51a19b95-0cdb-4738-848c-287b9852991d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739dc8813970>]}
[0m23:05:47.052320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51a19b95-0cdb-4738-848c-287b9852991d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739dc69cce20>]}
[0m23:05:47.053876 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:05:47.250435 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:05:47.470939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:05:47.471760 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:05:47.472951 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m23:05:47.473781 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m23:05:47.474316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '51a19b95-0cdb-4738-848c-287b9852991d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739dc5d33670>]}
[0m23:05:47.484886 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m23:05:47.542587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51a19b95-0cdb-4738-848c-287b9852991d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739dc5d8aa10>]}
[0m23:05:47.680735 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m23:05:47.685377 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m23:05:47.714640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51a19b95-0cdb-4738-848c-287b9852991d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739dc5c64550>]}
[0m23:05:47.715579 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m23:05:47.716551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a19b95-0cdb-4738-848c-287b9852991d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739dc5c64a90>]}
[0m23:05:47.719676 [info ] [MainThread]: 
[0m23:05:47.720421 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:05:47.721411 [info ] [MainThread]: 
[0m23:05:47.723447 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:05:47.732267 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m23:05:47.799888 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m23:05:47.800607 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m23:05:47.801197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:47.873871 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.072 seconds
[0m23:05:47.876394 [debug] [ThreadPool]: On list_foo: Close
[0m23:05:47.881326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m23:05:47.893135 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m23:05:47.894464 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m23:05:47.895783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:05:47.905003 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m23:05:47.905617 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m23:05:47.906086 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m23:05:47.933166 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.026 seconds
[0m23:05:47.935616 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m23:05:47.936494 [debug] [ThreadPool]: On list_foo_zap: Close
[0m23:05:47.944579 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:47.945912 [debug] [MainThread]: On master: BEGIN
[0m23:05:47.946714 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:05:47.954927 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:05:47.955683 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:47.956479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:05:47.971535 [debug] [MainThread]: SQL status: SELECT 2 in 0.014 seconds
[0m23:05:47.974800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a19b95-0cdb-4738-848c-287b9852991d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739dc5c752a0>]}
[0m23:05:47.975730 [debug] [MainThread]: On master: ROLLBACK
[0m23:05:47.977046 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:47.978441 [debug] [MainThread]: On master: BEGIN
[0m23:05:47.980008 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:05:47.980633 [debug] [MainThread]: On master: COMMIT
[0m23:05:47.981089 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:47.981538 [debug] [MainThread]: On master: COMMIT
[0m23:05:47.982224 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:05:47.982791 [debug] [MainThread]: On master: Close
[0m23:05:47.985430 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m23:05:47.986226 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m23:05:47.987238 [info ] [Thread-1 (]: 1 of 2 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m23:05:47.988215 [info ] [Thread-2 (]: 2 of 2 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m23:05:47.989109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m23:05:47.990239 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m23:05:47.991097 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m23:05:47.991741 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m23:05:48.006755 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m23:05:48.010677 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m23:05:48.012390 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m23:05:48.013689 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m23:05:48.134388 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m23:05:48.139074 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m23:05:48.140641 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m23:05:48.141716 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m23:05:48.142597 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m23:05:48.148738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:05:48.147122 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m23:05:48.150656 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:05:48.161863 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m23:05:48.163419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m23:05:48.164279 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m23:05:48.165210 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m23:05:48.166111 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m23:05:48.167216 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m23:05:48.195170 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m23:05:48.197067 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m23:05:48.217729 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m23:05:48.220064 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m23:05:48.220737 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m23:05:48.221470 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices" rename to "gold_flat_avg_prices__dbt_backup"
[0m23:05:48.222743 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:48.229817 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m23:05:48.230592 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m23:05:48.231221 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m23:05:48.236310 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m23:05:48.237202 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m23:05:48.238423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:05:48.245472 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m23:05:48.291966 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m23:05:48.287288 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m23:05:48.293368 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m23:05:48.294360 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m23:05:48.295654 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m23:05:48.296762 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m23:05:48.299322 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:05:48.300292 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m23:05:48.310699 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m23:05:48.317181 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m23:05:48.330961 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m23:05:48.332421 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m23:05:48.327364 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m23:05:48.334324 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m23:05:48.338233 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:05:48.339037 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:05:48.343480 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m23:05:48.347437 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m23:05:48.352635 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a19b95-0cdb-4738-848c-287b9852991d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739dc55ab640>]}
[0m23:05:48.353597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a19b95-0cdb-4738-848c-287b9852991d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739dc5516380>]}
[0m23:05:48.355132 [info ] [Thread-2 (]: 2 of 2 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.36s]
[0m23:05:48.356713 [info ] [Thread-1 (]: 1 of 2 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.36s]
[0m23:05:48.357827 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m23:05:48.358924 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m23:05:48.362031 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:48.363287 [debug] [MainThread]: On master: BEGIN
[0m23:05:48.364107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:05:48.373132 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m23:05:48.373849 [debug] [MainThread]: On master: COMMIT
[0m23:05:48.374509 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:48.375113 [debug] [MainThread]: On master: COMMIT
[0m23:05:48.375987 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:05:48.376798 [debug] [MainThread]: On master: Close
[0m23:05:48.378384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:48.379429 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m23:05:48.380381 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m23:05:48.381837 [info ] [MainThread]: 
[0m23:05:48.383137 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m23:05:48.385047 [debug] [MainThread]: Command end result
[0m23:05:48.532776 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m23:05:48.536901 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m23:05:48.553882 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m23:05:48.555340 [info ] [MainThread]: 
[0m23:05:48.556969 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:05:48.558713 [info ] [MainThread]: 
[0m23:05:48.560810 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:05:48.564319 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1100361, "process_in_blocks": "47184", "process_kernel_time": 0.318756, "process_mem_max_rss": "111008", "process_out_blocks": "1792", "process_user_time": 3.964848}
[0m23:05:48.565963 [debug] [MainThread]: Command `dbt run` succeeded at 23:05:48.565509 after 2.11 seconds
[0m23:05:48.567492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739dc7994e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739dc6ee2ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739dc7845ed0>]}
[0m23:05:48.568876 [debug] [MainThread]: Flushing usage events
[0m23:05:49.892330 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:59:37.646156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769987f1cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769988dba3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769988dba350>]}


============================== 00:59:37.650772 | 47f1030a-ffca-4918-8ad5-e8daee0f44c1 ==============================
[0m00:59:37.650772 [info ] [MainThread]: Running with dbt=1.9.2
[0m00:59:37.652254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:59:38.001649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47f1030a-ffca-4918-8ad5-e8daee0f44c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769988f337f0>]}
[0m00:59:38.131638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47f1030a-ffca-4918-8ad5-e8daee0f44c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769987c993f0>]}
[0m00:59:38.133070 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:59:38.356009 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m00:59:38.597808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:59:38.598606 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:59:38.599424 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m00:59:38.600352 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m00:59:38.601292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '47f1030a-ffca-4918-8ad5-e8daee0f44c1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769986323610>]}
[0m00:59:38.615986 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m00:59:38.695462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47f1030a-ffca-4918-8ad5-e8daee0f44c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76998638b190>]}
[0m00:59:38.875318 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m00:59:38.881098 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m00:59:38.900608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47f1030a-ffca-4918-8ad5-e8daee0f44c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769986261f00>]}
[0m00:59:38.902254 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m00:59:38.903679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47f1030a-ffca-4918-8ad5-e8daee0f44c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769986262c20>]}
[0m00:59:38.907410 [info ] [MainThread]: 
[0m00:59:38.908307 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:59:38.909085 [info ] [MainThread]: 
[0m00:59:38.910307 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:59:38.920152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m00:59:38.993434 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m00:59:38.994321 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m00:59:38.995070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:59:39.012417 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m00:59:39.014883 [debug] [ThreadPool]: On list_foo: Close
[0m00:59:39.018567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m00:59:39.032383 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m00:59:39.033222 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m00:59:39.033995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:59:39.047092 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m00:59:39.048502 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m00:59:39.049298 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m00:59:39.054397 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m00:59:39.057120 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m00:59:39.058373 [debug] [ThreadPool]: On list_foo_zap: Close
[0m00:59:39.070220 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:39.071089 [debug] [MainThread]: On master: BEGIN
[0m00:59:39.071878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:59:39.084252 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m00:59:39.085346 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:39.086667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:59:39.093380 [debug] [MainThread]: SQL status: SELECT 2 in 0.006 seconds
[0m00:59:39.096476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47f1030a-ffca-4918-8ad5-e8daee0f44c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76998625a920>]}
[0m00:59:39.097385 [debug] [MainThread]: On master: ROLLBACK
[0m00:59:39.098503 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:39.099253 [debug] [MainThread]: On master: BEGIN
[0m00:59:39.100697 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:59:39.102017 [debug] [MainThread]: On master: COMMIT
[0m00:59:39.103069 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:39.103952 [debug] [MainThread]: On master: COMMIT
[0m00:59:39.105217 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:59:39.106154 [debug] [MainThread]: On master: Close
[0m00:59:39.110436 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m00:59:39.111447 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m00:59:39.113332 [info ] [Thread-1 (]: 1 of 2 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m00:59:39.114688 [info ] [Thread-2 (]: 2 of 2 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m00:59:39.115858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m00:59:39.117081 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m00:59:39.118228 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m00:59:39.119440 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m00:59:39.145571 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:59:39.149550 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m00:59:39.151552 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m00:59:39.153163 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m00:59:39.316658 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m00:59:39.318838 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:59:39.320979 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:59:39.322162 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:59:39.323186 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m00:59:39.324318 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m00:59:39.325263 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:59:39.326141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:39.339044 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m00:59:39.340121 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m00:59:39.341234 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:59:39.342154 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:59:39.343071 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m00:59:39.344064 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m00:59:39.348971 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m00:59:39.355373 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m00:59:39.371885 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:59:39.376152 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:59:39.377331 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices" rename to "gold_flat_avg_prices__dbt_backup"
[0m00:59:39.378805 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m00:59:39.380547 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:59:39.381481 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:59:39.388655 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:59:39.395698 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:59:39.396853 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m00:59:39.398445 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m00:59:39.400461 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:59:39.407430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m00:59:39.469827 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m00:59:39.466121 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m00:59:39.471360 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:59:39.472468 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:59:39.473547 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m00:59:39.474627 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m00:59:39.478180 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m00:59:39.479620 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m00:59:39.499923 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m00:59:39.502670 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m00:59:39.513498 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:59:39.516399 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:59:39.517342 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m00:59:39.519106 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m00:59:39.523364 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m00:59:39.524445 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m00:59:39.529414 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m00:59:39.533544 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m00:59:39.539831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f1030a-ffca-4918-8ad5-e8daee0f44c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769985baf550>]}
[0m00:59:39.541021 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47f1030a-ffca-4918-8ad5-e8daee0f44c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7699857adb10>]}
[0m00:59:39.542463 [info ] [Thread-1 (]: 1 of 2 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.42s]
[0m00:59:39.544439 [info ] [Thread-2 (]: 2 of 2 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.42s]
[0m00:59:39.545874 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m00:59:39.547113 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m00:59:39.549857 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:39.551105 [debug] [MainThread]: On master: BEGIN
[0m00:59:39.552529 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:59:39.565968 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m00:59:39.567116 [debug] [MainThread]: On master: COMMIT
[0m00:59:39.568372 [debug] [MainThread]: Using postgres connection "master"
[0m00:59:39.569712 [debug] [MainThread]: On master: COMMIT
[0m00:59:39.571720 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:59:39.573151 [debug] [MainThread]: On master: Close
[0m00:59:39.574607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:59:39.575390 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m00:59:39.576205 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m00:59:39.577057 [info ] [MainThread]: 
[0m00:59:39.577833 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m00:59:39.579547 [debug] [MainThread]: Command end result
[0m00:59:39.696762 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m00:59:39.699555 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m00:59:39.714473 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m00:59:39.715274 [info ] [MainThread]: 
[0m00:59:39.716139 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:59:39.716960 [info ] [MainThread]: 
[0m00:59:39.717919 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:59:39.720401 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1907325, "process_in_blocks": "0", "process_kernel_time": 0.284031, "process_mem_max_rss": "111440", "process_out_blocks": "1800", "process_user_time": 4.24147}
[0m00:59:39.721975 [debug] [MainThread]: Command `dbt run` succeeded at 00:59:39.721567 after 2.19 seconds
[0m00:59:39.723341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769987f1cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769986237cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76998563ad40>]}
[0m00:59:39.724560 [debug] [MainThread]: Flushing usage events
[0m00:59:42.593229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:04:42.459615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c5f898e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c60766320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c607662c0>]}


============================== 01:04:42.466229 | 096967f7-1072-4a52-aecf-aa9b7c326eaa ==============================
[0m01:04:42.466229 [info ] [MainThread]: Running with dbt=1.9.2
[0m01:04:42.467429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:04:42.862995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '096967f7-1072-4a52-aecf-aa9b7c326eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c60717970>]}
[0m01:04:43.003701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '096967f7-1072-4a52-aecf-aa9b7c326eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c5ebb0e20>]}
[0m01:04:43.005993 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:04:43.233538 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m01:04:43.590958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:04:43.591737 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:04:43.592618 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m01:04:43.593850 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m01:04:43.594810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '096967f7-1072-4a52-aecf-aa9b7c326eaa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c5dd3b670>]}
[0m01:04:43.606330 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m01:04:43.672375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '096967f7-1072-4a52-aecf-aa9b7c326eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c5dd92a10>]}
[0m01:04:43.824821 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m01:04:43.829971 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m01:04:43.859446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '096967f7-1072-4a52-aecf-aa9b7c326eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c5dc6c550>]}
[0m01:04:43.860513 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m01:04:43.861500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '096967f7-1072-4a52-aecf-aa9b7c326eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c5dc6ca90>]}
[0m01:04:43.864900 [info ] [MainThread]: 
[0m01:04:43.865820 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:04:43.866529 [info ] [MainThread]: 
[0m01:04:43.867680 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:04:43.875358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m01:04:43.938764 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m01:04:43.939511 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m01:04:43.940139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:43.953546 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m01:04:43.955621 [debug] [ThreadPool]: On list_foo: Close
[0m01:04:43.958676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m01:04:43.969484 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m01:04:43.970522 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m01:04:43.971387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:43.981483 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:04:43.982402 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m01:04:43.983392 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m01:04:43.988585 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m01:04:43.991631 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m01:04:43.992785 [debug] [ThreadPool]: On list_foo_zap: Close
[0m01:04:44.004274 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:44.005673 [debug] [MainThread]: On master: BEGIN
[0m01:04:44.006624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:04:44.018499 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m01:04:44.019312 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:44.020513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:04:44.025473 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m01:04:44.027355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '096967f7-1072-4a52-aecf-aa9b7c326eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c5e0f0580>]}
[0m01:04:44.028570 [debug] [MainThread]: On master: ROLLBACK
[0m01:04:44.030147 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:44.031097 [debug] [MainThread]: On master: BEGIN
[0m01:04:44.032991 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:04:44.034064 [debug] [MainThread]: On master: COMMIT
[0m01:04:44.034785 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:44.035452 [debug] [MainThread]: On master: COMMIT
[0m01:04:44.036436 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:04:44.037180 [debug] [MainThread]: On master: Close
[0m01:04:44.040936 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m01:04:44.042230 [info ] [Thread-1 (]: 1 of 2 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m01:04:44.043103 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m01:04:44.044194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m01:04:44.045294 [info ] [Thread-2 (]: 2 of 2 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m01:04:44.046378 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m01:04:44.047797 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m01:04:44.059403 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m01:04:44.062412 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:04:44.068477 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m01:04:44.069618 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m01:04:44.070381 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m01:04:44.190213 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m01:04:44.191717 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:04:44.193463 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:04:44.195027 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m01:04:44.195905 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:04:44.197182 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:04:44.198939 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m01:04:44.199994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:44.206961 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m01:04:44.207791 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:04:44.208588 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m01:04:44.210584 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:04:44.211933 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:04:44.212980 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m01:04:44.215217 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m01:04:44.225056 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:04:44.225957 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m01:04:44.226868 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m01:04:44.237188 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:04:44.238448 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m01:04:44.239543 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:04:44.246178 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m01:04:44.285073 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m01:04:44.286384 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m01:04:44.287246 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:04:44.288334 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:04:44.289393 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m01:04:44.290324 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m01:04:44.292689 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:04:44.293772 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m01:04:44.313274 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m01:04:44.315390 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m01:04:44.323835 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:04:44.325377 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:04:44.326169 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m01:04:44.327418 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m01:04:44.329557 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:04:44.330596 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m01:04:44.334917 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m01:04:44.337518 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m01:04:44.341381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '096967f7-1072-4a52-aecf-aa9b7c326eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c5d5a4970>]}
[0m01:04:44.342114 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '096967f7-1072-4a52-aecf-aa9b7c326eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c5d19d120>]}
[0m01:04:44.343272 [info ] [Thread-1 (]: 1 of 2 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.29s]
[0m01:04:44.345025 [info ] [Thread-2 (]: 2 of 2 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.29s]
[0m01:04:44.346723 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m01:04:44.348436 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m01:04:44.350924 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:44.351764 [debug] [MainThread]: On master: BEGIN
[0m01:04:44.352548 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:04:44.362808 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:04:44.363686 [debug] [MainThread]: On master: COMMIT
[0m01:04:44.364388 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:44.365045 [debug] [MainThread]: On master: COMMIT
[0m01:04:44.366110 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:04:44.366899 [debug] [MainThread]: On master: Close
[0m01:04:44.368170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:44.368962 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m01:04:44.369723 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m01:04:44.370532 [info ] [MainThread]: 
[0m01:04:44.371458 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m01:04:44.372809 [debug] [MainThread]: Command end result
[0m01:04:44.465950 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m01:04:44.468366 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m01:04:44.479001 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m01:04:44.479829 [info ] [MainThread]: 
[0m01:04:44.480933 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:04:44.481750 [info ] [MainThread]: 
[0m01:04:44.482798 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:04:44.484200 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1524336, "process_in_blocks": "33208", "process_kernel_time": 0.377435, "process_mem_max_rss": "111416", "process_out_blocks": "1792", "process_user_time": 4.591965}
[0m01:04:44.485117 [debug] [MainThread]: Command `dbt run` succeeded at 01:04:44.484853 after 2.15 seconds
[0m01:04:44.485882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c5f898e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c608beb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777c5dc5bd00>]}
[0m01:04:44.486723 [debug] [MainThread]: Flushing usage events
[0m01:04:45.280840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:37.844995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceceb4d4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cecec36a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cecec36a2c0>]}


============================== 15:18:37.850552 | 5e8e1493-c762-4fbf-8688-5808df92edc9 ==============================
[0m15:18:37.850552 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:18:37.851680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:18:38.166560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e8e1493-c762-4fbf-8688-5808df92edc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cecec4bb880>]}
[0m15:18:38.277729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e8e1493-c762-4fbf-8688-5808df92edc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cecec35a1a0>]}
[0m15:18:38.280752 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:18:38.481460 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:18:38.719448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:38.720237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:38.721461 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m15:18:38.722749 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m15:18:38.723753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5e8e1493-c762-4fbf-8688-5808df92edc9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cece992f6a0>]}
[0m15:18:38.738061 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m15:18:38.834393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e8e1493-c762-4fbf-8688-5808df92edc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cece998e590>]}
[0m15:18:39.004703 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m15:18:39.010343 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m15:18:39.040154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e8e1493-c762-4fbf-8688-5808df92edc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cece98328c0>]}
[0m15:18:39.041158 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m15:18:39.041944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e8e1493-c762-4fbf-8688-5808df92edc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cece98830d0>]}
[0m15:18:39.044851 [info ] [MainThread]: 
[0m15:18:39.045680 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:18:39.046358 [info ] [MainThread]: 
[0m15:18:39.047477 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:18:39.056661 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m15:18:39.129982 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m15:18:39.130774 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m15:18:39.131403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:39.146203 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m15:18:39.148506 [debug] [ThreadPool]: On list_foo: Close
[0m15:18:39.153020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m15:18:39.164923 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m15:18:39.165742 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m15:18:39.166374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:39.178436 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m15:18:39.179226 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m15:18:39.179873 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m15:18:39.194342 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m15:18:39.197455 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m15:18:39.198500 [debug] [ThreadPool]: On list_foo_zap: Close
[0m15:18:39.208516 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:39.209346 [debug] [MainThread]: On master: BEGIN
[0m15:18:39.209951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:39.221114 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m15:18:39.221923 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:39.222688 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:18:39.230410 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m15:18:39.233458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e8e1493-c762-4fbf-8688-5808df92edc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cece9876260>]}
[0m15:18:39.234388 [debug] [MainThread]: On master: ROLLBACK
[0m15:18:39.235413 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:39.236164 [debug] [MainThread]: On master: BEGIN
[0m15:18:39.237328 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:18:39.238117 [debug] [MainThread]: On master: COMMIT
[0m15:18:39.238829 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:39.239457 [debug] [MainThread]: On master: COMMIT
[0m15:18:39.240452 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:18:39.241188 [debug] [MainThread]: On master: Close
[0m15:18:39.244999 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m15:18:39.245926 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m15:18:39.247019 [info ] [Thread-1 (]: 1 of 2 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m15:18:39.248198 [info ] [Thread-2 (]: 2 of 2 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m15:18:39.249310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m15:18:39.250369 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m15:18:39.251291 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m15:18:39.252198 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m15:18:39.275473 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m15:18:39.278224 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m15:18:39.279723 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m15:18:39.280594 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m15:18:39.441543 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m15:18:39.446219 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m15:18:39.447781 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m15:18:39.448615 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m15:18:39.449372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:39.450401 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m15:18:39.451268 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m15:18:39.452050 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:18:39.461326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m15:18:39.462258 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m15:18:39.463255 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m15:18:39.464188 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m15:18:39.465112 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m15:18:39.466020 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m15:18:39.473951 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m15:18:39.482804 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m15:18:39.488386 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m15:18:39.496906 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m15:18:39.498026 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m15:18:39.499427 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m15:18:39.501455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:18:39.502377 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:18:39.558270 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m15:18:39.562721 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m15:18:39.564112 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m15:18:39.565525 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m15:18:39.566373 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m15:18:39.567262 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m15:18:39.570820 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m15:18:39.572321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:18:39.590845 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m15:18:39.594456 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m15:18:39.604483 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m15:18:39.606844 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m15:18:39.607765 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m15:18:39.608924 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m15:18:39.610203 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:18:39.614818 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m15:18:39.615927 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m15:18:39.619105 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m15:18:39.624195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e8e1493-c762-4fbf-8688-5808df92edc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cece91bf550>]}
[0m15:18:39.625153 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e8e1493-c762-4fbf-8688-5808df92edc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cece91267d0>]}
[0m15:18:39.627023 [info ] [Thread-1 (]: 1 of 2 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.37s]
[0m15:18:39.628537 [info ] [Thread-2 (]: 2 of 2 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.37s]
[0m15:18:39.630264 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m15:18:39.631397 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m15:18:39.634475 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:39.635353 [debug] [MainThread]: On master: BEGIN
[0m15:18:39.636156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:39.648461 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:18:39.649312 [debug] [MainThread]: On master: COMMIT
[0m15:18:39.650007 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:39.650809 [debug] [MainThread]: On master: COMMIT
[0m15:18:39.651842 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:18:39.652587 [debug] [MainThread]: On master: Close
[0m15:18:39.653683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:39.654546 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m15:18:39.655212 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m15:18:39.655994 [info ] [MainThread]: 
[0m15:18:39.656711 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m15:18:39.658368 [debug] [MainThread]: Command end result
[0m15:18:39.763878 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m15:18:39.766540 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m15:18:39.779140 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m15:18:39.779897 [info ] [MainThread]: 
[0m15:18:39.780690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:39.781412 [info ] [MainThread]: 
[0m15:18:39.782170 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:18:39.783727 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0457804, "process_in_blocks": "33072", "process_kernel_time": 0.291881, "process_mem_max_rss": "111472", "process_out_blocks": "1800", "process_user_time": 3.921407}
[0m15:18:39.784641 [debug] [MainThread]: Command `dbt run` succeeded at 15:18:39.784461 after 2.05 seconds
[0m15:18:39.785425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceceb4d4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cece9882440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ceceb793ac0>]}
[0m15:18:39.786468 [debug] [MainThread]: Flushing usage events
[0m15:18:41.305886 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:38:02.941523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbbbf5d4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbbc0466320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbbc04662c0>]}


============================== 15:38:02.949679 | f2c38421-70dd-4f39-8066-f909dc37905a ==============================
[0m15:38:02.949679 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:38:02.952286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:38:03.320468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2c38421-70dd-4f39-8066-f909dc37905a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbbc0413970>]}
[0m15:38:03.431784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2c38421-70dd-4f39-8066-f909dc37905a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbbbe5d06d0>]}
[0m15:38:03.433166 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:38:03.622244 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:38:03.839143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:38:03.839920 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:38:03.840840 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m15:38:03.841831 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m15:38:03.842560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f2c38421-70dd-4f39-8066-f909dc37905a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbbbd92b670>]}
[0m15:38:03.855076 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m15:38:03.930210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2c38421-70dd-4f39-8066-f909dc37905a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbbbd98aa10>]}
[0m15:38:04.124252 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m15:38:04.132639 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m15:38:04.157757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2c38421-70dd-4f39-8066-f909dc37905a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbbbd864550>]}
[0m15:38:04.159123 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m15:38:04.160087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2c38421-70dd-4f39-8066-f909dc37905a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbbbd864a90>]}
[0m15:38:04.163454 [info ] [MainThread]: 
[0m15:38:04.164468 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:38:04.165925 [info ] [MainThread]: 
[0m15:38:04.167811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:38:04.179717 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m15:38:04.251207 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m15:38:04.252084 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m15:38:04.252846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:04.267245 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m15:38:04.270065 [debug] [ThreadPool]: On list_foo: Close
[0m15:38:04.273217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m15:38:04.285905 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m15:38:04.286800 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m15:38:04.287651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:04.298585 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:38:04.299412 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m15:38:04.300203 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m15:38:04.304601 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m15:38:04.307291 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m15:38:04.308743 [debug] [ThreadPool]: On list_foo_zap: Close
[0m15:38:04.319799 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:04.320715 [debug] [MainThread]: On master: BEGIN
[0m15:38:04.321421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:38:04.333997 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:38:04.334883 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:04.335743 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:38:04.342378 [debug] [MainThread]: SQL status: SELECT 2 in 0.006 seconds
[0m15:38:04.345522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2c38421-70dd-4f39-8066-f909dc37905a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbbbd8712a0>]}
[0m15:38:04.346444 [debug] [MainThread]: On master: ROLLBACK
[0m15:38:04.347628 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:04.348453 [debug] [MainThread]: On master: BEGIN
[0m15:38:04.349860 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:38:04.350771 [debug] [MainThread]: On master: COMMIT
[0m15:38:04.351546 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:04.352311 [debug] [MainThread]: On master: COMMIT
[0m15:38:04.353322 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:38:04.354169 [debug] [MainThread]: On master: Close
[0m15:38:04.358364 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m15:38:04.359432 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m15:38:04.360567 [info ] [Thread-1 (]: 1 of 2 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m15:38:04.361792 [info ] [Thread-2 (]: 2 of 2 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m15:38:04.363038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m15:38:04.364240 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m15:38:04.365190 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m15:38:04.366101 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m15:38:04.391282 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m15:38:04.394042 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m15:38:04.395470 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m15:38:04.396472 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m15:38:04.541738 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m15:38:04.544951 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m15:38:04.546518 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m15:38:04.547343 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m15:38:04.548111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:04.548929 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m15:38:04.549988 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m15:38:04.550802 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:38:04.564121 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m15:38:04.565559 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m15:38:04.566413 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m15:38:04.567319 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m15:38:04.568191 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m15:38:04.569161 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m15:38:04.574525 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:38:04.581125 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m15:38:04.594675 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m15:38:04.597672 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m15:38:04.598503 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m15:38:04.599333 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices" rename to "gold_flat_avg_prices__dbt_backup"
[0m15:38:04.601340 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:38:04.602288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:38:04.608530 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m15:38:04.614598 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m15:38:04.615447 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m15:38:04.616246 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m15:38:04.618156 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:38:04.619063 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:38:04.675081 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m15:38:04.678356 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m15:38:04.679240 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m15:38:04.680082 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m15:38:04.680911 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m15:38:04.681741 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m15:38:04.685618 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m15:38:04.686855 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:38:04.704762 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m15:38:04.707661 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m15:38:04.716540 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m15:38:04.718357 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m15:38:04.719256 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m15:38:04.720146 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m15:38:04.724390 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:38:04.725422 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m15:38:04.730015 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m15:38:04.732497 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m15:38:04.736539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c38421-70dd-4f39-8066-f909dc37905a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbbbd1bb550>]}
[0m15:38:04.737411 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2c38421-70dd-4f39-8066-f909dc37905a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbbbcdc9c90>]}
[0m15:38:04.738704 [info ] [Thread-1 (]: 1 of 2 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.37s]
[0m15:38:04.740212 [info ] [Thread-2 (]: 2 of 2 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.37s]
[0m15:38:04.741639 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m15:38:04.742755 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m15:38:04.745322 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:04.746321 [debug] [MainThread]: On master: BEGIN
[0m15:38:04.747245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:38:04.759999 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m15:38:04.761105 [debug] [MainThread]: On master: COMMIT
[0m15:38:04.761998 [debug] [MainThread]: Using postgres connection "master"
[0m15:38:04.762636 [debug] [MainThread]: On master: COMMIT
[0m15:38:04.763635 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:38:04.764386 [debug] [MainThread]: On master: Close
[0m15:38:04.765395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:04.766144 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m15:38:04.766837 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m15:38:04.768077 [info ] [MainThread]: 
[0m15:38:04.769553 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m15:38:04.771424 [debug] [MainThread]: Command end result
[0m15:38:04.873284 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m15:38:04.876333 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m15:38:04.888569 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m15:38:04.889309 [info ] [MainThread]: 
[0m15:38:04.890128 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:38:04.890829 [info ] [MainThread]: 
[0m15:38:04.891709 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:38:04.893344 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.06742, "process_in_blocks": "0", "process_kernel_time": 0.241934, "process_mem_max_rss": "111348", "process_out_blocks": "1792", "process_user_time": 4.071897}
[0m15:38:04.894228 [debug] [MainThread]: Command `dbt run` succeeded at 15:38:04.894068 after 2.07 seconds
[0m15:38:04.894987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbbbf5d4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbbbeb26ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbbbf489ed0>]}
[0m15:38:04.895917 [debug] [MainThread]: Flushing usage events
[0m15:38:06.532871 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:08.579049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d95f38e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d96e0e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d96e0e2f0>]}


============================== 01:02:08.584371 | 58cc16af-1750-4f7f-a32b-2c2dba3e2860 ==============================
[0m01:02:08.584371 [info ] [MainThread]: Running with dbt=1.9.2
[0m01:02:08.585557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'profiles_dir': '/home/peon/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:02:08.911877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58cc16af-1750-4f7f-a32b-2c2dba3e2860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d96f5f880>]}
[0m01:02:09.025463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58cc16af-1750-4f7f-a32b-2c2dba3e2860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d9522f9d0>]}
[0m01:02:09.028103 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:02:09.230363 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m01:02:09.421075 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:02:09.422086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '58cc16af-1750-4f7f-a32b-2c2dba3e2860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d9571b730>]}
[0m01:02:11.388546 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'gold_apartment_rent' in the 'models' section of file 'models/mart/schema.yml'
[0m01:02:11.733825 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m01:02:11.734975 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m01:02:11.735885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '58cc16af-1750-4f7f-a32b-2c2dba3e2860', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d9424e290>]}
[0m01:02:11.737509 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m01:02:11.763875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58cc16af-1750-4f7f-a32b-2c2dba3e2860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d93d91150>]}
[0m01:02:11.918675 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m01:02:11.924281 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m01:02:11.955076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58cc16af-1750-4f7f-a32b-2c2dba3e2860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d93d64f10>]}
[0m01:02:11.956088 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m01:02:11.956825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58cc16af-1750-4f7f-a32b-2c2dba3e2860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d93d65e10>]}
[0m01:02:11.959729 [info ] [MainThread]: 
[0m01:02:11.960574 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:02:11.961325 [info ] [MainThread]: 
[0m01:02:11.962379 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:02:11.973483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m01:02:12.046063 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m01:02:12.046899 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m01:02:12.047575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:12.066009 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m01:02:12.068400 [debug] [ThreadPool]: On list_foo: Close
[0m01:02:12.070037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now create_foo_zapimoveis)
[0m01:02:12.071132 [debug] [ThreadPool]: Creating schema "database: "foo"
schema: "zapimoveis"
"
[0m01:02:12.081877 [debug] [ThreadPool]: Using postgres connection "create_foo_zapimoveis"
[0m01:02:12.082683 [debug] [ThreadPool]: On create_foo_zapimoveis: BEGIN
[0m01:02:12.083376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:12.095524 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m01:02:12.096635 [debug] [ThreadPool]: Using postgres connection "create_foo_zapimoveis"
[0m01:02:12.097588 [debug] [ThreadPool]: On create_foo_zapimoveis: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "create_foo_zapimoveis"} */
create schema if not exists "zapimoveis"
[0m01:02:12.101529 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.003 seconds
[0m01:02:12.103687 [debug] [ThreadPool]: On create_foo_zapimoveis: COMMIT
[0m01:02:12.104563 [debug] [ThreadPool]: Using postgres connection "create_foo_zapimoveis"
[0m01:02:12.105289 [debug] [ThreadPool]: On create_foo_zapimoveis: COMMIT
[0m01:02:12.107046 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m01:02:12.107862 [debug] [ThreadPool]: On create_foo_zapimoveis: Close
[0m01:02:12.110886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_foo_zapimoveis, now list_foo_zapimoveis)
[0m01:02:12.123285 [debug] [ThreadPool]: Using postgres connection "list_foo_zapimoveis"
[0m01:02:12.124102 [debug] [ThreadPool]: On list_foo_zapimoveis: BEGIN
[0m01:02:12.124774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:12.139150 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m01:02:12.140022 [debug] [ThreadPool]: Using postgres connection "list_foo_zapimoveis"
[0m01:02:12.140846 [debug] [ThreadPool]: On list_foo_zapimoveis: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zapimoveis"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zapimoveis'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zapimoveis'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zapimoveis'
  
[0m01:02:12.150157 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m01:02:12.152918 [debug] [ThreadPool]: On list_foo_zapimoveis: ROLLBACK
[0m01:02:12.154121 [debug] [ThreadPool]: On list_foo_zapimoveis: Close
[0m01:02:12.163091 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:12.163920 [debug] [MainThread]: On master: BEGIN
[0m01:02:12.164572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:12.176904 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m01:02:12.177862 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:12.178645 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:02:12.184911 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:02:12.187271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58cc16af-1750-4f7f-a32b-2c2dba3e2860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d971ad6c0>]}
[0m01:02:12.188228 [debug] [MainThread]: On master: ROLLBACK
[0m01:02:12.189282 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:12.190027 [debug] [MainThread]: On master: BEGIN
[0m01:02:12.191336 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:02:12.192096 [debug] [MainThread]: On master: COMMIT
[0m01:02:12.192779 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:12.193429 [debug] [MainThread]: On master: COMMIT
[0m01:02:12.194466 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:12.195237 [debug] [MainThread]: On master: Close
[0m01:02:12.199514 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m01:02:12.200544 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m01:02:12.201666 [info ] [Thread-1 (]: 1 of 2 START sql view model zapimoveis.gold_apartment_avg_prices ............... [RUN]
[0m01:02:12.202910 [info ] [Thread-2 (]: 2 of 2 START sql view model zapimoveis.gold_flat_avg_prices .................... [RUN]
[0m01:02:12.204089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zapimoveis, now model.zap_imoveis.gold_apartment_avg_prices)
[0m01:02:12.205203 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m01:02:12.206113 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m01:02:12.207007 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m01:02:12.231107 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:02:12.233487 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m01:02:12.235163 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m01:02:12.236097 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m01:02:12.397348 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:02:12.399105 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m01:02:12.401201 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:02:12.402133 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m01:02:12.402935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:12.404019 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:02:12.404922 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m01:02:12.405732 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:02:12.416500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:02:12.417734 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m01:02:12.418702 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:02:12.419612 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:02:12.420609 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zapimoveis"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m01:02:12.421651 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zapimoveis"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m01:02:12.432654 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m01:02:12.434337 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m01:02:12.446997 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:02:12.454960 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:02:12.456102 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zapimoveis"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m01:02:12.457008 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zapimoveis"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m01:02:12.459067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:02:12.460198 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:02:12.518980 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m01:02:12.519969 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:02:12.520806 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m01:02:12.522352 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m01:02:12.523717 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:02:12.524721 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m01:02:12.525616 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m01:02:12.532022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m01:02:12.546498 [debug] [Thread-2 (]: Applying DROP to: "foo"."zapimoveis"."gold_flat_avg_prices__dbt_backup"
[0m01:02:12.550968 [debug] [Thread-1 (]: Applying DROP to: "foo"."zapimoveis"."gold_apartment_avg_prices__dbt_backup"
[0m01:02:12.561339 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:02:12.564405 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:02:12.565600 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zapimoveis"."gold_flat_avg_prices__dbt_backup" cascade
[0m01:02:12.567302 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zapimoveis"."gold_apartment_avg_prices__dbt_backup" cascade
[0m01:02:12.568971 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:02:12.569890 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:02:12.574676 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m01:02:12.577851 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m01:02:12.583647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cc16af-1750-4f7f-a32b-2c2dba3e2860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d9350dd50>]}
[0m01:02:12.584787 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cc16af-1750-4f7f-a32b-2c2dba3e2860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d93137b50>]}
[0m01:02:12.586663 [info ] [Thread-1 (]: 1 of 2 OK created sql view model zapimoveis.gold_apartment_avg_prices .......... [[32mCREATE VIEW[0m in 0.38s]
[0m01:02:12.588882 [info ] [Thread-2 (]: 2 of 2 OK created sql view model zapimoveis.gold_flat_avg_prices ............... [[32mCREATE VIEW[0m in 0.38s]
[0m01:02:12.591450 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m01:02:12.592667 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m01:02:12.596037 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:12.596971 [debug] [MainThread]: On master: BEGIN
[0m01:02:12.597820 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:12.610859 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m01:02:12.611683 [debug] [MainThread]: On master: COMMIT
[0m01:02:12.612502 [debug] [MainThread]: Using postgres connection "master"
[0m01:02:12.613520 [debug] [MainThread]: On master: COMMIT
[0m01:02:12.614961 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:02:12.616198 [debug] [MainThread]: On master: Close
[0m01:02:12.617495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:12.618284 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m01:02:12.618972 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m01:02:12.619799 [info ] [MainThread]: 
[0m01:02:12.620611 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m01:02:12.622378 [debug] [MainThread]: Command end result
[0m01:02:12.664419 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m01:02:12.667533 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m01:02:12.680065 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m01:02:12.680852 [info ] [MainThread]: 
[0m01:02:12.681648 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:02:12.682374 [info ] [MainThread]: 
[0m01:02:12.683155 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:02:12.684831 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.2152224, "process_in_blocks": "35808", "process_kernel_time": 0.353958, "process_mem_max_rss": "117128", "process_out_blocks": "2632", "process_user_time": 6.143633}
[0m01:02:12.685769 [debug] [MainThread]: Command `dbt run` succeeded at 01:02:12.685590 after 4.22 seconds
[0m01:02:12.686534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d95f38e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d942fb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d93d67b20>]}
[0m01:02:12.687477 [debug] [MainThread]: Flushing usage events
[0m01:02:14.886543 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:04:36.335817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeb90140e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeb90fe6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeb90fe6320>]}


============================== 01:04:36.340427 | 9466da5e-ea8e-40e9-bb13-fd8a41381061 ==============================
[0m01:04:36.340427 [info ] [MainThread]: Running with dbt=1.9.2
[0m01:04:36.341545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/peon/.dbt', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:04:36.651403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9466da5e-ea8e-40e9-bb13-fd8a41381061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeb8f429270>]}
[0m01:04:36.762764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9466da5e-ea8e-40e9-bb13-fd8a41381061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeb8f837bb0>]}
[0m01:04:36.764299 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:04:36.956094 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m01:04:37.180344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:04:37.181139 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:04:37.181984 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m01:04:37.182931 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m01:04:37.183770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9466da5e-ea8e-40e9-bb13-fd8a41381061', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeb8e50f6d0>]}
[0m01:04:37.196663 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m01:04:37.267660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9466da5e-ea8e-40e9-bb13-fd8a41381061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeb8e56e140>]}
[0m01:04:37.430561 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m01:04:37.436215 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m01:04:37.453926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9466da5e-ea8e-40e9-bb13-fd8a41381061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeb8e5ce800>]}
[0m01:04:37.454943 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m01:04:37.455724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9466da5e-ea8e-40e9-bb13-fd8a41381061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeb8e5cfd90>]}
[0m01:04:37.458703 [info ] [MainThread]: 
[0m01:04:37.459563 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:04:37.460332 [info ] [MainThread]: 
[0m01:04:37.461472 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:04:37.470856 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m01:04:37.538654 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m01:04:37.539489 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m01:04:37.540170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:37.555297 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m01:04:37.558047 [debug] [ThreadPool]: On list_foo: Close
[0m01:04:37.561229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zapimoveis)
[0m01:04:37.573749 [debug] [ThreadPool]: Using postgres connection "list_foo_zapimoveis"
[0m01:04:37.574569 [debug] [ThreadPool]: On list_foo_zapimoveis: BEGIN
[0m01:04:37.575243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:37.587952 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m01:04:37.588802 [debug] [ThreadPool]: Using postgres connection "list_foo_zapimoveis"
[0m01:04:37.589506 [debug] [ThreadPool]: On list_foo_zapimoveis: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zapimoveis"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zapimoveis'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zapimoveis'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zapimoveis'
  
[0m01:04:37.594778 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m01:04:37.597601 [debug] [ThreadPool]: On list_foo_zapimoveis: ROLLBACK
[0m01:04:37.598786 [debug] [ThreadPool]: On list_foo_zapimoveis: Close
[0m01:04:37.607694 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:37.608563 [debug] [MainThread]: On master: BEGIN
[0m01:04:37.609283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:04:37.622876 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m01:04:37.623786 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:37.624572 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:04:37.630443 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m01:04:37.633398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9466da5e-ea8e-40e9-bb13-fd8a41381061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeb8eb4df00>]}
[0m01:04:37.634375 [debug] [MainThread]: On master: ROLLBACK
[0m01:04:37.635483 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:37.636243 [debug] [MainThread]: On master: BEGIN
[0m01:04:37.637539 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:04:37.638288 [debug] [MainThread]: On master: COMMIT
[0m01:04:37.638981 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:37.639620 [debug] [MainThread]: On master: COMMIT
[0m01:04:37.640671 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:04:37.641521 [debug] [MainThread]: On master: Close
[0m01:04:37.645498 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m01:04:37.646482 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m01:04:37.647559 [info ] [Thread-1 (]: 1 of 2 START sql view model zapimoveis.gold_apartment_avg_prices ............... [RUN]
[0m01:04:37.648827 [info ] [Thread-2 (]: 2 of 2 START sql view model zapimoveis.gold_flat_avg_prices .................... [RUN]
[0m01:04:37.649985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zapimoveis, now model.zap_imoveis.gold_apartment_avg_prices)
[0m01:04:37.651088 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m01:04:37.651990 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m01:04:37.652855 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m01:04:37.675573 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m01:04:37.678317 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:04:37.679865 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m01:04:37.680736 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m01:04:37.831001 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m01:04:37.835642 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:04:37.836981 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:04:37.837855 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m01:04:37.838613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:37.839986 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:04:37.841127 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m01:04:37.841986 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:04:37.851331 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:04:37.852738 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:04:37.853647 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zapimoveis"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m01:04:37.855143 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m01:04:37.856134 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "zap.silver_zapimoveis" does not exist
LINE 8:     SELECT * FROM "foo"."zap"."silver_zapimoveis" 
                          ^

[0m01:04:37.857163 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:04:37.858111 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: ROLLBACK
[0m01:04:37.859066 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zapimoveis"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m01:04:37.860640 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m01:04:37.861736 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "zap.silver_zapimoveis" does not exist
LINE 8:     SELECT * FROM "foo"."zap"."silver_zapimoveis" 
                          ^

[0m01:04:37.862643 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: ROLLBACK
[0m01:04:37.864644 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m01:04:37.871968 [debug] [Thread-1 (]: Database Error in model gold_apartment_avg_prices (models/mart/gold_apartment_avg_prices.sql)
  relation "zap.silver_zapimoveis" does not exist
  LINE 8:     SELECT * FROM "foo"."zap"."silver_zapimoveis" 
                            ^
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_avg_prices.sql
[0m01:04:37.873352 [debug] [Thread-2 (]: Database Error in model gold_flat_avg_prices (models/mart/gold_flat_avg_prices.sql)
  relation "zap.silver_zapimoveis" does not exist
  LINE 8:     SELECT * FROM "foo"."zap"."silver_zapimoveis" 
                            ^
  compiled code at target/run/zap_imoveis/models/mart/gold_flat_avg_prices.sql
[0m01:04:37.877009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9466da5e-ea8e-40e9-bb13-fd8a41381061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeb903fbac0>]}
[0m01:04:37.877856 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9466da5e-ea8e-40e9-bb13-fd8a41381061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeb8ddacbe0>]}
[0m01:04:37.879155 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model zapimoveis.gold_apartment_avg_prices ...... [[31mERROR[0m in 0.22s]
[0m01:04:37.880576 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model zapimoveis.gold_flat_avg_prices ........... [[31mERROR[0m in 0.23s]
[0m01:04:37.881916 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m01:04:37.883076 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m01:04:37.884305 [debug] [Thread-7 (]: Marking all children of 'model.zap_imoveis.gold_apartment_avg_prices' to be skipped because of status 'error'.  Reason: Database Error in model gold_apartment_avg_prices (models/mart/gold_apartment_avg_prices.sql)
  relation "zap.silver_zapimoveis" does not exist
  LINE 8:     SELECT * FROM "foo"."zap"."silver_zapimoveis" 
                            ^
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_avg_prices.sql.
[0m01:04:37.887086 [debug] [Thread-7 (]: Marking all children of 'model.zap_imoveis.gold_flat_avg_prices' to be skipped because of status 'error'.  Reason: Database Error in model gold_flat_avg_prices (models/mart/gold_flat_avg_prices.sql)
  relation "zap.silver_zapimoveis" does not exist
  LINE 8:     SELECT * FROM "foo"."zap"."silver_zapimoveis" 
                            ^
  compiled code at target/run/zap_imoveis/models/mart/gold_flat_avg_prices.sql.
[0m01:04:37.889400 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:37.890253 [debug] [MainThread]: On master: BEGIN
[0m01:04:37.891033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:04:37.903090 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m01:04:37.904320 [debug] [MainThread]: On master: COMMIT
[0m01:04:37.905299 [debug] [MainThread]: Using postgres connection "master"
[0m01:04:37.906176 [debug] [MainThread]: On master: COMMIT
[0m01:04:37.907541 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:04:37.908460 [debug] [MainThread]: On master: Close
[0m01:04:37.909567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:37.910341 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m01:04:37.911044 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m01:04:37.911878 [info ] [MainThread]: 
[0m01:04:37.912734 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m01:04:37.914555 [debug] [MainThread]: Command end result
[0m01:04:37.955323 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m01:04:37.958422 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m01:04:37.971143 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m01:04:37.971947 [info ] [MainThread]: 
[0m01:04:37.972734 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m01:04:37.973495 [info ] [MainThread]: 
[0m01:04:37.974361 [error] [MainThread]:   Database Error in model gold_apartment_avg_prices (models/mart/gold_apartment_avg_prices.sql)
  relation "zap.silver_zapimoveis" does not exist
  LINE 8:     SELECT * FROM "foo"."zap"."silver_zapimoveis" 
                            ^
  compiled code at target/run/zap_imoveis/models/mart/gold_apartment_avg_prices.sql
[0m01:04:37.975102 [info ] [MainThread]: 
[0m01:04:37.975933 [error] [MainThread]:   Database Error in model gold_flat_avg_prices (models/mart/gold_flat_avg_prices.sql)
  relation "zap.silver_zapimoveis" does not exist
  LINE 8:     SELECT * FROM "foo"."zap"."silver_zapimoveis" 
                            ^
  compiled code at target/run/zap_imoveis/models/mart/gold_flat_avg_prices.sql
[0m01:04:37.976658 [info ] [MainThread]: 
[0m01:04:37.977528 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m01:04:37.979476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7520113, "process_in_blocks": "376", "process_kernel_time": 0.26002, "process_mem_max_rss": "111520", "process_out_blocks": "1800", "process_user_time": 3.663286}
[0m01:04:37.980500 [debug] [MainThread]: Command `dbt run` failed at 01:04:37.980321 after 1.75 seconds
[0m01:04:37.981295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeb90140e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeb8e463d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeb8fffa980>]}
[0m01:04:37.982094 [debug] [MainThread]: Flushing usage events
[0m01:04:43.678847 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:56:36.326177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a041b944dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a041c81e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a041c81e320>]}


============================== 08:56:36.329445 | 6cf1de67-e925-4f04-a3dc-a105ce33462a ==============================
[0m08:56:36.329445 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:56:36.330173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:56:36.541532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cf1de67-e925-4f04-a3dc-a105ce33462a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a041a9de710>]}
[0m08:56:36.617932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cf1de67-e925-4f04-a3dc-a105ce33462a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a041a9dcd60>]}
[0m08:56:36.619027 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:56:36.752824 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:56:36.881952 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m08:56:36.882651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6cf1de67-e925-4f04-a3dc-a105ce33462a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a041b1370a0>]}
[0m08:56:38.171012 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'gold_apartment_rent' in the 'models' section of file 'models/mart/schema.yml'
[0m08:56:38.402029 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of
`model.zap_imoveis.gold_kitnet_rent `
[0m08:56:38.402798 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. Run again with `--debug` to see them all. For
more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m08:56:38.403388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6cf1de67-e925-4f04-a3dc-a105ce33462a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a041b17ec20>]}
[0m08:56:38.404643 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m08:56:38.422530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cf1de67-e925-4f04-a3dc-a105ce33462a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0419781090>]}
[0m08:56:38.527844 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:56:38.531816 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:56:38.544727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cf1de67-e925-4f04-a3dc-a105ce33462a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0419744d30>]}
[0m08:56:38.545484 [info ] [MainThread]: Found 5 models, 1 source, 431 macros
[0m08:56:38.545996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cf1de67-e925-4f04-a3dc-a105ce33462a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a041b0dfc40>]}
[0m08:56:38.548072 [info ] [MainThread]: 
[0m08:56:38.548685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:56:38.549151 [info ] [MainThread]: 
[0m08:56:38.549937 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:56:38.556558 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m08:56:38.602013 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m08:56:38.602828 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m08:56:38.603375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:38.613791 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m08:56:38.615869 [debug] [ThreadPool]: On list_foo: Close
[0m08:56:38.618328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m08:56:38.627410 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:56:38.628073 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m08:56:38.628641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:56:38.636900 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:56:38.637514 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:56:38.638019 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m08:56:38.641245 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m08:56:38.643514 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m08:56:38.644597 [debug] [ThreadPool]: On list_foo_zap: Close
[0m08:56:38.651207 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:38.651833 [debug] [MainThread]: On master: BEGIN
[0m08:56:38.652280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:56:38.661445 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:56:38.662040 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:38.662592 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:56:38.666659 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:56:38.668738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cf1de67-e925-4f04-a3dc-a105ce33462a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a041bdccfd0>]}
[0m08:56:38.669441 [debug] [MainThread]: On master: ROLLBACK
[0m08:56:38.670261 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:38.670875 [debug] [MainThread]: On master: BEGIN
[0m08:56:38.671863 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:56:38.672396 [debug] [MainThread]: On master: COMMIT
[0m08:56:38.672867 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:38.673313 [debug] [MainThread]: On master: COMMIT
[0m08:56:38.674025 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:56:38.674557 [debug] [MainThread]: On master: Close
[0m08:56:38.677613 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m08:56:38.678934 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m08:56:38.680193 [info ] [Thread-1 (]: 1 of 2 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m08:56:38.681050 [info ] [Thread-2 (]: 2 of 2 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m08:56:38.681929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m08:56:38.682753 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m08:56:38.683355 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m08:56:38.683986 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m08:56:38.702106 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:56:38.702695 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m08:56:38.704076 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m08:56:38.704684 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m08:56:38.797701 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m08:56:38.801411 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:56:38.802399 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:56:38.803288 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m08:56:38.804037 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m08:56:38.804659 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m08:56:38.805228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:56:38.805816 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:56:38.814773 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m08:56:38.815509 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:56:38.816124 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m08:56:38.816750 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m08:56:38.817387 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m08:56:38.818154 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m08:56:38.821016 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m08:56:38.827232 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m08:56:38.831531 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:56:38.836956 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m08:56:38.838057 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m08:56:38.839194 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m08:56:38.840737 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:56:38.841417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:56:38.880617 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m08:56:38.881639 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m08:56:38.882438 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m08:56:38.883031 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:56:38.883628 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m08:56:38.884203 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m08:56:38.886237 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m08:56:38.892640 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m08:56:38.902839 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m08:56:38.904719 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m08:56:38.911021 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m08:56:38.912347 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:56:38.912981 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m08:56:38.913598 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m08:56:38.914812 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:56:38.915603 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:56:38.918965 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m08:56:38.921201 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m08:56:38.924546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf1de67-e925-4f04-a3dc-a105ce33462a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0418f2f9d0>]}
[0m08:56:38.925230 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf1de67-e925-4f04-a3dc-a105ce33462a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0419b0cac0>]}
[0m08:56:38.926292 [info ] [Thread-1 (]: 1 of 2 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.24s]
[0m08:56:38.927325 [info ] [Thread-2 (]: 2 of 2 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.24s]
[0m08:56:38.928459 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m08:56:38.930072 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m08:56:38.932816 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:38.933701 [debug] [MainThread]: On master: BEGIN
[0m08:56:38.934335 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:56:38.943960 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m08:56:38.944634 [debug] [MainThread]: On master: COMMIT
[0m08:56:38.945195 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:38.945858 [debug] [MainThread]: On master: COMMIT
[0m08:56:38.946815 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:56:38.947570 [debug] [MainThread]: On master: Close
[0m08:56:38.948484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:56:38.949152 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m08:56:38.949648 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m08:56:38.950479 [info ] [MainThread]: 
[0m08:56:38.951474 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m08:56:38.952835 [debug] [MainThread]: Command end result
[0m08:56:38.981406 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:56:38.983989 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:56:38.993415 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m08:56:38.993979 [info ] [MainThread]: 
[0m08:56:38.994543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:56:38.995031 [info ] [MainThread]: 
[0m08:56:38.995545 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:56:38.996704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.74565, "process_in_blocks": "16", "process_kernel_time": 0.173012, "process_mem_max_rss": "116952", "process_out_blocks": "2632", "process_user_time": 4.025296}
[0m08:56:38.997355 [debug] [MainThread]: Command `dbt run` succeeded at 08:56:38.997232 after 2.75 seconds
[0m08:56:38.997887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a041b944dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a041971e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a041b0dfc40>]}
[0m08:56:38.998427 [debug] [MainThread]: Flushing usage events
[0m08:56:39.774059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:46:30.350375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7195b78e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7196a1e320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7196a1e2c0>]}


============================== 07:46:30.354876 | 5d9f1033-a071-48a2-81b8-bb600eda2980 ==============================
[0m07:46:30.354876 [info ] [MainThread]: Running with dbt=1.9.2
[0m07:46:30.355967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:46:30.658167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d9f1033-a071-48a2-81b8-bb600eda2980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71969cb970>]}
[0m07:46:30.768306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d9f1033-a071-48a2-81b8-bb600eda2980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7194bb46d0>]}
[0m07:46:30.769686 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:46:30.961932 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m07:46:31.184643 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 0 files changed.
[0m07:46:31.185655 [debug] [MainThread]: Partial parsing: added file: zap_imoveis://models/mart/gold_house_avg_prices.sql
[0m07:46:31.186321 [debug] [MainThread]: Partial parsing: deleted file: zap_imoveis://models/mart/gold_house_rent.sql
[0m07:46:31.187007 [debug] [MainThread]: Partial parsing: deleted file: zap_imoveis://models/mart/gold_kitnet_rent .sql
[0m07:46:31.187864 [debug] [MainThread]: Partial parsing: deleted file: zap_imoveis://models/mart/gold_studio_rent.sql
[0m07:46:31.653487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m07:46:31.686455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d9f1033-a071-48a2-81b8-bb600eda2980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7193dc1fc0>]}
[0m07:46:31.843981 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m07:46:31.849566 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m07:46:31.866757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d9f1033-a071-48a2-81b8-bb600eda2980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7193fc80d0>]}
[0m07:46:31.867763 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m07:46:31.868479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d9f1033-a071-48a2-81b8-bb600eda2980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7193fc9150>]}
[0m07:46:31.871349 [info ] [MainThread]: 
[0m07:46:31.872182 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:46:31.872889 [info ] [MainThread]: 
[0m07:46:31.874177 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:46:31.885221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m07:46:31.949394 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m07:46:31.950224 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m07:46:31.950897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:46:31.965799 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.015 seconds
[0m07:46:31.968117 [debug] [ThreadPool]: On list_foo: Close
[0m07:46:31.971107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m07:46:31.983370 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m07:46:31.984165 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m07:46:31.984823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:46:31.996991 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m07:46:31.997804 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m07:46:31.998488 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m07:46:32.004273 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m07:46:32.007802 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m07:46:32.008889 [debug] [ThreadPool]: On list_foo_zap: Close
[0m07:46:32.018650 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:32.019447 [debug] [MainThread]: On master: BEGIN
[0m07:46:32.020095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:46:32.032208 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m07:46:32.033026 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:32.033788 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:46:32.039845 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m07:46:32.042497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d9f1033-a071-48a2-81b8-bb600eda2980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7196e07370>]}
[0m07:46:32.043429 [debug] [MainThread]: On master: ROLLBACK
[0m07:46:32.044494 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:32.045217 [debug] [MainThread]: On master: BEGIN
[0m07:46:32.046350 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:46:32.047086 [debug] [MainThread]: On master: COMMIT
[0m07:46:32.047746 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:32.048379 [debug] [MainThread]: On master: COMMIT
[0m07:46:32.049345 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:46:32.050077 [debug] [MainThread]: On master: Close
[0m07:46:32.053930 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m07:46:32.054875 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m07:46:32.056734 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m07:46:32.058111 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m07:46:32.059647 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m07:46:32.061259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m07:46:32.062382 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m07:46:32.064304 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m07:46:32.065477 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m07:46:32.066841 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m07:46:32.067884 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m07:46:32.079396 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m07:46:32.087217 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m07:46:32.094160 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m07:46:32.164907 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m07:46:32.166872 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m07:46:32.173385 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m07:46:32.190402 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m07:46:32.332912 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m07:46:32.336978 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m07:46:32.339340 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m07:46:32.341578 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m07:46:32.342971 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m07:46:32.343803 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:46:32.344770 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m07:46:32.345948 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m07:46:32.346990 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m07:46:32.347848 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:46:32.348838 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m07:46:32.350082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:46:32.356239 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m07:46:32.357185 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m07:46:32.358211 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m07:46:32.360297 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m07:46:32.361371 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m07:46:32.362410 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Casas para Alugar', 'Casas à Venda', 'Casas de Condomínio para Alugar', 'Casas de Condomínio à Venda')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m07:46:32.363458 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m07:46:32.364365 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m07:46:32.370820 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m07:46:32.379554 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m07:46:32.380569 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m07:46:32.387650 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m07:46:32.388802 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m07:46:32.390104 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m07:46:32.391013 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m07:46:32.392935 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:46:32.393914 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:46:32.405504 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m07:46:32.445622 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m07:46:32.452143 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m07:46:32.460988 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m07:46:32.466729 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m07:46:32.468145 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m07:46:32.469875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:46:32.471035 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m07:46:32.472467 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m07:46:32.475859 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m07:46:32.477069 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m07:46:32.478830 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m07:46:32.479920 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m07:46:32.481261 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m07:46:32.482444 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m07:46:32.489003 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m07:46:32.496770 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m07:46:32.503070 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m07:46:32.508592 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m07:46:32.519163 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m07:46:32.522032 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m07:46:32.525014 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m07:46:32.525924 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m07:46:32.527493 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m07:46:32.529172 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m07:46:32.531343 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:46:32.532284 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:46:32.537024 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m07:46:32.538278 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m07:46:32.541490 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m07:46:32.544436 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m07:46:32.548322 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d9f1033-a071-48a2-81b8-bb600eda2980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f719324ecb0>]}
[0m07:46:32.549732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d9f1033-a071-48a2-81b8-bb600eda2980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7195a314e0>]}
[0m07:46:32.551260 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.48s]
[0m07:46:32.552758 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d9f1033-a071-48a2-81b8-bb600eda2980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7193e292a0>]}
[0m07:46:32.554115 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.49s]
[0m07:46:32.555515 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m07:46:32.556844 [info ] [Thread-2 (]: 2 of 3 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.49s]
[0m07:46:32.558419 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m07:46:32.560088 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m07:46:32.562622 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:32.563468 [debug] [MainThread]: On master: BEGIN
[0m07:46:32.564219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:46:32.576356 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m07:46:32.577196 [debug] [MainThread]: On master: COMMIT
[0m07:46:32.577884 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:32.578514 [debug] [MainThread]: On master: COMMIT
[0m07:46:32.579505 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:46:32.580259 [debug] [MainThread]: On master: Close
[0m07:46:32.581278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:46:32.582016 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m07:46:32.582725 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m07:46:32.583660 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m07:46:32.584634 [info ] [MainThread]: 
[0m07:46:32.585646 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m07:46:32.587847 [debug] [MainThread]: Command end result
[0m07:46:32.629487 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m07:46:32.632385 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m07:46:32.645473 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m07:46:32.646260 [info ] [MainThread]: 
[0m07:46:32.647078 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:46:32.647808 [info ] [MainThread]: 
[0m07:46:32.648525 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:46:32.650198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4043918, "process_in_blocks": "0", "process_kernel_time": 0.247976, "process_mem_max_rss": "115336", "process_out_blocks": "2664", "process_user_time": 4.308589}
[0m07:46:32.651170 [debug] [MainThread]: Command `dbt run` succeeded at 07:46:32.650993 after 2.41 seconds
[0m07:46:32.651916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7195b78e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7193dc3af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7193dc3c10>]}
[0m07:46:32.652700 [debug] [MainThread]: Flushing usage events
[0m07:46:34.438410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:03:47.518618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7104342d4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71043516a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71043516a2c0>]}


============================== 08:03:47.523059 | ce34e6ba-0d3c-4578-aa0d-6a54e7cbb96b ==============================
[0m08:03:47.523059 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:03:47.524126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:03:47.882704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce34e6ba-0d3c-4578-aa0d-6a54e7cbb96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710435117970>]}
[0m08:03:47.980342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce34e6ba-0d3c-4578-aa0d-6a54e7cbb96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7104335ec6d0>]}
[0m08:03:47.981654 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:03:48.138140 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:03:48.390696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m08:03:48.392066 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_flat_avg_prices.sql
[0m08:03:48.393299 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_apartment_avg_prices.sql
[0m08:03:48.394761 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_house_avg_prices.sql
[0m08:03:48.876448 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m08:03:48.901924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce34e6ba-0d3c-4578-aa0d-6a54e7cbb96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7104325e6500>]}
[0m08:03:49.023926 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:03:49.028862 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:03:49.043817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce34e6ba-0d3c-4578-aa0d-6a54e7cbb96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7104325e4d90>]}
[0m08:03:49.044609 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m08:03:49.045224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce34e6ba-0d3c-4578-aa0d-6a54e7cbb96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710433600370>]}
[0m08:03:49.047499 [info ] [MainThread]: 
[0m08:03:49.048256 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:03:49.049102 [info ] [MainThread]: 
[0m08:03:49.050271 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:03:49.058040 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m08:03:49.106996 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m08:03:49.107656 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m08:03:49.108182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:49.121307 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m08:03:49.123427 [debug] [ThreadPool]: On list_foo: Close
[0m08:03:49.126261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m08:03:49.136596 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:03:49.137456 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m08:03:49.138390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:03:49.147850 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m08:03:49.148579 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:03:49.149314 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m08:03:49.153486 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m08:03:49.156494 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m08:03:49.157486 [debug] [ThreadPool]: On list_foo_zap: Close
[0m08:03:49.165218 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:49.166083 [debug] [MainThread]: On master: BEGIN
[0m08:03:49.166747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:03:49.176650 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m08:03:49.177417 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:49.178125 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:03:49.183454 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m08:03:49.187044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce34e6ba-0d3c-4578-aa0d-6a54e7cbb96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710432118880>]}
[0m08:03:49.188063 [debug] [MainThread]: On master: ROLLBACK
[0m08:03:49.189196 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:49.190289 [debug] [MainThread]: On master: BEGIN
[0m08:03:49.191778 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:03:49.192847 [debug] [MainThread]: On master: COMMIT
[0m08:03:49.193600 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:49.194216 [debug] [MainThread]: On master: COMMIT
[0m08:03:49.195247 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:03:49.196011 [debug] [MainThread]: On master: Close
[0m08:03:49.200366 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m08:03:49.201601 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m08:03:49.203084 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m08:03:49.204221 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m08:03:49.207223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m08:03:49.205880 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m08:03:49.208729 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m08:03:49.210204 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m08:03:49.211531 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m08:03:49.212921 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m08:03:49.224461 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m08:03:49.233449 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:03:49.234402 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m08:03:49.241464 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m08:03:49.322830 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m08:03:49.323829 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m08:03:49.340705 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m08:03:49.397623 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m08:03:49.422183 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:03:49.426119 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m08:03:49.428305 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m08:03:49.429688 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m08:03:49.430388 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m08:03:49.431379 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:03:49.432193 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m08:03:49.433021 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m08:03:49.434016 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m08:03:49.434956 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:03:49.435827 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:03:49.436713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:49.446899 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m08:03:49.447962 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m08:03:49.448898 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m08:03:49.449720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m08:03:49.450777 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m08:03:49.452235 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m08:03:49.453791 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:03:49.454957 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Casas para Alugar', 'Casas à Venda', 'Casas de Condomínio para Alugar', 'Casas de Condomínio à Venda')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m08:03:49.455954 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m08:03:49.459321 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m08:03:49.460086 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m08:03:49.460701 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m08:03:49.471249 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m08:03:49.476226 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m08:03:49.481447 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:03:49.482176 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices" rename to "gold_flat_avg_prices__dbt_backup"
[0m08:03:49.482768 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices" rename to "gold_house_avg_prices__dbt_backup"
[0m08:03:49.483355 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m08:03:49.485069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:03:49.485813 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:03:49.486372 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:03:49.490660 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:03:49.496917 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m08:03:49.501382 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m08:03:49.502345 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m08:03:49.503503 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m08:03:49.504123 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m08:03:49.505452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:03:49.506178 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:03:49.533704 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m08:03:49.547660 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m08:03:49.550550 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m08:03:49.554026 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m08:03:49.555042 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m08:03:49.555971 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:03:49.556657 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m08:03:49.557282 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m08:03:49.557862 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m08:03:49.558440 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m08:03:49.561413 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m08:03:49.562200 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m08:03:49.563164 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m08:03:49.572651 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m08:03:49.581533 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m08:03:49.586220 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m08:03:49.597790 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m08:03:49.601533 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m08:03:49.603406 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:03:49.604356 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m08:03:49.605159 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m08:03:49.605891 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m08:03:49.608361 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m08:03:49.609209 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m08:03:49.610088 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m08:03:49.614124 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m08:03:49.617578 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m08:03:49.619878 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m08:03:49.625039 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce34e6ba-0d3c-4578-aa0d-6a54e7cbb96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710431a5eef0>]}
[0m08:03:49.626278 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.41s]
[0m08:03:49.627435 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m08:03:49.628296 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce34e6ba-0d3c-4578-aa0d-6a54e7cbb96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7104345913c0>]}
[0m08:03:49.629032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce34e6ba-0d3c-4578-aa0d-6a54e7cbb96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710431a5f3a0>]}
[0m08:03:49.630295 [info ] [Thread-2 (]: 2 of 3 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.41s]
[0m08:03:49.631878 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.42s]
[0m08:03:49.633535 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m08:03:49.635117 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m08:03:49.637395 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:49.638423 [debug] [MainThread]: On master: BEGIN
[0m08:03:49.639836 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:03:49.652151 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m08:03:49.653110 [debug] [MainThread]: On master: COMMIT
[0m08:03:49.654124 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:49.655098 [debug] [MainThread]: On master: COMMIT
[0m08:03:49.656319 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:03:49.657369 [debug] [MainThread]: On master: Close
[0m08:03:49.659095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:03:49.660240 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m08:03:49.661374 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m08:03:49.662619 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m08:03:49.663920 [info ] [MainThread]: 
[0m08:03:49.665036 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m08:03:49.667570 [debug] [MainThread]: Command end result
[0m08:03:49.700332 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:03:49.702429 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:03:49.712860 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m08:03:49.713472 [info ] [MainThread]: 
[0m08:03:49.714176 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:03:49.714817 [info ] [MainThread]: 
[0m08:03:49.715349 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m08:03:49.716642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3080776, "process_in_blocks": "0", "process_kernel_time": 0.250779, "process_mem_max_rss": "115272", "process_out_blocks": "2656", "process_user_time": 4.479056}
[0m08:03:49.717323 [debug] [MainThread]: Command `dbt run` succeeded at 08:03:49.717214 after 2.31 seconds
[0m08:03:49.717915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7104342d4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7104335ec6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71043194dc00>]}
[0m08:03:49.718672 [debug] [MainThread]: Flushing usage events
[0m08:03:50.445075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:00:43.348125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715eb5978eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715eb681e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715eb681e320>]}


============================== 00:00:43.353382 | 678fac2c-5d38-47c8-b009-e020b1727acc ==============================
[0m00:00:43.353382 [info ] [MainThread]: Running with dbt=1.9.2
[0m00:00:43.354529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:00:43.668047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '678fac2c-5d38-47c8-b009-e020b1727acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715eb49b63b0>]}
[0m00:00:43.779130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '678fac2c-5d38-47c8-b009-e020b1727acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715eb56f87f0>]}
[0m00:00:43.781722 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:00:43.990679 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m00:00:44.242045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:44.242825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:44.255015 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m00:00:44.326354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '678fac2c-5d38-47c8-b009-e020b1727acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715eb3c36a40>]}
[0m00:00:44.489002 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m00:00:44.494739 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m00:00:44.523199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '678fac2c-5d38-47c8-b009-e020b1727acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715eb3dbab60>]}
[0m00:00:44.524245 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m00:00:44.525043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '678fac2c-5d38-47c8-b009-e020b1727acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715eb43b85e0>]}
[0m00:00:44.528061 [info ] [MainThread]: 
[0m00:00:44.528906 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:00:44.529638 [info ] [MainThread]: 
[0m00:00:44.530792 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:00:44.540627 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m00:00:44.615161 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m00:00:44.616103 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m00:00:44.617097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:44.634916 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m00:00:44.637868 [debug] [ThreadPool]: On list_foo: Close
[0m00:00:44.640836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m00:00:44.654014 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m00:00:44.655146 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m00:00:44.656012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:44.669677 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m00:00:44.670775 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m00:00:44.671587 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m00:00:44.679170 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m00:00:44.682827 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m00:00:44.684003 [debug] [ThreadPool]: On list_foo_zap: Close
[0m00:00:44.692958 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:44.693763 [debug] [MainThread]: On master: BEGIN
[0m00:00:44.694441 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:44.707537 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m00:00:44.708474 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:44.709279 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:00:44.715669 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m00:00:44.718403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '678fac2c-5d38-47c8-b009-e020b1727acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715eb3c69e40>]}
[0m00:00:44.719331 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:44.720420 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:44.721176 [debug] [MainThread]: On master: BEGIN
[0m00:00:44.722350 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:00:44.723125 [debug] [MainThread]: On master: COMMIT
[0m00:00:44.723798 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:44.724470 [debug] [MainThread]: On master: COMMIT
[0m00:00:44.725501 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:00:44.726264 [debug] [MainThread]: On master: Close
[0m00:00:44.730503 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m00:00:44.732098 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m00:00:44.732989 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m00:00:44.734037 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m00:00:44.735655 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m00:00:44.737050 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m00:00:44.738230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m00:00:44.739399 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m00:00:44.740646 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m00:00:44.742256 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m00:00:44.743583 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m00:00:44.744682 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m00:00:44.768699 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m00:00:44.770923 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:00:44.777565 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m00:00:44.779118 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m00:00:44.785463 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m00:00:44.786864 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m00:00:44.950294 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m00:00:44.951648 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m00:00:44.956712 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:00:44.958935 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m00:00:44.960131 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m00:00:44.960986 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:00:44.961904 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:00:44.963257 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m00:00:44.964470 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:00:44.965404 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:00:44.966509 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m00:00:44.967730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:44.974757 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m00:00:44.976026 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m00:00:44.977050 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Casas para Alugar', 'Casas à Venda', 'Casas de Condomínio para Alugar', 'Casas de Condomínio à Venda')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m00:00:44.978953 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m00:00:44.979984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m00:00:44.980888 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:00:44.981802 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:00:44.982736 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m00:00:44.983739 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m00:00:44.988476 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m00:00:44.989554 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m00:00:44.996460 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m00:00:45.004957 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:00:45.011975 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m00:00:45.018245 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:00:45.019300 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m00:00:45.020675 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m00:00:45.021696 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m00:00:45.024067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:00:45.025073 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:00:45.025887 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:00:45.097542 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m00:00:45.099337 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m00:00:45.101524 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m00:00:45.102890 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:00:45.104074 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:00:45.105258 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m00:00:45.106109 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m00:00:45.107244 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m00:00:45.108298 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m00:00:45.112014 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m00:00:45.113822 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m00:00:45.115042 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m00:00:45.135053 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m00:00:45.138623 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m00:00:45.202439 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m00:00:45.211769 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:00:45.214810 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:00:45.217866 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m00:00:45.219218 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m00:00:45.220404 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m00:00:45.221851 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m00:00:45.223566 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m00:00:45.224655 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m00:00:45.225518 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m00:00:45.230324 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m00:00:45.232916 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m00:00:45.236218 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m00:00:45.243008 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678fac2c-5d38-47c8-b009-e020b1727acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715eb698eb90>]}
[0m00:00:45.244094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678fac2c-5d38-47c8-b009-e020b1727acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715eb30162c0>]}
[0m00:00:45.245804 [info ] [Thread-2 (]: 2 of 3 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.50s]
[0m00:00:45.246684 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '678fac2c-5d38-47c8-b009-e020b1727acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715eb3017730>]}
[0m00:00:45.248272 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.50s]
[0m00:00:45.249612 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m00:00:45.251505 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.50s]
[0m00:00:45.253062 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m00:00:45.254670 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m00:00:45.258196 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:45.259203 [debug] [MainThread]: On master: BEGIN
[0m00:00:45.260116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:00:45.273366 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m00:00:45.274611 [debug] [MainThread]: On master: COMMIT
[0m00:00:45.276155 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:45.277424 [debug] [MainThread]: On master: COMMIT
[0m00:00:45.279073 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:00:45.280416 [debug] [MainThread]: On master: Close
[0m00:00:45.282067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:45.283414 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m00:00:45.284608 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m00:00:45.285805 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m00:00:45.287337 [info ] [MainThread]: 
[0m00:00:45.288723 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m00:00:45.290970 [debug] [MainThread]: Command end result
[0m00:00:45.330519 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m00:00:45.333716 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m00:00:45.346859 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m00:00:45.347735 [info ] [MainThread]: 
[0m00:00:45.348620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:45.349578 [info ] [MainThread]: 
[0m00:00:45.350408 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:00:45.352081 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1122425, "process_in_blocks": "34776", "process_kernel_time": 0.302501, "process_mem_max_rss": "111808", "process_out_blocks": "1808", "process_user_time": 4.036037}
[0m00:00:45.353009 [debug] [MainThread]: Command `dbt run` succeeded at 00:00:45.352834 after 2.11 seconds
[0m00:00:45.353830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715eb5978eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715eb5832bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715eb5192d70>]}
[0m00:00:45.354861 [debug] [MainThread]: Flushing usage events
[0m00:00:45.363747 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:15:11.367552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6b51d5120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6b606a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6b606a560>]}


============================== 00:15:11.372264 | 01d13268-3c75-4b6c-8a8c-b83789ea2a91 ==============================
[0m00:15:11.372264 [info ] [MainThread]: Running with dbt=1.9.2
[0m00:15:11.373409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:15:11.710508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01d13268-3c75-4b6c-8a8c-b83789ea2a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6b600d630>]}
[0m00:15:11.833347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01d13268-3c75-4b6c-8a8c-b83789ea2a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6b4f5cb20>]}
[0m00:15:11.834855 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m00:15:12.033994 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m00:15:12.278324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:15:12.279219 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:15:12.291414 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m00:15:12.363507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01d13268-3c75-4b6c-8a8c-b83789ea2a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6b3454130>]}
[0m00:15:12.538648 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m00:15:12.545061 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m00:15:12.564107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01d13268-3c75-4b6c-8a8c-b83789ea2a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6b41ad090>]}
[0m00:15:12.565196 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m00:15:12.565978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d13268-3c75-4b6c-8a8c-b83789ea2a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6b583d420>]}
[0m00:15:12.569011 [info ] [MainThread]: 
[0m00:15:12.569902 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:15:12.570644 [info ] [MainThread]: 
[0m00:15:12.571722 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:15:12.581203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m00:15:12.651316 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m00:15:12.652219 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m00:15:12.652942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:15:12.667431 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m00:15:12.669893 [debug] [ThreadPool]: On list_foo: Close
[0m00:15:12.673208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m00:15:12.686524 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m00:15:12.687397 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m00:15:12.688127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:15:12.699663 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m00:15:12.700543 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m00:15:12.701304 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m00:15:12.705620 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m00:15:12.708425 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m00:15:12.709924 [debug] [ThreadPool]: On list_foo_zap: Close
[0m00:15:12.720389 [debug] [MainThread]: Using postgres connection "master"
[0m00:15:12.721291 [debug] [MainThread]: On master: BEGIN
[0m00:15:12.722042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:15:12.733723 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m00:15:12.734594 [debug] [MainThread]: Using postgres connection "master"
[0m00:15:12.735436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:15:12.741591 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m00:15:12.745797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d13268-3c75-4b6c-8a8c-b83789ea2a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6b3485a80>]}
[0m00:15:12.746780 [debug] [MainThread]: On master: ROLLBACK
[0m00:15:12.747847 [debug] [MainThread]: Using postgres connection "master"
[0m00:15:12.748640 [debug] [MainThread]: On master: BEGIN
[0m00:15:12.749759 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:15:12.750535 [debug] [MainThread]: On master: COMMIT
[0m00:15:12.751265 [debug] [MainThread]: Using postgres connection "master"
[0m00:15:12.751971 [debug] [MainThread]: On master: COMMIT
[0m00:15:12.752932 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:15:12.753691 [debug] [MainThread]: On master: Close
[0m00:15:12.758591 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m00:15:12.760162 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m00:15:12.761624 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m00:15:12.762829 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m00:15:12.764193 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m00:15:12.765821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m00:15:12.767053 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m00:15:12.768899 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m00:15:12.770182 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m00:15:12.771902 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m00:15:12.772807 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m00:15:12.784537 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m00:15:12.794058 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:15:12.801111 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m00:15:12.808150 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m00:15:12.810598 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m00:15:12.811854 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m00:15:12.818373 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m00:15:13.048351 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:15:13.050432 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m00:15:13.051990 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m00:15:13.054738 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:15:13.055844 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:15:13.056757 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m00:15:13.057773 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m00:15:13.059019 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m00:15:13.060414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:13.062268 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m00:15:13.063307 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:15:13.064635 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:15:13.076608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m00:15:13.077980 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m00:15:13.079029 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:15:13.079908 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m00:15:13.081102 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:15:13.082224 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m00:15:13.083183 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m00:15:13.084138 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m00:15:13.085757 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Casas para Alugar', 'Casas à Venda', 'Casas de Condomínio para Alugar', 'Casas de Condomínio à Venda')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m00:15:13.089489 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m00:15:13.091108 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m00:15:13.092528 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m00:15:13.112296 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:15:13.115579 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:15:13.124014 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m00:15:13.125147 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m00:15:13.126300 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices" rename to "gold_flat_avg_prices__dbt_backup"
[0m00:15:13.127502 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices" rename to "gold_house_avg_prices__dbt_backup"
[0m00:15:13.129649 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:15:13.130789 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:15:13.131832 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:15:13.138679 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:15:13.146267 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:15:13.154055 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m00:15:13.155003 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m00:15:13.156206 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m00:15:13.157280 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m00:15:13.159513 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:15:13.160793 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:15:13.161789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m00:15:13.319247 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m00:15:13.315197 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m00:15:13.324248 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m00:15:13.325660 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:15:13.326829 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m00:15:13.328155 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:15:13.329283 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m00:15:13.330212 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m00:15:13.331536 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m00:15:13.335264 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m00:15:13.336302 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m00:15:13.337195 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m00:15:13.366383 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m00:15:13.368054 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m00:15:13.371030 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m00:15:13.385613 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m00:15:13.388494 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m00:15:13.393007 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m00:15:13.394511 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m00:15:13.395670 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m00:15:13.396711 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m00:15:13.401484 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m00:15:13.403139 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m00:15:13.404051 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m00:15:13.409328 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m00:15:13.412615 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m00:15:13.415597 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m00:15:13.421615 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d13268-3c75-4b6c-8a8c-b83789ea2a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6b2d9ef50>]}
[0m00:15:13.422588 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d13268-3c75-4b6c-8a8c-b83789ea2a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6b2d9f2b0>]}
[0m00:15:13.423607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d13268-3c75-4b6c-8a8c-b83789ea2a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6b29ce080>]}
[0m00:15:13.425480 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.65s]
[0m00:15:13.427250 [info ] [Thread-2 (]: 2 of 3 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.65s]
[0m00:15:13.429083 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.66s]
[0m00:15:13.430746 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m00:15:13.432298 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m00:15:13.433721 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m00:15:13.436674 [debug] [MainThread]: Using postgres connection "master"
[0m00:15:13.437535 [debug] [MainThread]: On master: BEGIN
[0m00:15:13.438246 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:15:13.450922 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m00:15:13.451795 [debug] [MainThread]: On master: COMMIT
[0m00:15:13.452539 [debug] [MainThread]: Using postgres connection "master"
[0m00:15:13.453244 [debug] [MainThread]: On master: COMMIT
[0m00:15:13.454350 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:15:13.455206 [debug] [MainThread]: On master: Close
[0m00:15:13.456284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:15:13.457081 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m00:15:13.457994 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m00:15:13.458837 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m00:15:13.459956 [info ] [MainThread]: 
[0m00:15:13.461168 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m00:15:13.463416 [debug] [MainThread]: Command end result
[0m00:15:13.504048 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m00:15:13.507102 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m00:15:13.520813 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m00:15:13.521661 [info ] [MainThread]: 
[0m00:15:13.522625 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:15:13.523492 [info ] [MainThread]: 
[0m00:15:13.524665 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:15:13.527304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.276326, "process_in_blocks": "0", "process_kernel_time": 0.287191, "process_mem_max_rss": "112108", "process_out_blocks": "1816", "process_user_time": 4.394924}
[0m00:15:13.528900 [debug] [MainThread]: Command `dbt run` succeeded at 00:15:13.528593 after 2.28 seconds
[0m00:15:13.530103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6b51d5120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6b4845ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f6b299bc70>]}
[0m00:15:13.531355 [debug] [MainThread]: Flushing usage events
[0m00:15:14.830209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:11:28.939810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7822379d5120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78223886a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78223886a560>]}


============================== 08:11:28.944430 | d4ac294a-2d18-4a82-bc82-b979d630dbdc ==============================
[0m08:11:28.944430 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:11:28.945861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:11:29.210997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4ac294a-2d18-4a82-bc82-b979d630dbdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78223880d630>]}
[0m08:11:29.301311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4ac294a-2d18-4a82-bc82-b979d630dbdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78223775cb20>]}
[0m08:11:29.303593 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:11:29.446027 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:11:29.625249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:11:29.625853 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:11:29.635018 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m08:11:29.683151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4ac294a-2d18-4a82-bc82-b979d630dbdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782235c54130>]}
[0m08:11:29.805767 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:11:29.810020 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:11:29.837429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4ac294a-2d18-4a82-bc82-b979d630dbdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7822369ad090>]}
[0m08:11:29.838232 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m08:11:29.838864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4ac294a-2d18-4a82-bc82-b979d630dbdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78223803d420>]}
[0m08:11:29.841043 [info ] [MainThread]: 
[0m08:11:29.841693 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:11:29.842250 [info ] [MainThread]: 
[0m08:11:29.843044 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:11:29.850965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m08:11:29.910466 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m08:11:29.911367 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m08:11:29.912258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:11:29.925574 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m08:11:29.928286 [debug] [ThreadPool]: On list_foo: Close
[0m08:11:29.931175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m08:11:29.941325 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:11:29.941962 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m08:11:29.942453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:11:29.952556 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m08:11:29.953277 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:11:29.953818 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m08:11:29.965911 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m08:11:29.968237 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m08:11:29.969159 [debug] [ThreadPool]: On list_foo_zap: Close
[0m08:11:29.977087 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:29.978386 [debug] [MainThread]: On master: BEGIN
[0m08:11:29.979399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:11:29.988789 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:11:29.989429 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:29.989989 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:11:29.995862 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m08:11:29.998271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4ac294a-2d18-4a82-bc82-b979d630dbdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782235ca0940>]}
[0m08:11:29.999149 [debug] [MainThread]: On master: ROLLBACK
[0m08:11:30.000009 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:30.001001 [debug] [MainThread]: On master: BEGIN
[0m08:11:30.002576 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:11:30.003244 [debug] [MainThread]: On master: COMMIT
[0m08:11:30.003731 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:30.004207 [debug] [MainThread]: On master: COMMIT
[0m08:11:30.004987 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:11:30.005535 [debug] [MainThread]: On master: Close
[0m08:11:30.008445 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m08:11:30.009194 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m08:11:30.009864 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m08:11:30.010889 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m08:11:30.012275 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m08:11:30.013674 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m08:11:30.014873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m08:11:30.016124 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m08:11:30.017125 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m08:11:30.017960 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m08:11:30.019120 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m08:11:30.019982 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m08:11:30.038008 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:11:30.035187 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m08:11:30.043525 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m08:11:30.045478 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m08:11:30.051979 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m08:11:30.073371 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m08:11:30.198146 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m08:11:30.200803 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:11:30.204743 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m08:11:30.206555 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:11:30.207295 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m08:11:30.207905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:11:30.208748 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m08:11:30.210279 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m08:11:30.211825 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m08:11:30.212999 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:11:30.214138 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m08:11:30.215485 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:11:30.220696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m08:11:30.221875 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:11:30.222831 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m08:11:30.225680 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m08:11:30.226559 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m08:11:30.227548 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m08:11:30.228904 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m08:11:30.230132 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Casas para Alugar', 'Casas à Venda', 'Casas de Condomínio para Alugar', 'Casas de Condomínio à Venda')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m08:11:30.231373 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m08:11:30.233735 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m08:11:30.240604 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m08:11:30.241819 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m08:11:30.246368 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:11:30.252374 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m08:11:30.258495 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m08:11:30.259379 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m08:11:30.260598 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m08:11:30.261533 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m08:11:30.263511 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:11:30.264829 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:11:30.265761 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m08:11:30.307080 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m08:11:30.310027 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m08:11:30.303217 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m08:11:30.312002 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:11:30.313224 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m08:11:30.314504 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m08:11:30.315496 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m08:11:30.316359 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m08:11:30.317390 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m08:11:30.320614 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:11:30.326708 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m08:11:30.337920 [debug] [Thread-3 (]: SQL status: COMMIT in 0.020 seconds
[0m08:11:30.338962 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m08:11:30.337248 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m08:11:30.406725 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m08:11:30.415501 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m08:11:30.417548 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m08:11:30.419353 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m08:11:30.420614 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m08:11:30.421542 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m08:11:30.422364 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m08:11:30.423695 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:11:30.424401 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m08:11:30.424983 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m08:11:30.428959 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m08:11:30.432409 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m08:11:30.434601 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m08:11:30.440854 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ac294a-2d18-4a82-bc82-b979d630dbdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7822355a33a0>]}
[0m08:11:30.441709 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ac294a-2d18-4a82-bc82-b979d630dbdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7822355a0550>]}
[0m08:11:30.442462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ac294a-2d18-4a82-bc82-b979d630dbdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78223504d4e0>]}
[0m08:11:30.443508 [info ] [Thread-2 (]: 2 of 3 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.42s]
[0m08:11:30.445369 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.42s]
[0m08:11:30.447301 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.42s]
[0m08:11:30.449003 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m08:11:30.450144 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m08:11:30.451072 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m08:11:30.453079 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:30.453783 [debug] [MainThread]: On master: BEGIN
[0m08:11:30.454419 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:11:30.463874 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:11:30.464918 [debug] [MainThread]: On master: COMMIT
[0m08:11:30.465681 [debug] [MainThread]: Using postgres connection "master"
[0m08:11:30.466305 [debug] [MainThread]: On master: COMMIT
[0m08:11:30.467196 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:11:30.467833 [debug] [MainThread]: On master: Close
[0m08:11:30.468644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:11:30.469294 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m08:11:30.470220 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m08:11:30.471107 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m08:11:30.471843 [info ] [MainThread]: 
[0m08:11:30.472430 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m08:11:30.473718 [debug] [MainThread]: Command end result
[0m08:11:30.503830 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:11:30.506106 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:11:30.517947 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m08:11:30.518878 [info ] [MainThread]: 
[0m08:11:30.519914 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:11:30.520846 [info ] [MainThread]: 
[0m08:11:30.521636 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m08:11:30.523137 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6789919, "process_in_blocks": "34640", "process_kernel_time": 0.260523, "process_mem_max_rss": "111524", "process_out_blocks": "1808", "process_user_time": 3.238941}
[0m08:11:30.523912 [debug] [MainThread]: Command `dbt run` succeeded at 08:11:30.523775 after 1.68 seconds
[0m08:11:30.524683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7822379d5120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78223775cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78223788b5e0>]}
[0m08:11:30.525381 [debug] [MainThread]: Flushing usage events
[0m08:11:31.644027 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:17:38.576233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c3d27d060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c3e122500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c3e1224a0>]}


============================== 01:17:38.581681 | c7c5a06c-7796-46d0-91b2-7cafa5534ac8 ==============================
[0m01:17:38.581681 [info ] [MainThread]: Running with dbt=1.9.2
[0m01:17:38.582613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:17:38.842403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7c5a06c-7796-46d0-91b2-7cafa5534ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c3e0c71c0>]}
[0m01:17:38.936506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7c5a06c-7796-46d0-91b2-7cafa5534ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c3e1047f0>]}
[0m01:17:38.938926 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m01:17:39.104048 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m01:17:39.305929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:17:39.306597 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:17:39.316520 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m01:17:39.369380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7c5a06c-7796-46d0-91b2-7cafa5534ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c3b53c130>]}
[0m01:17:39.494980 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m01:17:39.499667 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m01:17:39.527648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7c5a06c-7796-46d0-91b2-7cafa5534ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c3b52c400>]}
[0m01:17:39.528932 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m01:17:39.529727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c5a06c-7796-46d0-91b2-7cafa5534ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c3d6e08e0>]}
[0m01:17:39.532226 [info ] [MainThread]: 
[0m01:17:39.533085 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:17:39.533685 [info ] [MainThread]: 
[0m01:17:39.534550 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:17:39.541333 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m01:17:39.600459 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m01:17:39.601166 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m01:17:39.601684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:39.614837 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m01:17:39.616711 [debug] [ThreadPool]: On list_foo: Close
[0m01:17:39.619309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m01:17:39.629534 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m01:17:39.630233 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m01:17:39.630741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:39.639764 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:17:39.640435 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m01:17:39.640962 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m01:17:39.653832 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m01:17:39.656727 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m01:17:39.657635 [debug] [ThreadPool]: On list_foo_zap: Close
[0m01:17:39.666106 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:39.666768 [debug] [MainThread]: On master: BEGIN
[0m01:17:39.667314 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:17:39.678063 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m01:17:39.678888 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:39.679537 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:17:39.684759 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m01:17:39.687487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c5a06c-7796-46d0-91b2-7cafa5534ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c3b571ba0>]}
[0m01:17:39.688266 [debug] [MainThread]: On master: ROLLBACK
[0m01:17:39.689155 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:39.689735 [debug] [MainThread]: On master: BEGIN
[0m01:17:39.690776 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:17:39.691431 [debug] [MainThread]: On master: COMMIT
[0m01:17:39.692165 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:39.692840 [debug] [MainThread]: On master: COMMIT
[0m01:17:39.693934 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:17:39.694951 [debug] [MainThread]: On master: Close
[0m01:17:39.698421 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m01:17:39.699357 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m01:17:39.700237 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m01:17:39.701045 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m01:17:39.701879 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m01:17:39.702826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m01:17:39.703981 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m01:17:39.704957 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m01:17:39.705920 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m01:17:39.706787 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m01:17:39.707798 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m01:17:39.719230 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m01:17:39.722244 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:17:39.729221 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m01:17:39.734570 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m01:17:39.736156 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m01:17:39.737282 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m01:17:39.771492 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m01:17:39.878727 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m01:17:39.883039 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:17:39.884307 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m01:17:39.886542 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:17:39.887617 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m01:17:39.888210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:39.889041 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m01:17:39.889739 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m01:17:39.890408 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:17:39.891263 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:17:39.892540 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m01:17:39.893659 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:17:39.898284 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:17:39.899041 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:17:39.900117 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m01:17:39.901613 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m01:17:39.902457 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m01:17:39.903358 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Casas para Alugar', 'Casas à Venda', 'Casas de Condomínio para Alugar', 'Casas de Condomínio à Venda')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m01:17:39.904299 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m01:17:39.905380 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:17:39.906254 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Flats à Venda', 'Flats para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m01:17:39.907988 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m01:17:39.909259 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m01:17:39.915604 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m01:17:39.920690 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:17:39.926892 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m01:17:39.932103 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:17:39.933248 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m01:17:39.934690 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m01:17:39.935958 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m01:17:39.937504 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:39.938268 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:17:39.944664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m01:17:39.966643 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m01:17:39.972316 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m01:17:39.976962 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m01:17:39.977911 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:17:39.978873 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m01:17:39.979627 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:17:39.980331 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m01:17:39.980976 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m01:17:39.981605 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m01:17:39.983773 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m01:17:39.984531 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m01:17:39.990406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m01:17:39.995449 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m01:17:39.999634 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m01:17:40.005012 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m01:17:40.013601 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m01:17:40.015279 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m01:17:40.017390 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m01:17:40.018345 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m01:17:40.019559 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m01:17:40.020235 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m01:17:40.021658 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m01:17:40.022447 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:17:40.026344 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m01:17:40.027208 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m01:17:40.029920 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m01:17:40.032994 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m01:17:40.037606 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c5a06c-7796-46d0-91b2-7cafa5534ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c3ae96f50>]}
[0m01:17:40.038363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c5a06c-7796-46d0-91b2-7cafa5534ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c3ae97400>]}
[0m01:17:40.039481 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.33s]
[0m01:17:40.040400 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c5a06c-7796-46d0-91b2-7cafa5534ac8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c3ada20e0>]}
[0m01:17:40.042403 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.33s]
[0m01:17:40.044396 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m01:17:40.045928 [info ] [Thread-2 (]: 2 of 3 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.33s]
[0m01:17:40.047478 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m01:17:40.048673 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m01:17:40.050602 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:40.051260 [debug] [MainThread]: On master: BEGIN
[0m01:17:40.051759 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:17:40.060676 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:17:40.061552 [debug] [MainThread]: On master: COMMIT
[0m01:17:40.062209 [debug] [MainThread]: Using postgres connection "master"
[0m01:17:40.062745 [debug] [MainThread]: On master: COMMIT
[0m01:17:40.063507 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:17:40.064091 [debug] [MainThread]: On master: Close
[0m01:17:40.064992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:40.065807 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m01:17:40.066569 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m01:17:40.067265 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m01:17:40.068138 [info ] [MainThread]: 
[0m01:17:40.068757 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m01:17:40.070282 [debug] [MainThread]: Command end result
[0m01:17:40.165132 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m01:17:40.167455 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m01:17:40.177608 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m01:17:40.178438 [info ] [MainThread]: 
[0m01:17:40.179219 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:17:40.179885 [info ] [MainThread]: 
[0m01:17:40.180601 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m01:17:40.181950 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6941477, "process_in_blocks": "35312", "process_kernel_time": 0.263796, "process_mem_max_rss": "111728", "process_out_blocks": "1808", "process_user_time": 3.167567}
[0m01:17:40.182693 [debug] [MainThread]: Command `dbt run` succeeded at 01:17:40.182576 after 1.70 seconds
[0m01:17:40.183293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c3d27d060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c3b567910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779c3a929840>]}
[0m01:17:40.183889 [debug] [MainThread]: Flushing usage events
[0m01:17:40.188989 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:48:22.881342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795e7a460e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795e7b3362c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795e7b336260>]}


============================== 17:48:22.885894 | aa1bf4cd-491f-4de1-b55b-ffb9a5bde53c ==============================
[0m17:48:22.885894 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:48:22.887130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:48:23.201095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa1bf4cd-491f-4de1-b55b-ffb9a5bde53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795e7978d5a0>]}
[0m17:48:23.323165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa1bf4cd-491f-4de1-b55b-ffb9a5bde53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795e79b77b50>]}
[0m17:48:23.324583 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:48:23.525765 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:48:23.748729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:48:23.749884 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_flat_avg_prices.sql
[0m17:48:24.230061 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m17:48:24.264175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa1bf4cd-491f-4de1-b55b-ffb9a5bde53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795e786de1d0>]}
[0m17:48:24.420620 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m17:48:24.426377 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m17:48:24.443751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa1bf4cd-491f-4de1-b55b-ffb9a5bde53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795e78bec400>]}
[0m17:48:24.444779 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m17:48:24.445548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa1bf4cd-491f-4de1-b55b-ffb9a5bde53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795e78bef040>]}
[0m17:48:24.448491 [info ] [MainThread]: 
[0m17:48:24.449353 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:48:24.450078 [info ] [MainThread]: 
[0m17:48:24.451319 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:48:24.462446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m17:48:24.527892 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m17:48:24.528793 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m17:48:24.529524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:24.543445 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m17:48:24.546642 [debug] [ThreadPool]: On list_foo: Close
[0m17:48:24.550099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m17:48:24.563010 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:48:24.563812 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m17:48:24.564482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:24.576548 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m17:48:24.577380 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:48:24.578092 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m17:48:24.582465 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m17:48:24.586282 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m17:48:24.587415 [debug] [ThreadPool]: On list_foo_zap: Close
[0m17:48:24.598309 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:24.599138 [debug] [MainThread]: On master: BEGIN
[0m17:48:24.599786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:24.612907 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m17:48:24.613745 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:24.614536 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:48:24.621707 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m17:48:24.625819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa1bf4cd-491f-4de1-b55b-ffb9a5bde53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795e797785b0>]}
[0m17:48:24.626739 [debug] [MainThread]: On master: ROLLBACK
[0m17:48:24.627855 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:24.628606 [debug] [MainThread]: On master: BEGIN
[0m17:48:24.629820 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:48:24.630593 [debug] [MainThread]: On master: COMMIT
[0m17:48:24.631298 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:24.631958 [debug] [MainThread]: On master: COMMIT
[0m17:48:24.632990 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:48:24.633727 [debug] [MainThread]: On master: Close
[0m17:48:24.637684 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m17:48:24.638685 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m17:48:24.639803 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m17:48:24.641121 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m17:48:24.642370 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m17:48:24.643734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m17:48:24.645225 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m17:48:24.647500 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m17:48:24.648631 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m17:48:24.649971 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m17:48:24.651011 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m17:48:24.662545 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m17:48:24.669080 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:48:24.675432 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m17:48:24.746485 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m17:48:24.748132 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m17:48:24.749148 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m17:48:24.750093 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m17:48:24.972533 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:48:24.969520 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m17:48:24.980787 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m17:48:24.982352 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:48:24.983409 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m17:48:24.984435 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:48:24.985244 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:48:24.986106 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:48:24.986994 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m17:48:24.988240 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m17:48:24.989339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:24.990760 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:48:25.000898 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m17:48:25.002256 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:48:25.004047 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 
	'Flats%' OR 'Studios%' OR 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:48:25.005812 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m17:48:25.006850 [debug] [Thread-2 (]: Postgres adapter: Postgres error: invalid input syntax for type boolean: "Studios%"
LINE 10:  'Flats%' OR 'Studios%' OR 'Kitnets'
                      ^

[0m17:48:25.007725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m17:48:25.008819 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:48:25.009953 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: ROLLBACK
[0m17:48:25.011211 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:48:25.012715 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Casas para Alugar', 'Casas à Venda', 'Casas de Condomínio para Alugar', 'Casas de Condomínio à Venda')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:48:25.013828 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:48:25.015600 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m17:48:25.020219 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m17:48:25.034138 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:48:25.035337 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m17:48:25.036201 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices" rename to "gold_house_avg_prices__dbt_backup"
[0m17:48:25.044483 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:48:25.045728 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m17:48:25.046757 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:48:25.054264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m17:48:25.055497 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:48:25.062828 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:48:25.063755 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m17:48:25.064676 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m17:48:25.067096 [debug] [Thread-2 (]: Database Error in model gold_flat_avg_prices (models/mart/gold_flat_avg_prices.sql)
  invalid input syntax for type boolean: "Studios%"
  LINE 10:  'Flats%' OR 'Studios%' OR 'Kitnets'
                        ^
  compiled code at target/run/zap_imoveis/models/mart/gold_flat_avg_prices.sql
[0m17:48:25.068134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:48:25.071743 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa1bf4cd-491f-4de1-b55b-ffb9a5bde53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795e77b73250>]}
[0m17:48:25.072954 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m17:48:25.085617 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model zap.gold_flat_avg_prices .................. [[31mERROR[0m in 0.42s]
[0m17:48:25.118580 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m17:48:25.130510 [debug] [Thread-7 (]: Marking all children of 'model.zap_imoveis.gold_flat_avg_prices' to be skipped because of status 'error'.  Reason: Database Error in model gold_flat_avg_prices (models/mart/gold_flat_avg_prices.sql)
  invalid input syntax for type boolean: "Studios%"
  LINE 10:  'Flats%' OR 'Studios%' OR 'Kitnets'
                        ^
  compiled code at target/run/zap_imoveis/models/mart/gold_flat_avg_prices.sql.
[0m17:48:25.133200 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m17:48:25.135975 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m17:48:25.138440 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:48:25.139392 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:48:25.141003 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m17:48:25.142099 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m17:48:25.144617 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m17:48:25.145708 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:48:25.165084 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m17:48:25.176520 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m17:48:25.181834 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:48:25.184722 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:48:25.185791 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m17:48:25.187070 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m17:48:25.191300 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:48:25.193069 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:48:25.198119 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m17:48:25.201144 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m17:48:25.202977 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa1bf4cd-491f-4de1-b55b-ffb9a5bde53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795e7b486b00>]}
[0m17:48:25.204786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa1bf4cd-491f-4de1-b55b-ffb9a5bde53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795e78b8fd30>]}
[0m17:48:25.206410 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.55s]
[0m17:48:25.208011 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.56s]
[0m17:48:25.209455 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m17:48:25.210626 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m17:48:25.213296 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:25.214324 [debug] [MainThread]: On master: BEGIN
[0m17:48:25.215187 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:48:25.228329 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m17:48:25.229545 [debug] [MainThread]: On master: COMMIT
[0m17:48:25.230466 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:25.231482 [debug] [MainThread]: On master: COMMIT
[0m17:48:25.232752 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:48:25.233612 [debug] [MainThread]: On master: Close
[0m17:48:25.234710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:25.235504 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m17:48:25.236203 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m17:48:25.236875 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m17:48:25.237745 [info ] [MainThread]: 
[0m17:48:25.238554 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m17:48:25.240564 [debug] [MainThread]: Command end result
[0m17:48:25.281153 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m17:48:25.284288 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m17:48:25.297079 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m17:48:25.297900 [info ] [MainThread]: 
[0m17:48:25.298698 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:48:25.299459 [info ] [MainThread]: 
[0m17:48:25.300384 [error] [MainThread]:   Database Error in model gold_flat_avg_prices (models/mart/gold_flat_avg_prices.sql)
  invalid input syntax for type boolean: "Studios%"
  LINE 10:  'Flats%' OR 'Studios%' OR 'Kitnets'
                        ^
  compiled code at target/run/zap_imoveis/models/mart/gold_flat_avg_prices.sql
[0m17:48:25.301157 [info ] [MainThread]: 
[0m17:48:25.301906 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:48:25.303591 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5286307, "process_in_blocks": "856", "process_kernel_time": 0.285937, "process_mem_max_rss": "115756", "process_out_blocks": "2656", "process_user_time": 4.452022}
[0m17:48:25.304668 [debug] [MainThread]: Command `dbt run` failed at 17:48:25.304423 after 2.53 seconds
[0m17:48:25.305632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795e7a460e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795e7876bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x795e7b2a6590>]}
[0m17:48:25.306495 [debug] [MainThread]: Flushing usage events
[0m17:48:31.995118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:49:51.727694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2a648df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2b4ee3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2b4ee350>]}


============================== 17:49:51.732336 | 48d5611a-eb9d-4582-b04c-1a9cf4dd8119 ==============================
[0m17:49:51.732336 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:49:51.733627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:49:52.040451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48d5611a-eb9d-4582-b04c-1a9cf4dd8119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2b65f7f0>]}
[0m17:49:52.151066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48d5611a-eb9d-4582-b04c-1a9cf4dd8119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2a3c93f0>]}
[0m17:49:52.152483 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:49:52.358622 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:49:52.581278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:52.582071 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:52.593949 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m17:49:52.663700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48d5611a-eb9d-4582-b04c-1a9cf4dd8119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2883e980>]}
[0m17:49:52.824061 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m17:49:52.829689 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m17:49:52.847178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48d5611a-eb9d-4582-b04c-1a9cf4dd8119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de289d2410>]}
[0m17:49:52.848219 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m17:49:52.848986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48d5611a-eb9d-4582-b04c-1a9cf4dd8119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de289d1a20>]}
[0m17:49:52.851946 [info ] [MainThread]: 
[0m17:49:52.852757 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:49:52.853466 [info ] [MainThread]: 
[0m17:49:52.854530 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:49:52.865047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m17:49:52.932492 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m17:49:52.933340 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m17:49:52.934137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:52.949190 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m17:49:52.951574 [debug] [ThreadPool]: On list_foo: Close
[0m17:49:52.955205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m17:49:52.967869 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:49:52.968762 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m17:49:52.969508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:52.981292 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m17:49:52.982124 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:49:52.982812 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m17:49:52.988445 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m17:49:52.991241 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m17:49:52.992404 [debug] [ThreadPool]: On list_foo_zap: Close
[0m17:49:53.003803 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:53.004651 [debug] [MainThread]: On master: BEGIN
[0m17:49:53.005309 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:53.018295 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m17:49:53.019185 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:53.020014 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:49:53.026257 [debug] [MainThread]: SQL status: SELECT 3 in 0.005 seconds
[0m17:49:53.029755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48d5611a-eb9d-4582-b04c-1a9cf4dd8119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2b4dc4c0>]}
[0m17:49:53.030676 [debug] [MainThread]: On master: ROLLBACK
[0m17:49:53.031786 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:53.032536 [debug] [MainThread]: On master: BEGIN
[0m17:49:53.033745 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:49:53.034504 [debug] [MainThread]: On master: COMMIT
[0m17:49:53.035191 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:53.035838 [debug] [MainThread]: On master: COMMIT
[0m17:49:53.036873 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:49:53.037659 [debug] [MainThread]: On master: Close
[0m17:49:53.041696 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m17:49:53.042719 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m17:49:53.043837 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m17:49:53.045148 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m17:49:53.046313 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m17:49:53.047503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m17:49:53.049207 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m17:49:53.051066 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m17:49:53.052546 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m17:49:53.053972 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m17:49:53.055072 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m17:49:53.066799 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m17:49:53.074522 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:49:53.081581 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m17:49:53.088091 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m17:49:53.089982 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m17:49:53.090972 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m17:49:53.097452 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m17:49:53.300186 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m17:49:53.304749 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m17:49:53.307946 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:49:53.310143 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:49:53.311993 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:49:53.312828 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m17:49:53.313884 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:49:53.314709 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m17:49:53.315565 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:49:53.316762 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m17:49:53.318074 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:49:53.319306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:53.329718 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m17:49:53.330884 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:49:53.331888 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m17:49:53.332834 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 
	'Flats%' OR 'Studios%' OR 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:49:53.333899 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:49:53.335460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:49:53.336657 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Casas para Alugar', 'Casas à Venda', 'Casas de Condomínio para Alugar', 'Casas de Condomínio à Venda')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:49:53.337822 [debug] [Thread-2 (]: Postgres adapter: Postgres error: invalid input syntax for type boolean: "Studios%"
LINE 10:  'Flats%' OR 'Studios%' OR 'Kitnets'
                      ^

[0m17:49:53.338754 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:49:53.340083 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: ROLLBACK
[0m17:49:53.341236 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:49:53.343098 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m17:49:53.344451 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m17:49:53.350765 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m17:49:53.366486 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:49:53.370950 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:49:53.372459 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices" rename to "gold_house_avg_prices__dbt_backup"
[0m17:49:53.373794 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m17:49:53.376584 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:49:53.378130 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:49:53.384845 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:49:53.386500 [debug] [Thread-2 (]: Database Error in model gold_flat_avg_prices (models/mart/gold_flat_avg_prices.sql)
  invalid input syntax for type boolean: "Studios%"
  LINE 10:  'Flats%' OR 'Studios%' OR 'Kitnets'
                        ^
  compiled code at target/run/zap_imoveis/models/mart/gold_flat_avg_prices.sql
[0m17:49:53.393286 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:49:53.394407 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m17:49:53.398943 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48d5611a-eb9d-4582-b04c-1a9cf4dd8119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de27d97010>]}
[0m17:49:53.400073 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m17:49:53.402241 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model zap.gold_flat_avg_prices .................. [[31mERROR[0m in 0.35s]
[0m17:49:53.403288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:49:53.404742 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m17:49:53.405704 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:49:53.427945 [debug] [Thread-7 (]: Marking all children of 'model.zap_imoveis.gold_flat_avg_prices' to be skipped because of status 'error'.  Reason: Database Error in model gold_flat_avg_prices (models/mart/gold_flat_avg_prices.sql)
  invalid input syntax for type boolean: "Studios%"
  LINE 10:  'Flats%' OR 'Studios%' OR 'Kitnets'
                        ^
  compiled code at target/run/zap_imoveis/models/mart/gold_flat_avg_prices.sql.
[0m17:49:53.478101 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m17:49:53.474611 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m17:49:53.479349 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:49:53.480233 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:49:53.481104 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m17:49:53.481975 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m17:49:53.485484 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m17:49:53.486814 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:49:53.562854 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m17:49:53.571471 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m17:49:53.575703 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:49:53.578572 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:49:53.579758 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m17:49:53.580935 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m17:49:53.583745 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:49:53.584700 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:49:53.589497 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m17:49:53.592646 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m17:49:53.594811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48d5611a-eb9d-4582-b04c-1a9cf4dd8119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2b65ead0>]}
[0m17:49:53.596619 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48d5611a-eb9d-4582-b04c-1a9cf4dd8119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de27db9b40>]}
[0m17:49:53.598380 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.55s]
[0m17:49:53.599989 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.54s]
[0m17:49:53.601345 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m17:49:53.602527 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m17:49:53.605310 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:53.606549 [debug] [MainThread]: On master: BEGIN
[0m17:49:53.607782 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:49:53.621447 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m17:49:53.622634 [debug] [MainThread]: On master: COMMIT
[0m17:49:53.623745 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:53.624728 [debug] [MainThread]: On master: COMMIT
[0m17:49:53.626048 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:49:53.627323 [debug] [MainThread]: On master: Close
[0m17:49:53.628722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:53.629538 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m17:49:53.630266 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m17:49:53.630934 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m17:49:53.631766 [info ] [MainThread]: 
[0m17:49:53.632569 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m17:49:53.634576 [debug] [MainThread]: Command end result
[0m17:49:53.674550 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m17:49:53.678075 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m17:49:53.690804 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m17:49:53.691636 [info ] [MainThread]: 
[0m17:49:53.692495 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:49:53.693323 [info ] [MainThread]: 
[0m17:49:53.694216 [error] [MainThread]:   Database Error in model gold_flat_avg_prices (models/mart/gold_flat_avg_prices.sql)
  invalid input syntax for type boolean: "Studios%"
  LINE 10:  'Flats%' OR 'Studios%' OR 'Kitnets'
                        ^
  compiled code at target/run/zap_imoveis/models/mart/gold_flat_avg_prices.sql
[0m17:49:53.694985 [info ] [MainThread]: 
[0m17:49:53.695763 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:49:53.697449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0762978, "process_in_blocks": "0", "process_kernel_time": 0.2745, "process_mem_max_rss": "112688", "process_out_blocks": "1816", "process_user_time": 3.998285}
[0m17:49:53.698593 [debug] [MainThread]: Command `dbt run` failed at 17:49:53.698309 after 2.08 seconds
[0m17:49:53.700002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2a648df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2b4eeb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2b4ee920>]}
[0m17:49:53.700904 [debug] [MainThread]: Flushing usage events
[0m17:50:06.310372 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:24.762984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731660044df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731660eea3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731660eea350>]}


============================== 17:50:24.767514 | 1859b65e-38d0-4f59-a118-e886368cdea1 ==============================
[0m17:50:24.767514 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:50:24.768624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:50:25.097524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1859b65e-38d0-4f59-a118-e886368cdea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73166105b7f0>]}
[0m17:50:25.208296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1859b65e-38d0-4f59-a118-e886368cdea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73165fdc53f0>]}
[0m17:50:25.209697 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:50:25.403567 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:50:25.624494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:50:25.625638 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_flat_avg_prices.sql
[0m17:50:26.129679 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m17:50:26.160669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1859b65e-38d0-4f59-a118-e886368cdea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73165e1ce1a0>]}
[0m17:50:26.320657 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m17:50:26.326176 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m17:50:26.343413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1859b65e-38d0-4f59-a118-e886368cdea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73165e3cd630>]}
[0m17:50:26.344452 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m17:50:26.345200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1859b65e-38d0-4f59-a118-e886368cdea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73165e3ce2c0>]}
[0m17:50:26.348193 [info ] [MainThread]: 
[0m17:50:26.349060 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:50:26.349904 [info ] [MainThread]: 
[0m17:50:26.351216 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:50:26.362346 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m17:50:26.428319 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m17:50:26.429156 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m17:50:26.429830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:26.446044 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m17:50:26.448887 [debug] [ThreadPool]: On list_foo: Close
[0m17:50:26.451623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m17:50:26.464228 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:50:26.465061 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m17:50:26.465722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:26.477266 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m17:50:26.478095 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:50:26.478776 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m17:50:26.483662 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m17:50:26.486716 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m17:50:26.487904 [debug] [ThreadPool]: On list_foo_zap: Close
[0m17:50:26.497941 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:26.498757 [debug] [MainThread]: On master: BEGIN
[0m17:50:26.499405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:26.512387 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m17:50:26.513236 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:26.514076 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:50:26.520898 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m17:50:26.524796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1859b65e-38d0-4f59-a118-e886368cdea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73165e174730>]}
[0m17:50:26.525704 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:26.526826 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:26.527568 [debug] [MainThread]: On master: BEGIN
[0m17:50:26.528859 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:50:26.529621 [debug] [MainThread]: On master: COMMIT
[0m17:50:26.530312 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:26.530961 [debug] [MainThread]: On master: COMMIT
[0m17:50:26.531956 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:50:26.532711 [debug] [MainThread]: On master: Close
[0m17:50:26.536977 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m17:50:26.537952 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m17:50:26.539171 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m17:50:26.540339 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m17:50:26.541748 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m17:50:26.543038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m17:50:26.544199 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m17:50:26.545566 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m17:50:26.547229 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m17:50:26.548865 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m17:50:26.550128 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m17:50:26.561962 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m17:50:26.567727 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:50:26.575227 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m17:50:26.643339 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m17:50:26.645658 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m17:50:26.647140 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m17:50:26.653748 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m17:50:26.840520 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:50:26.845721 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m17:50:26.837442 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m17:50:26.848670 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:50:26.849948 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:50:26.851156 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m17:50:26.852049 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:50:26.852993 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m17:50:26.853875 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:50:26.854841 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m17:50:26.855770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:26.856931 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:50:26.868325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m17:50:26.869486 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:50:26.870522 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m17:50:26.871499 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:50:26.872446 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m17:50:26.873614 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:50:26.874630 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:50:26.875663 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Casas para Alugar', 'Casas à Venda', 'Casas de Condomínio para Alugar', 'Casas de Condomínio à Venda')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:50:26.876899 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 
	'Flats%' OR LIKE 
	'Studios%' OR LIKE 
	'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:50:26.878135 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:50:26.885907 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m17:50:26.887489 [debug] [Thread-2 (]: Postgres adapter: Postgres error: type "like" does not exist
LINE 10:  'Flats%' OR LIKE 
                      ^

[0m17:50:26.896608 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:50:26.904328 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:50:26.905470 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: ROLLBACK
[0m17:50:26.907235 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m17:50:26.908865 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices" rename to "gold_house_avg_prices__dbt_backup"
[0m17:50:26.910750 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m17:50:26.912238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:50:26.913302 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:50:26.921201 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:50:26.928402 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m17:50:26.930414 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:50:26.932032 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m17:50:26.933017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:50:26.939722 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m17:50:27.001274 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m17:50:27.003486 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m17:50:27.005031 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:50:27.006545 [debug] [Thread-2 (]: Database Error in model gold_flat_avg_prices (models/mart/gold_flat_avg_prices.sql)
  type "like" does not exist
  LINE 10:  'Flats%' OR LIKE 
                        ^
  compiled code at target/run/zap_imoveis/models/mart/gold_flat_avg_prices.sql
[0m17:50:27.007757 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:50:27.008816 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m17:50:27.012539 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m17:50:27.013433 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1859b65e-38d0-4f59-a118-e886368cdea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73165e904d30>]}
[0m17:50:27.015204 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model zap.gold_flat_avg_prices .................. [[31mERROR[0m in 0.46s]
[0m17:50:27.016504 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m17:50:27.017482 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m17:50:27.018706 [debug] [Thread-7 (]: Marking all children of 'model.zap_imoveis.gold_flat_avg_prices' to be skipped because of status 'error'.  Reason: Database Error in model gold_flat_avg_prices (models/mart/gold_flat_avg_prices.sql)
  type "like" does not exist
  LINE 10:  'Flats%' OR LIKE 
                        ^
  compiled code at target/run/zap_imoveis/models/mart/gold_flat_avg_prices.sql.
[0m17:50:27.019639 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:50:27.035493 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m17:50:27.042910 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m17:50:27.052718 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:50:27.056197 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:50:27.057986 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m17:50:27.059160 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m17:50:27.063406 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:50:27.064969 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:50:27.070947 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m17:50:27.074711 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m17:50:27.076739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1859b65e-38d0-4f59-a118-e886368cdea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73166105aad0>]}
[0m17:50:27.078565 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1859b65e-38d0-4f59-a118-e886368cdea1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73165e230880>]}
[0m17:50:27.080379 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.53s]
[0m17:50:27.082348 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.53s]
[0m17:50:27.084216 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m17:50:27.085673 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m17:50:27.088895 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:27.090031 [debug] [MainThread]: On master: BEGIN
[0m17:50:27.091314 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:27.103162 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:50:27.104048 [debug] [MainThread]: On master: COMMIT
[0m17:50:27.105035 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:27.106014 [debug] [MainThread]: On master: COMMIT
[0m17:50:27.107422 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:50:27.108673 [debug] [MainThread]: On master: Close
[0m17:50:27.110060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:27.110812 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m17:50:27.111491 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m17:50:27.112145 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m17:50:27.112959 [info ] [MainThread]: 
[0m17:50:27.113715 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m17:50:27.115662 [debug] [MainThread]: Command end result
[0m17:50:27.158047 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m17:50:27.161118 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m17:50:27.174112 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m17:50:27.174937 [info ] [MainThread]: 
[0m17:50:27.175749 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:50:27.176553 [info ] [MainThread]: 
[0m17:50:27.177459 [error] [MainThread]:   Database Error in model gold_flat_avg_prices (models/mart/gold_flat_avg_prices.sql)
  type "like" does not exist
  LINE 10:  'Flats%' OR LIKE 
                        ^
  compiled code at target/run/zap_imoveis/models/mart/gold_flat_avg_prices.sql
[0m17:50:27.178226 [info ] [MainThread]: 
[0m17:50:27.179038 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:50:27.180692 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5252252, "process_in_blocks": "0", "process_kernel_time": 0.28964, "process_mem_max_rss": "116020", "process_out_blocks": "2664", "process_user_time": 4.70816}
[0m17:50:27.181818 [debug] [MainThread]: Command `dbt run` failed at 17:50:27.181538 after 2.53 seconds
[0m17:50:27.182854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731660044df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73165e191b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73165fefe710>]}
[0m17:50:27.183854 [debug] [MainThread]: Flushing usage events
[0m17:50:34.767457 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:56.451689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759286060e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759286f362c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759286f36260>]}


============================== 17:50:56.456484 | 48ac3993-e6c8-4e24-a26c-e113fb41852d ==============================
[0m17:50:56.456484 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:50:56.457568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:50:56.768598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48ac3993-e6c8-4e24-a26c-e113fb41852d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592853915a0>]}
[0m17:50:56.880600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48ac3993-e6c8-4e24-a26c-e113fb41852d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759285773b50>]}
[0m17:50:56.882035 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:50:57.077899 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:50:57.299209 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:50:57.300352 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_flat_avg_prices.sql
[0m17:50:57.777741 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m17:50:57.808800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48ac3993-e6c8-4e24-a26c-e113fb41852d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592842de1d0>]}
[0m17:50:57.966035 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m17:50:57.971726 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m17:50:57.989187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48ac3993-e6c8-4e24-a26c-e113fb41852d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759284912260>]}
[0m17:50:57.990227 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m17:50:57.990971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48ac3993-e6c8-4e24-a26c-e113fb41852d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759284912e90>]}
[0m17:50:57.993894 [info ] [MainThread]: 
[0m17:50:57.994724 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:50:57.995475 [info ] [MainThread]: 
[0m17:50:57.996648 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:50:58.007965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m17:50:58.073823 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m17:50:58.074660 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m17:50:58.075330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:58.090170 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m17:50:58.092534 [debug] [ThreadPool]: On list_foo: Close
[0m17:50:58.095390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m17:50:58.107621 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:50:58.108465 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m17:50:58.109169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:58.122617 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m17:50:58.123469 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:50:58.124208 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m17:50:58.129518 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m17:50:58.132778 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m17:50:58.133955 [debug] [ThreadPool]: On list_foo_zap: Close
[0m17:50:58.143871 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:58.144705 [debug] [MainThread]: On master: BEGIN
[0m17:50:58.145405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:58.157790 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:50:58.158629 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:58.159450 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:50:58.166541 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m17:50:58.170765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48ac3993-e6c8-4e24-a26c-e113fb41852d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592866c5c00>]}
[0m17:50:58.171765 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:58.172886 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:58.173653 [debug] [MainThread]: On master: BEGIN
[0m17:50:58.174961 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:50:58.175711 [debug] [MainThread]: On master: COMMIT
[0m17:50:58.176426 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:58.177096 [debug] [MainThread]: On master: COMMIT
[0m17:50:58.178117 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:50:58.178872 [debug] [MainThread]: On master: Close
[0m17:50:58.183472 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m17:50:58.184487 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m17:50:58.185609 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m17:50:58.186709 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m17:50:58.187799 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m17:50:58.189019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m17:50:58.190366 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m17:50:58.191899 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m17:50:58.193400 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m17:50:58.194792 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m17:50:58.195847 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m17:50:58.207317 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m17:50:58.214004 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:50:58.220693 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m17:50:58.289106 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m17:50:58.291200 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m17:50:58.292154 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m17:50:58.303846 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m17:50:58.488010 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m17:50:58.493262 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m17:50:58.494559 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:50:58.496205 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:50:58.497218 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:50:58.498066 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m17:50:58.498960 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:50:58.500103 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m17:50:58.500997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:58.502665 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m17:50:58.503729 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:50:58.504869 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:50:58.515787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m17:50:58.517541 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:50:58.518543 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:50:58.520141 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m17:50:58.521288 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m17:50:58.522520 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:50:58.523498 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:50:58.524519 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 
	'Flats%' OR KIND LIKE 
	'Studios%' OR KIND LIKE 
	'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:50:58.525441 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m17:50:58.526385 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Casas para Alugar', 'Casas à Venda', 'Casas de Condomínio para Alugar', 'Casas de Condomínio à Venda')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:50:58.533631 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m17:50:58.543010 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:50:58.549861 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m17:50:58.553640 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:50:58.554876 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m17:50:58.562101 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices" rename to "gold_flat_avg_prices__dbt_backup"
[0m17:50:58.565797 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:50:58.567384 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices" rename to "gold_house_avg_prices__dbt_backup"
[0m17:50:58.568519 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:50:58.569396 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:50:58.575886 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m17:50:58.577558 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:50:58.584086 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:50:58.591121 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:50:58.592282 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m17:50:58.593971 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m17:50:58.595250 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m17:50:58.597404 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:50:58.598358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:50:58.599192 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:50:58.681238 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m17:50:58.678966 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m17:50:58.683571 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:50:58.689626 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m17:50:58.690954 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:50:58.692301 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m17:50:58.693721 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:50:58.694763 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m17:50:58.696297 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m17:50:58.698535 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m17:50:58.699641 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m17:50:58.700646 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:50:58.720750 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m17:50:58.723406 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m17:50:58.729148 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m17:50:58.740194 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:50:58.742522 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:50:58.745668 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:50:58.747082 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m17:50:58.749185 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m17:50:58.750571 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m17:50:58.754885 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:50:58.756197 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m17:50:58.757093 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:50:58.762210 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m17:50:58.765190 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m17:50:58.767953 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m17:50:58.773190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ac3993-e6c8-4e24-a26c-e113fb41852d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592837733a0>]}
[0m17:50:58.774753 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.58s]
[0m17:50:58.776735 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m17:50:58.777540 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ac3993-e6c8-4e24-a26c-e113fb41852d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759283772ef0>]}
[0m17:50:58.779525 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.58s]
[0m17:50:58.780935 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ac3993-e6c8-4e24-a26c-e113fb41852d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759283773250>]}
[0m17:50:58.782458 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m17:50:58.784163 [info ] [Thread-2 (]: 2 of 3 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.58s]
[0m17:50:58.786345 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m17:50:58.789162 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:58.789985 [debug] [MainThread]: On master: BEGIN
[0m17:50:58.790793 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:58.803219 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:50:58.804211 [debug] [MainThread]: On master: COMMIT
[0m17:50:58.805474 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:58.806509 [debug] [MainThread]: On master: COMMIT
[0m17:50:58.807868 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:50:58.808743 [debug] [MainThread]: On master: Close
[0m17:50:58.809818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:58.810559 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m17:50:58.811228 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m17:50:58.811853 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m17:50:58.812684 [info ] [MainThread]: 
[0m17:50:58.813437 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m17:50:58.815389 [debug] [MainThread]: Command end result
[0m17:50:58.856200 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m17:50:58.859177 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m17:50:58.871881 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m17:50:58.872747 [info ] [MainThread]: 
[0m17:50:58.873601 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:58.874356 [info ] [MainThread]: 
[0m17:50:58.875123 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:50:58.876727 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.531353, "process_in_blocks": "0", "process_kernel_time": 0.261938, "process_mem_max_rss": "115772", "process_out_blocks": "2656", "process_user_time": 4.469943}
[0m17:50:58.877675 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:58.877511 after 2.53 seconds
[0m17:50:58.878456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759286060e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759285773b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759285f1d480>]}
[0m17:50:58.879255 [debug] [MainThread]: Flushing usage events
[0m17:51:06.918110 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:51:35.637244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d43e3fd4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d43e4e6a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d43e4e6a260>]}


============================== 17:51:35.641908 | 48d3c212-37a4-46e0-a8ea-bf8afe2a4aae ==============================
[0m17:51:35.641908 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:51:35.643059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:51:35.948563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48d3c212-37a4-46e0-a8ea-bf8afe2a4aae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d43e2fe95a0>]}
[0m17:51:36.060880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48d3c212-37a4-46e0-a8ea-bf8afe2a4aae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d43e36efb80>]}
[0m17:51:36.062304 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:51:36.255443 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:51:36.477565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:51:36.478733 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_flat_avg_prices.sql
[0m17:51:36.950177 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m17:51:36.979999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48d3c212-37a4-46e0-a8ea-bf8afe2a4aae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d43e21da1d0>]}
[0m17:51:37.136400 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m17:51:37.142230 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m17:51:37.159368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48d3c212-37a4-46e0-a8ea-bf8afe2a4aae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d43e2261420>]}
[0m17:51:37.160390 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m17:51:37.161152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48d3c212-37a4-46e0-a8ea-bf8afe2a4aae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d43e2260a30>]}
[0m17:51:37.164054 [info ] [MainThread]: 
[0m17:51:37.164873 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:51:37.165588 [info ] [MainThread]: 
[0m17:51:37.166648 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:51:37.176808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m17:51:37.241161 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m17:51:37.241988 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m17:51:37.242664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:37.260498 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m17:51:37.263397 [debug] [ThreadPool]: On list_foo: Close
[0m17:51:37.266500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m17:51:37.278467 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:51:37.279284 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m17:51:37.279962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:37.292580 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m17:51:37.293405 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:51:37.294129 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m17:51:37.299390 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m17:51:37.302886 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m17:51:37.304069 [debug] [ThreadPool]: On list_foo_zap: Close
[0m17:51:37.315184 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:37.316009 [debug] [MainThread]: On master: BEGIN
[0m17:51:37.316664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:37.328852 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:51:37.329688 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:37.330482 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:51:37.337352 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m17:51:37.341497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48d3c212-37a4-46e0-a8ea-bf8afe2a4aae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d43e2111210>]}
[0m17:51:37.342414 [debug] [MainThread]: On master: ROLLBACK
[0m17:51:37.343515 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:37.344257 [debug] [MainThread]: On master: BEGIN
[0m17:51:37.345600 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:51:37.346347 [debug] [MainThread]: On master: COMMIT
[0m17:51:37.347025 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:37.347674 [debug] [MainThread]: On master: COMMIT
[0m17:51:37.348712 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:51:37.349488 [debug] [MainThread]: On master: Close
[0m17:51:37.353988 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m17:51:37.355009 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_avg_prices
[0m17:51:37.356096 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m17:51:37.357358 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m17:51:37.358986 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_avg_prices ........................... [RUN]
[0m17:51:37.360227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m17:51:37.361743 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m17:51:37.363626 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_avg_prices'
[0m17:51:37.365010 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m17:51:37.366949 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m17:51:37.368018 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_avg_prices
[0m17:51:37.379957 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m17:51:37.386898 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:51:37.393226 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_avg_prices"
[0m17:51:37.466026 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m17:51:37.468120 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m17:51:37.474717 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_avg_prices
[0m17:51:37.487455 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m17:51:37.695984 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_avg_prices"
[0m17:51:37.697329 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m17:51:37.698800 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:51:37.700942 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:51:37.701900 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: BEGIN
[0m17:51:37.702762 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:51:37.704111 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:51:37.705209 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:51:37.706160 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m17:51:37.707321 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m17:51:37.708803 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:51:37.709760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:37.715435 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m17:51:37.716617 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:51:37.717720 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */

  create view "foo"."zap"."gold_flat_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:51:37.722022 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m17:51:37.723144 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:51:37.724178 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m17:51:37.725048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m17:51:37.725941 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Casas para Alugar', 'Casas à Venda', 'Casas de Condomínio para Alugar', 'Casas de Condomínio à Venda')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:51:37.737613 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:51:37.741170 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:51:37.742698 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind in ('Apartamentos à Venda', 'Apartamentos para Alugar')
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:51:37.744498 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices" rename to "gold_flat_avg_prices__dbt_backup"
[0m17:51:37.746484 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:51:37.753060 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m17:51:37.754577 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m17:51:37.755750 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:51:37.762985 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:51:37.770253 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:51:37.771147 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
alter table "foo"."zap"."gold_flat_avg_prices__dbt_tmp" rename to "gold_flat_avg_prices"
[0m17:51:37.772089 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m17:51:37.773059 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices" rename to "gold_house_avg_prices__dbt_backup"
[0m17:51:37.774763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:51:37.775870 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:51:37.777047 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:51:37.783934 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:51:37.790750 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:51:37.802460 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m17:51:37.817693 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m17:51:37.827509 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m17:51:37.828894 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:51:37.829974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:51:37.830834 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:51:37.831653 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: COMMIT
[0m17:51:37.835258 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m17:51:37.840030 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m17:51:37.841165 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:51:37.842158 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:51:37.843101 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m17:51:37.844056 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m17:51:37.844864 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m17:51:37.851356 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:51:37.861366 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_avg_prices__dbt_backup"
[0m17:51:37.867958 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m17:51:37.870253 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m17:51:37.880568 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_avg_prices"
[0m17:51:37.886418 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m17:51:37.889684 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:51:37.890990 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_avg_prices__dbt_backup" cascade
[0m17:51:37.893305 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:51:37.894528 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m17:51:37.896704 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m17:51:37.899654 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:51:37.900734 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:51:37.905526 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_avg_prices: Close
[0m17:51:37.906575 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.009 seconds
[0m17:51:37.909939 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m17:51:37.913769 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m17:51:37.917279 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48d3c212-37a4-46e0-a8ea-bf8afe2a4aae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d43e166f250>]}
[0m17:51:37.920175 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48d3c212-37a4-46e0-a8ea-bf8afe2a4aae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d43e1557910>]}
[0m17:51:37.918958 [info ] [Thread-2 (]: 2 of 3 OK created sql view model zap.gold_flat_avg_prices ...................... [[32mCREATE VIEW[0m in 0.55s]
[0m17:51:37.921992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48d3c212-37a4-46e0-a8ea-bf8afe2a4aae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d43e1519270>]}
[0m17:51:37.923534 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.55s]
[0m17:51:37.924897 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_avg_prices
[0m17:51:37.926596 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.56s]
[0m17:51:37.928867 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m17:51:37.930820 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m17:51:37.933670 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:37.934641 [debug] [MainThread]: On master: BEGIN
[0m17:51:37.935818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:37.948260 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:51:37.949150 [debug] [MainThread]: On master: COMMIT
[0m17:51:37.950100 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:37.950991 [debug] [MainThread]: On master: COMMIT
[0m17:51:37.952232 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:51:37.953404 [debug] [MainThread]: On master: Close
[0m17:51:37.954885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:37.955789 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m17:51:37.956539 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_avg_prices' was properly closed.
[0m17:51:37.957218 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m17:51:37.958059 [info ] [MainThread]: 
[0m17:51:37.958815 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m17:51:37.960777 [debug] [MainThread]: Command end result
[0m17:51:38.002378 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m17:51:38.005825 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m17:51:38.018637 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m17:51:38.019434 [info ] [MainThread]: 
[0m17:51:38.020259 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:38.021004 [info ] [MainThread]: 
[0m17:51:38.021752 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:51:38.023400 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4965231, "process_in_blocks": "0", "process_kernel_time": 0.288075, "process_mem_max_rss": "115384", "process_out_blocks": "2648", "process_user_time": 4.411149}
[0m17:51:38.024332 [debug] [MainThread]: Command `dbt run` succeeded at 17:51:38.024176 after 2.50 seconds
[0m17:51:38.025090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d43e3fd4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d43e36efb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d43e21da4a0>]}
[0m17:51:38.025868 [debug] [MainThread]: Flushing usage events
[0m17:51:39.073241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:59:04.359114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a52d40e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a53be6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a53be62c0>]}


============================== 17:59:04.363749 | f1ac870e-c13e-4d32-9be9-b7c43a1cd604 ==============================
[0m17:59:04.363749 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:59:04.364943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:59:04.676117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1ac870e-c13e-4d32-9be9-b7c43a1cd604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a53b8f970>]}
[0m17:59:04.788170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1ac870e-c13e-4d32-9be9-b7c43a1cd604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a520286d0>]}
[0m17:59:04.789579 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:59:04.985075 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:59:05.210350 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m17:59:05.211380 [debug] [MainThread]: Partial parsing: added file: zap_imoveis://models/mart/gold_flat_kit_studio_avg_prices.sql
[0m17:59:05.212067 [debug] [MainThread]: Partial parsing: deleted file: zap_imoveis://models/mart/gold_flat_avg_prices.sql
[0m17:59:05.212908 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_house_avg_prices.sql
[0m17:59:05.213816 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_apartment_avg_prices.sql
[0m17:59:05.705946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m17:59:05.737127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1ac870e-c13e-4d32-9be9-b7c43a1cd604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a50fba410>]}
[0m17:59:05.895206 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m17:59:05.900940 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m17:59:05.918216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1ac870e-c13e-4d32-9be9-b7c43a1cd604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a511ba9e0>]}
[0m17:59:05.919229 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m17:59:05.920047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1ac870e-c13e-4d32-9be9-b7c43a1cd604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a511bbdc0>]}
[0m17:59:05.923326 [info ] [MainThread]: 
[0m17:59:05.924197 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:59:05.924906 [info ] [MainThread]: 
[0m17:59:05.926402 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:59:05.938036 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m17:59:06.004098 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m17:59:06.004944 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m17:59:06.005604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:06.019738 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m17:59:06.022156 [debug] [ThreadPool]: On list_foo: Close
[0m17:59:06.024716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m17:59:06.036813 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:59:06.037638 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m17:59:06.038320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:06.051636 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m17:59:06.052449 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:59:06.053157 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m17:59:06.058312 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m17:59:06.061307 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m17:59:06.062428 [debug] [ThreadPool]: On list_foo_zap: Close
[0m17:59:06.072036 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:06.072866 [debug] [MainThread]: On master: BEGIN
[0m17:59:06.073568 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:06.086268 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m17:59:06.087236 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:06.088062 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:59:06.094603 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m17:59:06.098448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1ac870e-c13e-4d32-9be9-b7c43a1cd604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a50fbae30>]}
[0m17:59:06.099392 [debug] [MainThread]: On master: ROLLBACK
[0m17:59:06.100500 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:06.101273 [debug] [MainThread]: On master: BEGIN
[0m17:59:06.102571 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:59:06.103341 [debug] [MainThread]: On master: COMMIT
[0m17:59:06.104053 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:06.104731 [debug] [MainThread]: On master: COMMIT
[0m17:59:06.105759 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:59:06.106532 [debug] [MainThread]: On master: Close
[0m17:59:06.110996 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m17:59:06.111991 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m17:59:06.113111 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m17:59:06.114189 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m17:59:06.115285 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m17:59:06.116392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m17:59:06.117570 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m17:59:06.118953 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m17:59:06.120407 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m17:59:06.121873 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m17:59:06.123156 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m17:59:06.135054 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m17:59:06.141955 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:59:06.149501 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m17:59:06.219005 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m17:59:06.220987 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m17:59:06.222331 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m17:59:06.228624 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m17:59:06.453939 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m17:59:06.455222 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m17:59:06.456330 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:59:06.457783 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m17:59:06.459000 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:59:06.459944 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m17:59:06.460815 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m17:59:06.461784 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:59:06.462741 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:59:06.463637 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:59:06.464534 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m17:59:06.466260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:06.477198 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m17:59:06.478865 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m17:59:06.479962 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m17:59:06.481096 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m17:59:06.482535 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:59:06.483595 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:59:06.485345 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:59:06.486412 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:59:06.487616 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:59:06.490829 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m17:59:06.497683 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m17:59:06.509404 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m17:59:06.519985 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m17:59:06.527060 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:59:06.530107 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:59:06.531161 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m17:59:06.532595 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices" rename to "gold_house_avg_prices__dbt_backup"
[0m17:59:06.533612 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m17:59:06.536132 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:59:06.537091 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:59:06.537936 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:59:06.562017 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:59:06.574950 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:59:06.584138 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m17:59:06.590725 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m17:59:06.592029 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m17:59:06.593741 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m17:59:06.595010 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:59:06.596275 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m17:59:06.597305 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:59:06.604904 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m17:59:06.610177 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m17:59:06.611251 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m17:59:06.612388 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:59:06.613276 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:59:06.625239 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m17:59:06.628108 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m17:59:06.629583 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m17:59:06.636879 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m17:59:06.641691 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m17:59:06.648476 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:59:06.651874 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m17:59:06.653243 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m17:59:06.658975 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m17:59:06.660987 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:59:06.663173 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:59:06.664183 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:59:06.665044 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m17:59:06.665899 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m17:59:06.670903 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m17:59:06.677349 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:59:06.680257 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m17:59:06.681145 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m17:59:06.682218 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1ac870e-c13e-4d32-9be9-b7c43a1cd604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a53d56b30>]}
[0m17:59:06.686041 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m17:59:06.687425 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1ac870e-c13e-4d32-9be9-b7c43a1cd604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a51690190>]}
[0m17:59:06.689355 [info ] [Thread-2 (]: 2 of 3 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.55s]
[0m17:59:06.691806 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.57s]
[0m17:59:06.693986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1ac870e-c13e-4d32-9be9-b7c43a1cd604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a50332380>]}
[0m17:59:06.695282 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m17:59:06.696727 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m17:59:06.698420 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.58s]
[0m17:59:06.700747 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m17:59:06.703463 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:06.704466 [debug] [MainThread]: On master: BEGIN
[0m17:59:06.705271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:06.718757 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m17:59:06.720166 [debug] [MainThread]: On master: COMMIT
[0m17:59:06.720870 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:06.721557 [debug] [MainThread]: On master: COMMIT
[0m17:59:06.722599 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:59:06.723452 [debug] [MainThread]: On master: Close
[0m17:59:06.724494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:06.725252 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m17:59:06.726123 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m17:59:06.726961 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m17:59:06.728279 [info ] [MainThread]: 
[0m17:59:06.729580 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m17:59:06.731737 [debug] [MainThread]: Command end result
[0m17:59:06.770887 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m17:59:06.773827 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m17:59:06.787389 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m17:59:06.788240 [info ] [MainThread]: 
[0m17:59:06.789124 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:59:06.789885 [info ] [MainThread]: 
[0m17:59:06.790696 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:59:06.792461 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5402842, "process_in_blocks": "0", "process_kernel_time": 0.280114, "process_mem_max_rss": "115380", "process_out_blocks": "2656", "process_user_time": 4.488838}
[0m17:59:06.793498 [debug] [MainThread]: Command `dbt run` succeeded at 17:59:06.793322 after 2.54 seconds
[0m17:59:06.794292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a52d40e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a52bfa9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718a50fbbca0>]}
[0m17:59:06.795169 [debug] [MainThread]: Flushing usage events
[0m17:59:13.724756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:02:40.331426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ebf01d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ebfe9a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ebfe9a530>]}


============================== 14:02:40.335697 | 730e3775-6680-461f-ae9a-f2a0641d3716 ==============================
[0m14:02:40.335697 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:02:40.336588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:02:40.585830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '730e3775-6680-461f-ae9a-f2a0641d3716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ebdfcada0>]}
[0m14:02:40.677729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '730e3775-6680-461f-ae9a-f2a0641d3716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ebe70fe20>]}
[0m14:02:40.680932 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:02:40.831290 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:02:41.034666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:02:41.035277 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:02:41.045625 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m14:02:41.097326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '730e3775-6680-461f-ae9a-f2a0641d3716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ebd238130>]}
[0m14:02:41.220007 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m14:02:41.224034 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m14:02:41.249415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '730e3775-6680-461f-ae9a-f2a0641d3716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ebd22c5b0>]}
[0m14:02:41.250532 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m14:02:41.251175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '730e3775-6680-461f-ae9a-f2a0641d3716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ebf67d420>]}
[0m14:02:41.253541 [info ] [MainThread]: 
[0m14:02:41.254217 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:02:41.254751 [info ] [MainThread]: 
[0m14:02:41.255518 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:02:41.263082 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m14:02:41.329017 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m14:02:41.329789 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m14:02:41.330534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:41.340705 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m14:02:41.342486 [debug] [ThreadPool]: On list_foo: Close
[0m14:02:41.345755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m14:02:41.355184 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m14:02:41.355805 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m14:02:41.356264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:02:41.365927 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:02:41.366646 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m14:02:41.367624 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m14:02:41.383747 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m14:02:41.386059 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m14:02:41.386930 [debug] [ThreadPool]: On list_foo_zap: Close
[0m14:02:41.395177 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:41.395974 [debug] [MainThread]: On master: BEGIN
[0m14:02:41.396686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:02:41.405659 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:02:41.406271 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:41.406844 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:02:41.413675 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m14:02:41.416347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '730e3775-6680-461f-ae9a-f2a0641d3716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ebfe65810>]}
[0m14:02:41.417275 [debug] [MainThread]: On master: ROLLBACK
[0m14:02:41.418084 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:41.418618 [debug] [MainThread]: On master: BEGIN
[0m14:02:41.419396 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:02:41.419944 [debug] [MainThread]: On master: COMMIT
[0m14:02:41.420507 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:41.420980 [debug] [MainThread]: On master: COMMIT
[0m14:02:41.421744 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:02:41.422279 [debug] [MainThread]: On master: Close
[0m14:02:41.426013 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m14:02:41.427443 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m14:02:41.428634 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m14:02:41.429717 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m14:02:41.430892 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m14:02:41.431823 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m14:02:41.432717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m14:02:41.433526 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m14:02:41.434255 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m14:02:41.434889 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m14:02:41.435484 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m14:02:41.436416 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m14:02:41.450956 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m14:02:41.454429 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m14:02:41.458751 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m14:02:41.461133 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m14:02:41.462702 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m14:02:41.464305 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m14:02:41.606698 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m14:02:41.611768 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m14:02:41.612528 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m14:02:41.614201 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m14:02:41.614998 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m14:02:41.615712 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m14:02:41.616411 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m14:02:41.617028 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m14:02:41.617754 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m14:02:41.618532 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:02:41.619258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:41.619881 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:02:41.629691 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:02:41.631111 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m14:02:41.632186 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m14:02:41.633004 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m14:02:41.633619 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m14:02:41.634279 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m14:02:41.635155 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m14:02:41.636053 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m14:02:41.637022 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m14:02:41.646472 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m14:02:41.647253 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m14:02:41.647862 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m14:02:41.656815 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m14:02:41.664479 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m14:02:41.669548 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m14:02:41.670550 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m14:02:41.671682 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m14:02:41.672728 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m14:02:41.674300 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:02:41.675074 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:02:41.675692 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:02:41.714756 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m14:02:41.717277 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m14:02:41.721818 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m14:02:41.722891 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m14:02:41.723711 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m14:02:41.724571 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m14:02:41.725623 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m14:02:41.726352 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m14:02:41.727784 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m14:02:41.731571 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:02:41.732688 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m14:02:41.733298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:02:41.742032 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m14:02:41.748936 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m14:02:41.754307 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m14:02:41.828991 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m14:02:41.830073 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m14:02:41.831891 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m14:02:41.832809 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m14:02:41.833738 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m14:02:41.834367 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m14:02:41.835452 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:02:41.839405 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m14:02:41.840340 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:02:41.841270 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m14:02:41.846772 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m14:02:41.849254 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m14:02:41.851377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '730e3775-6680-461f-ae9a-f2a0641d3716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ec002edd0>]}
[0m14:02:41.852122 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '730e3775-6680-461f-ae9a-f2a0641d3716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ebc63d8a0>]}
[0m14:02:41.852769 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '730e3775-6680-461f-ae9a-f2a0641d3716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ebc786b90>]}
[0m14:02:41.853852 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.41s]
[0m14:02:41.854943 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.42s]
[0m14:02:41.856037 [info ] [Thread-2 (]: 2 of 3 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.42s]
[0m14:02:41.857010 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m14:02:41.857872 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m14:02:41.858837 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m14:02:41.861432 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:41.862181 [debug] [MainThread]: On master: BEGIN
[0m14:02:41.862775 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:02:41.870871 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:02:41.871537 [debug] [MainThread]: On master: COMMIT
[0m14:02:41.872070 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:41.872565 [debug] [MainThread]: On master: COMMIT
[0m14:02:41.873226 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:02:41.873762 [debug] [MainThread]: On master: Close
[0m14:02:41.874715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:41.875551 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m14:02:41.876359 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m14:02:41.877872 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m14:02:41.879360 [info ] [MainThread]: 
[0m14:02:41.880837 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m14:02:41.882932 [debug] [MainThread]: Command end result
[0m14:02:41.911618 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m14:02:41.915581 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m14:02:41.924562 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m14:02:41.925183 [info ] [MainThread]: 
[0m14:02:41.925853 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:02:41.926863 [info ] [MainThread]: 
[0m14:02:41.928086 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:02:41.930213 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6870638, "process_in_blocks": "35312", "process_kernel_time": 0.245805, "process_mem_max_rss": "111860", "process_out_blocks": "1808", "process_user_time": 3.177417}
[0m14:02:41.931119 [debug] [MainThread]: Command `dbt run` succeeded at 14:02:41.930997 after 1.69 seconds
[0m14:02:41.931732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ebf01d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ebeef1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ebe8363b0>]}
[0m14:02:41.932331 [debug] [MainThread]: Flushing usage events
[0m14:02:43.699591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:18:51.405291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7a5d5d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7a6c32590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7a6c32530>]}


============================== 18:18:51.411941 | 27e1bee6-cf96-4ef2-a33e-12a3c47f6018 ==============================
[0m18:18:51.411941 [info ] [MainThread]: Running with dbt=1.9.2
[0m18:18:51.413226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:18:51.724207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27e1bee6-cf96-4ef2-a33e-12a3c47f6018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7a4deada0>]}
[0m18:18:51.834614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27e1bee6-cf96-4ef2-a33e-12a3c47f6018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7a546fe20>]}
[0m18:18:51.835748 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:18:51.988632 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m18:18:52.276201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:18:52.277579 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:18:52.293843 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m18:18:52.380057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27e1bee6-cf96-4ef2-a33e-12a3c47f6018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7a4054130>]}
[0m18:18:52.534978 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m18:18:52.539992 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m18:18:52.560668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27e1bee6-cf96-4ef2-a33e-12a3c47f6018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7a40485b0>]}
[0m18:18:52.561863 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m18:18:52.563090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27e1bee6-cf96-4ef2-a33e-12a3c47f6018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7a63c5420>]}
[0m18:18:52.565702 [info ] [MainThread]: 
[0m18:18:52.566428 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:18:52.567039 [info ] [MainThread]: 
[0m18:18:52.567884 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:18:52.575998 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m18:18:52.634023 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m18:18:52.635173 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m18:18:52.636184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:52.651329 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m18:18:52.653715 [debug] [ThreadPool]: On list_foo: Close
[0m18:18:52.656779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m18:18:52.671873 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m18:18:52.673073 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m18:18:52.674198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:52.684649 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:18:52.685526 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m18:18:52.686290 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m18:18:52.690395 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m18:18:52.693078 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m18:18:52.694863 [debug] [ThreadPool]: On list_foo_zap: Close
[0m18:18:52.703211 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:52.704090 [debug] [MainThread]: On master: BEGIN
[0m18:18:52.704819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:18:52.715681 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m18:18:52.716665 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:52.717805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:18:52.722956 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m18:18:52.725655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27e1bee6-cf96-4ef2-a33e-12a3c47f6018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7a6bd5810>]}
[0m18:18:52.727134 [debug] [MainThread]: On master: ROLLBACK
[0m18:18:52.728818 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:52.729867 [debug] [MainThread]: On master: BEGIN
[0m18:18:52.730965 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:18:52.731810 [debug] [MainThread]: On master: COMMIT
[0m18:18:52.732845 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:52.733950 [debug] [MainThread]: On master: COMMIT
[0m18:18:52.735094 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:18:52.735922 [debug] [MainThread]: On master: Close
[0m18:18:52.740605 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m18:18:52.741905 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m18:18:52.743287 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m18:18:52.744953 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m18:18:52.746923 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m18:18:52.748848 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m18:18:52.750536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m18:18:52.752219 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m18:18:52.753728 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m18:18:52.754964 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m18:18:52.755997 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m18:18:52.757462 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m18:18:52.782810 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m18:18:52.790201 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m18:18:52.792634 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m18:18:52.794624 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m18:18:52.801478 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m18:18:52.813498 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m18:18:52.953536 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m18:18:52.955675 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m18:18:52.960110 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m18:18:52.962220 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m18:18:52.963151 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m18:18:52.964265 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m18:18:52.965086 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m18:18:52.965883 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:18:52.966789 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m18:18:52.967458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:52.968489 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m18:18:52.969721 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:18:52.977592 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m18:18:52.978724 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m18:18:52.980205 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m18:18:52.981328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m18:18:52.982313 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m18:18:52.983394 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m18:18:52.984860 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m18:18:52.986169 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m18:18:52.987173 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m18:18:52.998708 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m18:18:53.000553 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m18:18:53.001366 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m18:18:53.006668 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m18:18:53.008284 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m18:18:53.010127 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m18:18:53.012853 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:18:53.014012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:18:53.014897 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:18:53.065390 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m18:18:53.068048 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m18:18:53.074883 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m18:18:53.076119 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m18:18:53.077725 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m18:18:53.079667 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m18:18:53.080649 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m18:18:53.081571 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m18:18:53.083470 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:18:53.086374 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m18:18:53.087190 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:18:53.088265 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m18:18:53.089163 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m18:18:53.112159 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m18:18:53.110264 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m18:18:53.114100 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m18:18:53.123022 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m18:18:53.125504 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m18:18:53.127607 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m18:18:53.128735 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m18:18:53.129538 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m18:18:53.212685 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.082 seconds
[0m18:18:53.215603 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m18:18:53.216345 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.086 seconds
[0m18:18:53.220586 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m18:18:53.223541 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m18:18:53.226042 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m18:18:53.227831 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m18:18:53.231722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e1bee6-cf96-4ef2-a33e-12a3c47f6018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7a6d7edd0>]}
[0m18:18:53.232649 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:18:53.233549 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e1bee6-cf96-4ef2-a33e-12a3c47f6018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7a346bee0>]}
[0m18:18:53.235161 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.48s]
[0m18:18:53.238204 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m18:18:53.239791 [info ] [Thread-2 (]: 2 of 3 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.48s]
[0m18:18:53.241276 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m18:18:53.243694 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m18:18:53.245760 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27e1bee6-cf96-4ef2-a33e-12a3c47f6018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7a34262c0>]}
[0m18:18:53.247509 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.49s]
[0m18:18:53.248682 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m18:18:53.250402 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:53.251108 [debug] [MainThread]: On master: BEGIN
[0m18:18:53.251755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:18:53.263939 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m18:18:53.265262 [debug] [MainThread]: On master: COMMIT
[0m18:18:53.266395 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:53.267527 [debug] [MainThread]: On master: COMMIT
[0m18:18:53.269125 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:18:53.270518 [debug] [MainThread]: On master: Close
[0m18:18:53.272821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:53.274044 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m18:18:53.275168 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m18:18:53.277195 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m18:18:53.279265 [info ] [MainThread]: 
[0m18:18:53.280807 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m18:18:53.283935 [debug] [MainThread]: Command end result
[0m18:18:53.318472 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m18:18:53.322183 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m18:18:53.334718 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m18:18:53.335385 [info ] [MainThread]: 
[0m18:18:53.336060 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:18:53.336697 [info ] [MainThread]: 
[0m18:18:53.337502 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:18:53.339014 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0568469, "process_in_blocks": "0", "process_kernel_time": 0.261635, "process_mem_max_rss": "112056", "process_out_blocks": "1808", "process_user_time": 3.951489}
[0m18:18:53.339968 [debug] [MainThread]: Command `dbt run` succeeded at 18:18:53.339717 after 2.06 seconds
[0m18:18:53.341024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7a5d5d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7a546fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77b7a53cded0>]}
[0m18:18:53.342448 [debug] [MainThread]: Flushing usage events
[0m18:18:54.237645 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:53:02.558879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73153e5d5180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73153f46a680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73153f46a620>]}


============================== 07:53:02.564727 | 5ace3a5c-90ab-4625-b426-83fa7ebb4f17 ==============================
[0m07:53:02.564727 [info ] [MainThread]: Running with dbt=1.9.2
[0m07:53:02.565662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:53:02.841841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ace3a5c-90ab-4625-b426-83fa7ebb4f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73153f5b1ed0>]}
[0m07:53:02.940786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ace3a5c-90ab-4625-b426-83fa7ebb4f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73153f3d28f0>]}
[0m07:53:02.943137 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:53:03.092679 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m07:53:03.301037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:53:03.301961 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_apartment_avg_prices.sql
[0m07:53:03.706725 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m07:53:03.733856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ace3a5c-90ab-4625-b426-83fa7ebb4f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73153c7da500>]}
[0m07:53:03.872817 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m07:53:03.880060 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m07:53:03.921020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ace3a5c-90ab-4625-b426-83fa7ebb4f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73153c9e5f00>]}
[0m07:53:03.922427 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m07:53:03.923448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ace3a5c-90ab-4625-b426-83fa7ebb4f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73153c84f730>]}
[0m07:53:03.927627 [info ] [MainThread]: 
[0m07:53:03.928622 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:53:03.929488 [info ] [MainThread]: 
[0m07:53:03.930647 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:53:03.940537 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m07:53:04.009469 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m07:53:04.010582 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m07:53:04.011691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:53:04.023130 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m07:53:04.026012 [debug] [ThreadPool]: On list_foo: Close
[0m07:53:04.028984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m07:53:04.038334 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m07:53:04.038981 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m07:53:04.039610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:53:04.050895 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m07:53:04.051631 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m07:53:04.052198 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m07:53:04.066262 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m07:53:04.068594 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m07:53:04.069567 [debug] [ThreadPool]: On list_foo_zap: Close
[0m07:53:04.078106 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:04.079097 [debug] [MainThread]: On master: BEGIN
[0m07:53:04.079875 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:53:04.089753 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m07:53:04.090517 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:04.091606 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:53:04.101506 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m07:53:04.104002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ace3a5c-90ab-4625-b426-83fa7ebb4f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73153c788100>]}
[0m07:53:04.105277 [debug] [MainThread]: On master: ROLLBACK
[0m07:53:04.106351 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:04.107087 [debug] [MainThread]: On master: BEGIN
[0m07:53:04.109381 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:53:04.110658 [debug] [MainThread]: On master: COMMIT
[0m07:53:04.111776 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:04.112515 [debug] [MainThread]: On master: COMMIT
[0m07:53:04.113447 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:53:04.114318 [debug] [MainThread]: On master: Close
[0m07:53:04.117623 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m07:53:04.118753 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m07:53:04.119828 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m07:53:04.120895 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m07:53:04.122106 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m07:53:04.123701 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m07:53:04.126191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m07:53:04.128408 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m07:53:04.130107 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m07:53:04.131377 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m07:53:04.132271 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m07:53:04.133173 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m07:53:04.148549 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m07:53:04.151411 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m07:53:04.243519 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m07:53:04.245230 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m07:53:04.246091 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m07:53:04.294813 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m07:53:04.393960 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m07:53:04.395766 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m07:53:04.400952 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m07:53:04.402738 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m07:53:04.403767 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m07:53:04.404801 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m07:53:04.405538 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m07:53:04.406578 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m07:53:04.408019 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m07:53:04.409367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:04.410943 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:53:04.412315 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:53:04.423696 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m07:53:04.424775 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m07:53:04.426253 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m07:53:04.427688 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m07:53:04.429198 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m07:53:04.430272 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m07:53:04.431565 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m07:53:04.432771 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m07:53:04.433929 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m07:53:04.442830 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m07:53:04.444334 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m07:53:04.445756 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m07:53:04.464107 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m07:53:04.467293 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m07:53:04.472714 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m07:53:04.473551 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m07:53:04.474708 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m07:53:04.476151 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m07:53:04.478225 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:53:04.478965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:53:04.479750 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:53:04.522984 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m07:53:04.529368 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m07:53:04.531401 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m07:53:04.532640 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m07:53:04.533472 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m07:53:04.534464 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m07:53:04.535314 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m07:53:04.536217 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m07:53:04.537045 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m07:53:04.537848 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m07:53:04.545058 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m07:53:04.554093 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m07:53:04.554957 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m07:53:04.559771 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m07:53:04.567622 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m07:53:04.572690 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m07:53:04.574584 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m07:53:04.575998 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m07:53:04.577874 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m07:53:04.578564 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m07:53:04.579266 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m07:53:04.579952 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:53:04.583803 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m07:53:04.584601 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m07:53:04.585561 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m07:53:04.588873 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m07:53:04.594517 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m07:53:04.596533 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ace3a5c-90ab-4625-b426-83fa7ebb4f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73153bc63340>]}
[0m07:53:04.597319 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ace3a5c-90ab-4625-b426-83fa7ebb4f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73153bc63610>]}
[0m07:53:04.598124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ace3a5c-90ab-4625-b426-83fa7ebb4f17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73153c889bd0>]}
[0m07:53:04.599565 [info ] [Thread-2 (]: 2 of 3 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.46s]
[0m07:53:04.600787 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.47s]
[0m07:53:04.601955 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.47s]
[0m07:53:04.603148 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m07:53:04.604060 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m07:53:04.605414 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m07:53:04.607935 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:04.609228 [debug] [MainThread]: On master: BEGIN
[0m07:53:04.610474 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:53:04.618517 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m07:53:04.619143 [debug] [MainThread]: On master: COMMIT
[0m07:53:04.619750 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:04.620239 [debug] [MainThread]: On master: COMMIT
[0m07:53:04.620973 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:53:04.621682 [debug] [MainThread]: On master: Close
[0m07:53:04.622572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:53:04.623142 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m07:53:04.623726 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m07:53:04.624389 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m07:53:04.625321 [info ] [MainThread]: 
[0m07:53:04.626708 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m07:53:04.628473 [debug] [MainThread]: Command end result
[0m07:53:04.660790 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m07:53:04.663369 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m07:53:04.675062 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m07:53:04.676413 [info ] [MainThread]: 
[0m07:53:04.677895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:53:04.678786 [info ] [MainThread]: 
[0m07:53:04.679650 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:53:04.681019 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2305846, "process_in_blocks": "35536", "process_kernel_time": 0.276539, "process_mem_max_rss": "115152", "process_out_blocks": "2648", "process_user_time": 3.980768}
[0m07:53:04.681773 [debug] [MainThread]: Command `dbt run` succeeded at 07:53:04.681636 after 2.23 seconds
[0m07:53:04.682384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73153e5d5180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73153f5b1ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73153e49c970>]}
[0m07:53:04.682964 [debug] [MainThread]: Flushing usage events
[0m07:53:05.830983 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:12.930828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ea8661180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ea9536680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ea9536620>]}


============================== 20:50:12.935170 | 73e05c3e-af8b-4edb-94f7-9815654c8875 ==============================
[0m20:50:12.935170 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:50:12.936006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:50:13.158860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73e05c3e-af8b-4edb-94f7-9815654c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ea9681ed0>]}
[0m20:50:13.250676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73e05c3e-af8b-4edb-94f7-9815654c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ea949e8f0>]}
[0m20:50:13.251950 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:50:13.385032 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:50:13.550700 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:50:13.551484 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:50:13.559696 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m20:50:13.606591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73e05c3e-af8b-4edb-94f7-9815654c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ea695c130>]}
[0m20:50:13.720433 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m20:50:13.724365 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m20:50:13.739073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73e05c3e-af8b-4edb-94f7-9815654c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ea696c2e0>]}
[0m20:50:13.739823 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m20:50:13.740356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73e05c3e-af8b-4edb-94f7-9815654c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ea696c370>]}
[0m20:50:13.742529 [info ] [MainThread]: 
[0m20:50:13.743229 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:50:13.743817 [info ] [MainThread]: 
[0m20:50:13.744603 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:50:13.751004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:50:13.807962 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:50:13.808850 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:50:13.809585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:13.820111 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m20:50:13.822466 [debug] [ThreadPool]: On list_foo: Close
[0m20:50:13.824973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m20:50:13.834408 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m20:50:13.835234 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m20:50:13.835741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:13.844637 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m20:50:13.845248 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m20:50:13.845748 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m20:50:13.849897 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m20:50:13.852000 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m20:50:13.852878 [debug] [ThreadPool]: On list_foo_zap: Close
[0m20:50:13.859866 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:13.860472 [debug] [MainThread]: On master: BEGIN
[0m20:50:13.860944 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:13.870522 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:50:13.871505 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:13.872557 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:50:13.877305 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:50:13.879488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73e05c3e-af8b-4edb-94f7-9815654c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ea736b310>]}
[0m20:50:13.880265 [debug] [MainThread]: On master: ROLLBACK
[0m20:50:13.881023 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:13.881701 [debug] [MainThread]: On master: BEGIN
[0m20:50:13.882861 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:50:13.883681 [debug] [MainThread]: On master: COMMIT
[0m20:50:13.884231 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:13.884808 [debug] [MainThread]: On master: COMMIT
[0m20:50:13.885551 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:50:13.886103 [debug] [MainThread]: On master: Close
[0m20:50:13.888885 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m20:50:13.889569 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:50:13.890203 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m20:50:13.890948 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m20:50:13.891865 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m20:50:13.892867 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m20:50:13.893772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m20:50:13.894630 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m20:50:13.895437 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m20:50:13.896081 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m20:50:13.896652 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:50:13.897243 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m20:50:13.912002 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:50:13.914696 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:50:13.919913 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m20:50:13.921353 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m20:50:13.927149 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:50:13.938258 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m20:50:14.041517 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:50:14.042309 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m20:50:14.046192 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:50:14.047650 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:50:14.048550 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:50:14.049610 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:50:14.050453 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m20:50:14.051129 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m20:50:14.051996 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m20:50:14.052654 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:50:14.053231 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:50:14.053774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:14.061636 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m20:50:14.062390 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m20:50:14.062988 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:50:14.063686 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:50:14.064461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m20:50:14.065394 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m20:50:14.066758 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m20:50:14.067684 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:50:14.068819 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m20:50:14.071267 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:50:14.072034 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:50:14.081553 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:50:14.082672 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m20:50:14.087915 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:50:14.088631 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m20:50:14.094315 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:50:14.094981 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m20:50:14.095675 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m20:50:14.096352 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:50:14.102683 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:50:14.136268 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m20:50:14.137190 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.040 seconds
[0m20:50:14.139366 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m20:50:14.140104 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:50:14.143038 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m20:50:14.144184 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:50:14.145013 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m20:50:14.145651 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:50:14.146218 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m20:50:14.147088 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m20:50:14.147998 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m20:50:14.149318 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m20:50:14.150445 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:50:14.159780 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m20:50:14.164623 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m20:50:14.171086 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m20:50:14.235346 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:50:14.237173 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:50:14.239083 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:50:14.239957 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m20:50:14.241351 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m20:50:14.242647 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m20:50:14.243619 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:50:14.247069 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m20:50:14.247950 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m20:50:14.249348 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m20:50:14.254235 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m20:50:14.256524 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m20:50:14.257147 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73e05c3e-af8b-4edb-94f7-9815654c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ea9682e60>]}
[0m20:50:14.258335 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.36s]
[0m20:50:14.259558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73e05c3e-af8b-4edb-94f7-9815654c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ea6ea76a0>]}
[0m20:50:14.260713 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73e05c3e-af8b-4edb-94f7-9815654c8875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ea5d2ab00>]}
[0m20:50:14.261808 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m20:50:14.262925 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.37s]
[0m20:50:14.264008 [info ] [Thread-2 (]: 2 of 3 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.37s]
[0m20:50:14.265416 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m20:50:14.266522 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:50:14.268813 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:14.269490 [debug] [MainThread]: On master: BEGIN
[0m20:50:14.270042 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:14.279115 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:50:14.280127 [debug] [MainThread]: On master: COMMIT
[0m20:50:14.281094 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:14.282273 [debug] [MainThread]: On master: COMMIT
[0m20:50:14.283372 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:50:14.284148 [debug] [MainThread]: On master: Close
[0m20:50:14.285232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:14.285803 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m20:50:14.286284 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m20:50:14.286747 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m20:50:14.287315 [info ] [MainThread]: 
[0m20:50:14.287960 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m20:50:14.289307 [debug] [MainThread]: Command end result
[0m20:50:14.315032 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m20:50:14.318291 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m20:50:14.326900 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m20:50:14.327521 [info ] [MainThread]: 
[0m20:50:14.328128 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:50:14.328696 [info ] [MainThread]: 
[0m20:50:14.329247 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:50:14.330484 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4774963, "process_in_blocks": "0", "process_kernel_time": 0.191301, "process_mem_max_rss": "112068", "process_out_blocks": "1808", "process_user_time": 2.889452}
[0m20:50:14.331187 [debug] [MainThread]: Command `dbt run` succeeded at 20:50:14.331059 after 1.48 seconds
[0m20:50:14.332036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ea8661180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ea8538ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0ea7e90a90>]}
[0m20:50:14.332954 [debug] [MainThread]: Flushing usage events
[0m20:50:16.374389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:26.258506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa097c95090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa098b6e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa098b6e500>]}


============================== 10:52:26.264656 | 0e289ccb-47d0-4eac-85d7-dbdc4bf5a7b0 ==============================
[0m10:52:26.264656 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:52:26.266761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:52:26.698391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e289ccb-47d0-4eac-85d7-dbdc4bf5a7b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa098b570d0>]}
[0m10:52:26.861332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e289ccb-47d0-4eac-85d7-dbdc4bf5a7b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa09747fbe0>]}
[0m10:52:26.862836 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:52:27.072942 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:52:27.312539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:52:27.313157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:52:27.323525 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m10:52:27.388872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e289ccb-47d0-4eac-85d7-dbdc4bf5a7b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa09605c130>]}
[0m10:52:27.532817 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:52:27.539239 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:52:27.569191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e289ccb-47d0-4eac-85d7-dbdc4bf5a7b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa0960442e0>]}
[0m10:52:27.570286 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m10:52:27.571012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e289ccb-47d0-4eac-85d7-dbdc4bf5a7b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa098300ca0>]}
[0m10:52:27.573414 [info ] [MainThread]: 
[0m10:52:27.574199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:52:27.574883 [info ] [MainThread]: 
[0m10:52:27.576112 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:52:27.583619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m10:52:27.650429 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m10:52:27.651465 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m10:52:27.652401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:27.662382 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m10:52:27.664226 [debug] [ThreadPool]: On list_foo: Close
[0m10:52:27.667381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m10:52:27.677962 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:52:27.678619 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m10:52:27.679184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:27.689118 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m10:52:27.689738 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:52:27.690229 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m10:52:27.704247 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m10:52:27.706159 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m10:52:27.707095 [debug] [ThreadPool]: On list_foo_zap: Close
[0m10:52:27.714157 [debug] [MainThread]: Using postgres connection "master"
[0m10:52:27.714770 [debug] [MainThread]: On master: BEGIN
[0m10:52:27.715227 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:52:27.725148 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m10:52:27.726137 [debug] [MainThread]: Using postgres connection "master"
[0m10:52:27.727231 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:52:27.732192 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m10:52:27.736100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e289ccb-47d0-4eac-85d7-dbdc4bf5a7b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa096097400>]}
[0m10:52:27.737153 [debug] [MainThread]: On master: ROLLBACK
[0m10:52:27.738149 [debug] [MainThread]: Using postgres connection "master"
[0m10:52:27.738913 [debug] [MainThread]: On master: BEGIN
[0m10:52:27.739929 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:52:27.740593 [debug] [MainThread]: On master: COMMIT
[0m10:52:27.741151 [debug] [MainThread]: Using postgres connection "master"
[0m10:52:27.741748 [debug] [MainThread]: On master: COMMIT
[0m10:52:27.742636 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:52:27.743262 [debug] [MainThread]: On master: Close
[0m10:52:27.746474 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m10:52:27.747593 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m10:52:27.749764 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m10:52:27.748900 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m10:52:27.752216 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m10:52:27.753590 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m10:52:27.754632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m10:52:27.755620 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m10:52:27.756700 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m10:52:27.757549 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m10:52:27.758356 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m10:52:27.760001 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m10:52:27.779900 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:52:27.785999 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:52:27.797129 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m10:52:27.801208 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m10:52:27.803557 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m10:52:27.868170 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m10:52:27.955865 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:52:27.957311 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m10:52:27.961550 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:52:27.963277 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:52:27.964848 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:52:27.966166 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m10:52:27.968007 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:52:27.969839 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m10:52:27.971393 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:52:27.972523 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m10:52:27.973636 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:52:27.974775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:27.986940 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m10:52:27.988743 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:52:27.990180 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m10:52:27.992025 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m10:52:27.995207 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:52:27.997298 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m10:52:27.998856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m10:52:28.000245 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:52:28.001680 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m10:52:28.003236 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:52:28.018456 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m10:52:28.019926 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m10:52:28.047851 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:52:28.049852 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:52:28.051482 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m10:52:28.055696 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:52:28.057022 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m10:52:28.058680 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m10:52:28.060066 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:52:28.070251 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:52:28.071932 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:52:28.124527 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m10:52:28.125445 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m10:52:28.126410 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m10:52:28.127271 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:52:28.128404 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:52:28.129489 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:52:28.130580 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m10:52:28.131524 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m10:52:28.132342 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m10:52:28.135723 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m10:52:28.136983 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m10:52:28.138005 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:52:28.157321 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m10:52:28.164139 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m10:52:28.166674 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m10:52:28.273582 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:52:28.271667 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:52:28.275723 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:52:28.277235 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m10:52:28.278494 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m10:52:28.279404 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m10:52:28.280751 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:52:28.289815 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m10:52:28.297551 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.017 seconds
[0m10:52:28.302810 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m10:52:28.304502 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m10:52:28.308904 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m10:52:28.316184 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e289ccb-47d0-4eac-85d7-dbdc4bf5a7b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa098cbad70>]}
[0m10:52:28.321002 [info ] [Thread-2 (]: 2 of 3 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.56s]
[0m10:52:28.318491 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e289ccb-47d0-4eac-85d7-dbdc4bf5a7b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa09547a560>]}
[0m10:52:28.324700 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m10:52:28.327108 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.56s]
[0m10:52:28.329610 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m10:52:28.331068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e289ccb-47d0-4eac-85d7-dbdc4bf5a7b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa09547a830>]}
[0m10:52:28.332417 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.58s]
[0m10:52:28.335842 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m10:52:28.342931 [debug] [MainThread]: Using postgres connection "master"
[0m10:52:28.344352 [debug] [MainThread]: On master: BEGIN
[0m10:52:28.345755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:52:28.359911 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m10:52:28.361120 [debug] [MainThread]: On master: COMMIT
[0m10:52:28.362190 [debug] [MainThread]: Using postgres connection "master"
[0m10:52:28.363070 [debug] [MainThread]: On master: COMMIT
[0m10:52:28.363973 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:52:28.364634 [debug] [MainThread]: On master: Close
[0m10:52:28.365565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:28.366438 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m10:52:28.367770 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m10:52:28.369173 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m10:52:28.370670 [info ] [MainThread]: 
[0m10:52:28.371925 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m10:52:28.374335 [debug] [MainThread]: Command end result
[0m10:52:28.415811 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:52:28.420476 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:52:28.440288 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m10:52:28.441513 [info ] [MainThread]: 
[0m10:52:28.443013 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:52:28.444452 [info ] [MainThread]: 
[0m10:52:28.445881 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:52:28.448533 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3491879, "process_in_blocks": "35056", "process_kernel_time": 0.328617, "process_mem_max_rss": "111652", "process_out_blocks": "1808", "process_user_time": 4.403471}
[0m10:52:28.449617 [debug] [MainThread]: Command `dbt run` succeeded at 10:52:28.449319 after 2.35 seconds
[0m10:52:28.451306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa097c95090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa097b4f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa09605e590>]}
[0m10:52:28.452865 [debug] [MainThread]: Flushing usage events
[0m10:52:29.236729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:02:13.852784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daac407d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daac4f22650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daac4f225f0>]}


============================== 16:02:13.856478 | 164ecb84-8fd7-40d5-8eea-6b56bb6344ba ==============================
[0m16:02:13.856478 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:02:13.857500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:02:14.140439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '164ecb84-8fd7-40d5-8eea-6b56bb6344ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daac4f0b190>]}
[0m16:02:14.253169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '164ecb84-8fd7-40d5-8eea-6b56bb6344ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daac3dfc850>]}
[0m16:02:14.254376 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:02:14.411031 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:02:14.623918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:02:14.624709 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:02:14.635239 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m16:02:14.693442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '164ecb84-8fd7-40d5-8eea-6b56bb6344ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daac233c130>]}
[0m16:02:14.837333 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m16:02:14.842139 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m16:02:14.858369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '164ecb84-8fd7-40d5-8eea-6b56bb6344ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daac234cac0>]}
[0m16:02:14.859152 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m16:02:14.859762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '164ecb84-8fd7-40d5-8eea-6b56bb6344ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daac234c3a0>]}
[0m16:02:14.861967 [info ] [MainThread]: 
[0m16:02:14.862958 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:02:14.864073 [info ] [MainThread]: 
[0m16:02:14.865434 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:14.872357 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m16:02:14.926174 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m16:02:14.926818 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m16:02:14.927294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:14.938509 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m16:02:14.941475 [debug] [ThreadPool]: On list_foo: Close
[0m16:02:14.943635 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m16:02:14.953626 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m16:02:14.954301 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m16:02:14.954843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:14.964553 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m16:02:14.965404 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m16:02:14.966024 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m16:02:14.971378 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m16:02:14.975079 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m16:02:14.976763 [debug] [ThreadPool]: On list_foo_zap: Close
[0m16:02:14.993657 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:14.995039 [debug] [MainThread]: On master: BEGIN
[0m16:02:14.996282 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:15.012831 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m16:02:15.014150 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:15.015526 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:02:15.023103 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m16:02:15.025931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '164ecb84-8fd7-40d5-8eea-6b56bb6344ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daac2373760>]}
[0m16:02:15.027078 [debug] [MainThread]: On master: ROLLBACK
[0m16:02:15.028742 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:15.029824 [debug] [MainThread]: On master: BEGIN
[0m16:02:15.031073 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:02:15.031905 [debug] [MainThread]: On master: COMMIT
[0m16:02:15.032818 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:15.033615 [debug] [MainThread]: On master: COMMIT
[0m16:02:15.034508 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:02:15.035192 [debug] [MainThread]: On master: Close
[0m16:02:15.038876 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m16:02:15.041075 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m16:02:15.042710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m16:02:15.045900 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m16:02:15.044471 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m16:02:15.054896 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m16:02:15.061103 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m16:02:15.064899 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m16:02:15.066239 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m16:02:15.067397 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m16:02:15.068599 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m16:02:15.069530 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m16:02:15.070192 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m16:02:15.070817 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m16:02:15.075754 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m16:02:15.080626 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m16:02:15.125023 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m16:02:15.125765 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m16:02:15.144197 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m16:02:15.146979 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m16:02:15.154652 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m16:02:15.156921 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m16:02:15.158086 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m16:02:15.159081 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m16:02:15.159843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:15.160628 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m16:02:15.161421 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m16:02:15.162502 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m16:02:15.163574 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:02:15.164783 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:02:15.171228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m16:02:15.172187 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m16:02:15.172896 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m16:02:15.173994 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m16:02:15.174843 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m16:02:15.175604 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m16:02:15.176347 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m16:02:15.177045 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:02:15.177716 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m16:02:15.184125 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m16:02:15.193084 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m16:02:15.193956 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m16:02:15.200892 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m16:02:15.201759 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m16:02:15.202587 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m16:02:15.203951 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:02:15.204728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:02:15.210674 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m16:02:15.239417 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m16:02:15.242497 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m16:02:15.250021 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m16:02:15.250833 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m16:02:15.251643 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m16:02:15.252462 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m16:02:15.253411 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m16:02:15.254212 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m16:02:15.255925 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:02:15.259077 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m16:02:15.260120 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:02:15.261414 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m16:02:15.262644 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m16:02:15.274225 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m16:02:15.275045 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m16:02:15.279676 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m16:02:15.289181 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m16:02:15.290275 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m16:02:15.292236 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m16:02:15.292920 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m16:02:15.298516 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m16:02:15.299412 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m16:02:15.301115 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m16:02:15.302083 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:02:15.303002 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m16:02:15.304019 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:02:15.307660 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m16:02:15.311032 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m16:02:15.311750 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:02:15.315277 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m16:02:15.319660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '164ecb84-8fd7-40d5-8eea-6b56bb6344ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daac1c97550>]}
[0m16:02:15.320909 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '164ecb84-8fd7-40d5-8eea-6b56bb6344ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daac1c96620>]}
[0m16:02:15.321624 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '164ecb84-8fd7-40d5-8eea-6b56bb6344ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daac1c03d30>]}
[0m16:02:15.323203 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.27s]
[0m16:02:15.324593 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.25s]
[0m16:02:15.325793 [info ] [Thread-2 (]: 2 of 3 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.25s]
[0m16:02:15.327030 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m16:02:15.328120 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m16:02:15.329178 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m16:02:15.331687 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:15.332495 [debug] [MainThread]: On master: BEGIN
[0m16:02:15.333028 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:15.342295 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m16:02:15.343581 [debug] [MainThread]: On master: COMMIT
[0m16:02:15.344301 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:15.344774 [debug] [MainThread]: On master: COMMIT
[0m16:02:15.345623 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:02:15.346788 [debug] [MainThread]: On master: Close
[0m16:02:15.348409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:15.349634 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m16:02:15.350472 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m16:02:15.351160 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m16:02:15.352095 [info ] [MainThread]: 
[0m16:02:15.352789 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m16:02:15.354165 [debug] [MainThread]: Command end result
[0m16:02:15.461733 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m16:02:15.464881 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m16:02:15.475275 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m16:02:15.475912 [info ] [MainThread]: 
[0m16:02:15.476549 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:02:15.477097 [info ] [MainThread]: 
[0m16:02:15.477690 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:02:15.479014 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.734438, "process_in_blocks": "0", "process_kernel_time": 0.208769, "process_mem_max_rss": "111160", "process_out_blocks": "1808", "process_user_time": 3.363287}
[0m16:02:15.480143 [debug] [MainThread]: Command `dbt run` succeeded at 16:02:15.479896 after 1.74 seconds
[0m16:02:15.480974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daac407d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daac23666b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7daac27700d0>]}
[0m16:02:15.482008 [debug] [MainThread]: Flushing usage events
[0m16:02:16.330671 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:10:32.003163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5bfcbd50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5bfda6a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5bfda6a530>]}


============================== 09:10:32.007910 | 1972589d-f9f1-4aae-b328-763176fe7dd5 ==============================
[0m09:10:32.007910 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:10:32.008961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:10:32.240902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1972589d-f9f1-4aae-b328-763176fe7dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5bfbbe6da0>]}
[0m09:10:32.329494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1972589d-f9f1-4aae-b328-763176fe7dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5bfc2e7e20>]}
[0m09:10:32.331783 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:10:32.474015 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:10:32.661654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:10:32.662307 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:10:32.671368 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m09:10:32.722959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1972589d-f9f1-4aae-b328-763176fe7dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5bfae50130>]}
[0m09:10:32.866616 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:10:32.871034 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:10:32.898701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1972589d-f9f1-4aae-b328-763176fe7dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5bfae385b0>]}
[0m09:10:32.899452 [info ] [MainThread]: Found 3 models, 1 source, 431 macros
[0m09:10:32.900026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1972589d-f9f1-4aae-b328-763176fe7dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5bfd23d420>]}
[0m09:10:32.902353 [info ] [MainThread]: 
[0m09:10:32.903385 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:10:32.904384 [info ] [MainThread]: 
[0m09:10:32.905705 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:10:32.913302 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m09:10:32.974600 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m09:10:32.975216 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m09:10:32.975694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:10:32.986721 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m09:10:32.988619 [debug] [ThreadPool]: On list_foo: Close
[0m09:10:32.991415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m09:10:33.005517 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:10:33.006785 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m09:10:33.008733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:10:33.018898 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m09:10:33.020227 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:10:33.021478 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m09:10:33.039091 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m09:10:33.041579 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m09:10:33.042574 [debug] [ThreadPool]: On list_foo_zap: Close
[0m09:10:33.049249 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:33.049898 [debug] [MainThread]: On master: BEGIN
[0m09:10:33.050366 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:10:33.059477 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:10:33.060118 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:33.060697 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:10:33.066067 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m09:10:33.069492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1972589d-f9f1-4aae-b328-763176fe7dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5bfda0d810>]}
[0m09:10:33.070782 [debug] [MainThread]: On master: ROLLBACK
[0m09:10:33.071684 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:33.072260 [debug] [MainThread]: On master: BEGIN
[0m09:10:33.073108 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:10:33.073709 [debug] [MainThread]: On master: COMMIT
[0m09:10:33.074233 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:33.074750 [debug] [MainThread]: On master: COMMIT
[0m09:10:33.075490 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:10:33.076099 [debug] [MainThread]: On master: Close
[0m09:10:33.078960 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m09:10:33.079830 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m09:10:33.080538 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m09:10:33.081439 [info ] [Thread-1 (]: 1 of 3 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m09:10:33.082594 [info ] [Thread-2 (]: 2 of 3 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m09:10:33.083693 [info ] [Thread-3 (]: 3 of 3 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m09:10:33.084690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m09:10:33.086243 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m09:10:33.087715 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m09:10:33.088600 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m09:10:33.089414 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m09:10:33.090244 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m09:10:33.109195 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:10:33.106134 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:10:33.116442 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m09:10:33.117965 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m09:10:33.129356 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m09:10:33.135368 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m09:10:33.224376 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:10:33.226946 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m09:10:33.232671 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:10:33.234309 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:10:33.235848 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m09:10:33.236926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:10:33.238317 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:10:33.239207 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m09:10:33.240088 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:10:33.241059 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:10:33.241840 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m09:10:33.242703 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:10:33.246146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:10:33.246905 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:10:33.248062 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m09:10:33.251712 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m09:10:33.253585 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:10:33.254656 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m09:10:33.255435 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m09:10:33.256147 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:10:33.256903 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m09:10:33.260096 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m09:10:33.261005 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m09:10:33.262218 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:10:33.271640 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:10:33.276076 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:10:33.282009 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:10:33.282933 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m09:10:33.284273 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m09:10:33.285704 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m09:10:33.287610 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:10:33.288417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:10:33.289002 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:10:33.331697 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m09:10:33.336729 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m09:10:33.341753 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m09:10:33.342658 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:10:33.343602 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:10:33.344200 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:10:33.344824 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m09:10:33.345435 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m09:10:33.346243 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m09:10:33.349098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:10:33.350186 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:10:33.351247 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m09:10:33.361480 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m09:10:33.366180 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m09:10:33.372943 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m09:10:33.379477 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:10:33.381919 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:10:33.383538 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:10:33.384434 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m09:10:33.386428 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m09:10:33.387924 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m09:10:33.389053 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:10:33.389743 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:10:33.393095 [debug] [Thread-3 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m09:10:33.393943 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m09:10:33.396451 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m09:10:33.399438 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m09:10:33.405880 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1972589d-f9f1-4aae-b328-763176fe7dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5bfdbb2dd0>]}
[0m09:10:33.406561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1972589d-f9f1-4aae-b328-763176fe7dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5bfa230fd0>]}
[0m09:10:33.407577 [info ] [Thread-3 (]: 3 of 3 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.31s]
[0m09:10:33.408336 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1972589d-f9f1-4aae-b328-763176fe7dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5bfa233fd0>]}
[0m09:10:33.409884 [info ] [Thread-1 (]: 1 of 3 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.32s]
[0m09:10:33.410844 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m09:10:33.411851 [info ] [Thread-2 (]: 2 of 3 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.32s]
[0m09:10:33.412785 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m09:10:33.413839 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m09:10:33.415705 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:33.416302 [debug] [MainThread]: On master: BEGIN
[0m09:10:33.416796 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:10:33.426523 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:10:33.427155 [debug] [MainThread]: On master: COMMIT
[0m09:10:33.427659 [debug] [MainThread]: Using postgres connection "master"
[0m09:10:33.428115 [debug] [MainThread]: On master: COMMIT
[0m09:10:33.428785 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:10:33.429313 [debug] [MainThread]: On master: Close
[0m09:10:33.430073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:10:33.430665 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m09:10:33.431115 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m09:10:33.431539 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m09:10:33.432149 [info ] [MainThread]: 
[0m09:10:33.432720 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m09:10:33.434260 [debug] [MainThread]: Command end result
[0m09:10:33.533094 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:10:33.535269 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:10:33.546036 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m09:10:33.546727 [info ] [MainThread]: 
[0m09:10:33.547636 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:10:33.548519 [info ] [MainThread]: 
[0m09:10:33.549564 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:10:33.551161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6304514, "process_in_blocks": "36800", "process_kernel_time": 0.254949, "process_mem_max_rss": "111468", "process_out_blocks": "1808", "process_user_time": 3.128646}
[0m09:10:33.552685 [debug] [MainThread]: Command `dbt run` succeeded at 09:10:33.552174 after 1.63 seconds
[0m09:10:33.554170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5bfcbd50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5bfca8afb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5bfa24b970>]}
[0m09:10:33.555791 [debug] [MainThread]: Flushing usage events
[0m09:10:34.673919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:39:47.420520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7150f7460e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7150f8336320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7150f83362c0>]}


============================== 09:39:47.425055 | 2e883e17-839f-496e-ba5d-007b2778f478 ==============================
[0m09:39:47.425055 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:39:47.426186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:39:47.736570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e883e17-839f-496e-ba5d-007b2778f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7150f82e3970>]}
[0m09:39:47.852779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e883e17-839f-496e-ba5d-007b2778f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7150f67786d0>]}
[0m09:39:47.854159 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:39:48.049446 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:39:48.274212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:39:48.275213 [debug] [MainThread]: Partial parsing: added file: zap_imoveis://models/mart/gold_floorsize_ranked_avg_prices.sql
[0m09:39:48.768746 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m09:39:48.800038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e883e17-839f-496e-ba5d-007b2778f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7150f56ea5c0>]}
[0m09:39:48.954899 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:39:48.960481 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:39:48.981374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e883e17-839f-496e-ba5d-007b2778f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7150f5bdee00>]}
[0m09:39:48.982401 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m09:39:48.983175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e883e17-839f-496e-ba5d-007b2778f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7150f77011b0>]}
[0m09:39:48.986146 [info ] [MainThread]: 
[0m09:39:48.987014 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:39:48.987836 [info ] [MainThread]: 
[0m09:39:48.989055 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:39:49.002785 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m09:39:49.067808 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m09:39:49.068629 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m09:39:49.069280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:39:49.083861 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m09:39:49.086202 [debug] [ThreadPool]: On list_foo: Close
[0m09:39:49.089534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m09:39:49.101598 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:39:49.102421 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m09:39:49.103063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:39:49.115240 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m09:39:49.116244 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:39:49.116934 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m09:39:49.121673 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m09:39:49.124163 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m09:39:49.125242 [debug] [ThreadPool]: On list_foo_zap: Close
[0m09:39:49.135979 [debug] [MainThread]: Using postgres connection "master"
[0m09:39:49.136792 [debug] [MainThread]: On master: BEGIN
[0m09:39:49.137427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:39:49.149260 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:39:49.150275 [debug] [MainThread]: Using postgres connection "master"
[0m09:39:49.151328 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:39:49.157802 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m09:39:49.161611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e883e17-839f-496e-ba5d-007b2778f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7150f86cf370>]}
[0m09:39:49.162524 [debug] [MainThread]: On master: ROLLBACK
[0m09:39:49.163564 [debug] [MainThread]: Using postgres connection "master"
[0m09:39:49.164336 [debug] [MainThread]: On master: BEGIN
[0m09:39:49.165504 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:39:49.166247 [debug] [MainThread]: On master: COMMIT
[0m09:39:49.166915 [debug] [MainThread]: Using postgres connection "master"
[0m09:39:49.167555 [debug] [MainThread]: On master: COMMIT
[0m09:39:49.168559 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:39:49.169307 [debug] [MainThread]: On master: Close
[0m09:39:49.173491 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m09:39:49.174501 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m09:39:49.175594 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m09:39:49.176626 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m09:39:49.177987 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m09:39:49.179260 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m09:39:49.180607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m09:39:49.182306 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m09:39:49.184697 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m09:39:49.186126 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m09:39:49.187323 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m09:39:49.188640 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m09:39:49.189732 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m09:39:49.191274 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m09:39:49.202981 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m09:39:49.210341 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:39:49.218785 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:39:49.220666 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m09:39:49.289943 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m09:39:49.291379 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m09:39:49.297923 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m09:39:49.299043 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m09:39:49.337987 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m09:39:49.360242 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m09:39:49.471316 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:39:49.476278 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:39:49.480708 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m09:39:49.483154 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m09:39:49.484224 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:39:49.486299 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m09:39:49.487267 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m09:39:49.488396 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:39:49.489968 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:39:49.491053 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m09:39:49.492105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:39:49.493244 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m09:39:49.494176 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m09:39:49.495266 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:39:49.496730 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:39:49.498003 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:39:49.509356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m09:39:49.510495 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:39:49.511615 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m09:39:49.512647 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m09:39:49.513666 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m09:39:49.514527 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m09:39:49.515362 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m09:39:49.517048 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:39:49.518541 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size <= 30
		then 'E'
		when sz.floor_size > 30 and sz.floor_size <= 45
		then 'D'
		when sz.floor_size > 45 and sz.floor_size <= 60
		then 'C'
		when sz.floor_size > 60 and sz.floor_size <= 75
		then 'B'
		when sz.floor_size > 75 and sz.floor_size <= 100
		then 'A'
	end as floor_size_rank
	from source sz 
)
select 
kind, neighborhood, floor_size_rank,
avg(price_rent) as price_rent_avg, 
avg(price_sale) as price_sale_avg, avg(price_condominium) as price_cond_avg, avg(rent_plus_condo) as rent_plus_condo_avg, 
avg(floor_size) as floor_size_avg, avg(rooms) as rooms_avg, avg(suites) as suites_avg, avg(bathrooms) as bathrooms_avg,
avg(price_rent)/avg(floor_size) as price_rent_per_m2_avg
from rank_floorsize 
where floor_size_rank is not null
and floor_size != 0
group by kind, neighborhood, floor_size_rank
order by kind, neighborhood , floor_size_rank
  );
[0m09:39:49.519717 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:39:49.520851 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m09:39:49.521869 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m09:39:49.523224 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m09:39:49.529961 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:39:49.536602 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:39:49.539931 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:39:49.546958 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m09:39:49.548119 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m09:39:49.556053 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:39:49.556949 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m09:39:49.558179 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m09:39:49.565378 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:39:49.566544 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices" rename to "gold_house_avg_prices__dbt_backup"
[0m09:39:49.568748 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices" rename to "gold_flat_kit_studio_avg_prices__dbt_backup"
[0m09:39:49.569826 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:39:49.570714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:39:49.582475 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m09:39:49.596180 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:39:49.599598 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:39:49.600472 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m09:39:49.607760 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m09:39:49.623724 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m09:39:49.625806 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m09:39:49.632523 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:39:49.634813 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:39:49.636572 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m09:39:49.637676 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:39:49.645028 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m09:39:49.646159 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m09:39:49.647662 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m09:39:49.651181 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m09:39:49.652403 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:39:49.654132 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:39:49.655427 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:39:49.656476 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m09:39:49.657376 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:39:49.658189 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m09:39:49.661730 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m09:39:49.668536 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m09:39:49.676848 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m09:39:49.678015 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:39:49.683699 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m09:39:49.690581 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m09:39:49.695344 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m09:39:49.696217 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m09:39:49.698732 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:39:49.704025 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m09:39:49.705454 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m09:39:49.707728 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m09:39:49.710730 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:39:49.711975 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m09:39:49.713958 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m09:39:49.715030 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:39:49.721575 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m09:39:49.723173 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m09:39:49.728914 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m09:39:49.732507 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m09:39:49.733315 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m09:39:49.736221 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:39:49.739766 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m09:39:49.743948 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m09:39:49.745207 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e883e17-839f-496e-ba5d-007b2778f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7150f8486b30>]}
[0m09:39:49.746348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e883e17-839f-496e-ba5d-007b2778f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7150f6c69c00>]}
[0m09:39:49.748252 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e883e17-839f-496e-ba5d-007b2778f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7150f678f790>]}
[0m09:39:49.750467 [info ] [Thread-3 (]: 3 of 4 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.55s]
[0m09:39:49.752174 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.56s]
[0m09:39:49.753396 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m09:39:49.755009 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.56s]
[0m09:39:49.756516 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m09:39:49.758221 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m09:39:49.761941 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m09:39:49.763713 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m09:39:49.766064 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e883e17-839f-496e-ba5d-007b2778f478', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7150f82e16f0>]}
[0m09:39:49.768540 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.57s]
[0m09:39:49.770080 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m09:39:49.772828 [debug] [MainThread]: Using postgres connection "master"
[0m09:39:49.773789 [debug] [MainThread]: On master: BEGIN
[0m09:39:49.774450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:39:49.786743 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m09:39:49.787657 [debug] [MainThread]: On master: COMMIT
[0m09:39:49.788452 [debug] [MainThread]: Using postgres connection "master"
[0m09:39:49.789186 [debug] [MainThread]: On master: COMMIT
[0m09:39:49.790215 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:39:49.791191 [debug] [MainThread]: On master: Close
[0m09:39:49.792258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:39:49.792991 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m09:39:49.793663 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m09:39:49.794279 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m09:39:49.794895 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m09:39:49.795686 [info ] [MainThread]: 
[0m09:39:49.796500 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m09:39:49.798838 [debug] [MainThread]: Command end result
[0m09:39:49.844932 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:39:49.847895 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:39:49.861485 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m09:39:49.862327 [info ] [MainThread]: 
[0m09:39:49.863328 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:39:49.864224 [info ] [MainThread]: 
[0m09:39:49.865053 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:39:49.866997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.554249, "process_in_blocks": "480", "process_kernel_time": 0.274873, "process_mem_max_rss": "115916", "process_out_blocks": "2704", "process_user_time": 4.508922}
[0m09:39:49.868180 [debug] [MainThread]: Command `dbt run` succeeded at 09:39:49.867861 after 2.56 seconds
[0m09:39:49.869324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7150f7460e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7150f7aa5c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7150f4a34fd0>]}
[0m09:39:49.870412 [debug] [MainThread]: Flushing usage events
[0m09:39:51.120123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:44:40.553269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4f91cd4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4f92b6a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4f92b6a260>]}


============================== 09:44:40.557800 | a15cf743-7e82-4865-974b-830340da949d ==============================
[0m09:44:40.557800 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:44:40.559100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:44:40.870325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a15cf743-7e82-4865-974b-830340da949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4f910055a0>]}
[0m09:44:40.981062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a15cf743-7e82-4865-974b-830340da949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4f913e7b50>]}
[0m09:44:40.982465 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:44:41.179170 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:44:41.401979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:44:41.403111 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_floorsize_ranked_avg_prices.sql
[0m09:44:41.884973 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m09:44:41.916432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a15cf743-7e82-4865-974b-830340da949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4f8ffe6620>]}
[0m09:44:42.075758 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:44:42.081518 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:44:42.099123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a15cf743-7e82-4865-974b-830340da949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4f8ffe69e0>]}
[0m09:44:42.100144 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m09:44:42.100878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a15cf743-7e82-4865-974b-830340da949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4f8ffe6a40>]}
[0m09:44:42.103923 [info ] [MainThread]: 
[0m09:44:42.104773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:44:42.105479 [info ] [MainThread]: 
[0m09:44:42.106588 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:44:42.117783 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m09:44:42.181931 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m09:44:42.182741 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m09:44:42.183415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:42.197575 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m09:44:42.199912 [debug] [ThreadPool]: On list_foo: Close
[0m09:44:42.203444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m09:44:42.215398 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:44:42.216246 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m09:44:42.216921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:42.230149 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m09:44:42.231196 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m09:44:42.231912 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m09:44:42.237173 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m09:44:42.240766 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m09:44:42.241868 [debug] [ThreadPool]: On list_foo_zap: Close
[0m09:44:42.252221 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:42.253031 [debug] [MainThread]: On master: BEGIN
[0m09:44:42.253685 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:42.267312 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:44:42.268506 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:42.270043 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:44:42.276676 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m09:44:42.280933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a15cf743-7e82-4865-974b-830340da949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4f8ff47a30>]}
[0m09:44:42.281824 [debug] [MainThread]: On master: ROLLBACK
[0m09:44:42.282824 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:42.283542 [debug] [MainThread]: On master: BEGIN
[0m09:44:42.284768 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:44:42.285493 [debug] [MainThread]: On master: COMMIT
[0m09:44:42.286167 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:42.286890 [debug] [MainThread]: On master: COMMIT
[0m09:44:42.287955 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:44:42.288717 [debug] [MainThread]: On master: Close
[0m09:44:42.292697 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m09:44:42.294128 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m09:44:42.295184 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m09:44:42.296237 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m09:44:42.297263 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m09:44:42.298605 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m09:44:42.299650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m09:44:42.300990 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m09:44:42.302844 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m09:44:42.304388 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m09:44:42.305797 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m09:44:42.307272 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m09:44:42.308682 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m09:44:42.310138 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m09:44:42.321952 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m09:44:42.328280 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:44:42.337484 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:44:42.338639 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m09:44:42.407317 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m09:44:42.414228 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m09:44:42.415543 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m09:44:42.416777 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m09:44:42.417720 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m09:44:42.500167 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m09:44:42.605285 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m09:44:42.613940 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:44:42.619381 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:44:42.628337 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m09:44:42.629993 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:44:42.631116 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m09:44:42.632488 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:44:42.633373 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m09:44:42.634306 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m09:44:42.635758 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:44:42.637229 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m09:44:42.638708 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:44:42.639649 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:44:42.641315 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m09:44:42.642945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:42.645557 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:44:42.655745 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m09:44:42.656997 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:44:42.658649 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m09:44:42.659846 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m09:44:42.660809 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m09:44:42.661766 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m09:44:42.662865 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:44:42.663859 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:44:42.664812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m09:44:42.666035 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size <= 30
		then 'E'
		when sz.floor_size > 30 and sz.floor_size <= 45
		then 'D'
		when sz.floor_size > 45 and sz.floor_size <= 60
		then 'C'
		when sz.floor_size > 60 and sz.floor_size <= 75
		then 'B'
		when sz.floor_size > 75 and sz.floor_size <= 100
		then 'A'
	end as floor_size_rank
	from source sz 
)
select 
kind, neighborhood, floor_size_rank,
avg(price_rent) as price_rent_avg, 
avg(price_sale) as price_sale_avg, avg(price_condominium) as price_cond_avg, avg(rent_plus_condo) as rent_plus_condo_avg, 
avg(floor_size) as floor_size_avg, avg(rooms) as rooms_avg, avg(suites) as suites_avg, avg(bathrooms) as bathrooms_avg,
avg(price_rent)/avg(floor_size) as price_rent_per_m2_avg
from rank_floorsize 
where floor_size_rank is not null
and floor_size != 0
group by kind, neighborhood, floor_size_rank
order by kind, neighborhood , floor_size_rank
  );
[0m09:44:42.667319 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m09:44:42.679094 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:44:42.682604 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:44:42.684027 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m09:44:42.685490 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices" rename to "gold_flat_kit_studio_avg_prices__dbt_backup"
[0m09:44:42.687398 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:44:42.688414 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:44:42.689293 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:44:42.699134 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:44:42.700503 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m09:44:42.707560 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:44:42.715612 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m09:44:42.717025 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices" rename to "gold_house_avg_prices__dbt_backup"
[0m09:44:42.725160 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:44:42.726256 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m09:44:42.727296 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices" rename to "gold_floorsize_ranked_avg_prices__dbt_backup"
[0m09:44:42.728530 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m09:44:42.729592 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:42.736721 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:44:42.738449 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m09:44:42.739380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m09:44:42.748155 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:44:42.750435 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m09:44:42.775522 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:44:42.789049 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m09:44:42.799721 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m09:44:42.800892 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m09:44:42.802349 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m09:44:42.803472 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:44:42.804648 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:42.805813 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m09:44:42.806852 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:42.807685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:44:42.811439 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m09:44:42.816691 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m09:44:42.817945 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m09:44:42.822076 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m09:44:42.823239 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:44:42.824722 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m09:44:42.836214 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:44:42.838356 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m09:44:42.839536 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m09:44:42.841226 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m09:44:42.842813 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m09:44:42.851829 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m09:44:42.853256 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m09:44:42.855219 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:44:42.856597 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:44:42.861928 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m09:44:42.863252 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m09:44:42.868853 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m09:44:42.870119 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m09:44:42.874893 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m09:44:42.880861 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m09:44:42.884310 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m09:44:42.890003 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m09:44:42.891652 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m09:44:42.893058 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m09:44:42.899079 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m09:44:42.900117 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a15cf743-7e82-4865-974b-830340da949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4f92cbab00>]}
[0m09:44:42.901756 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m09:44:42.903179 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.59s]
[0m09:44:42.904701 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m09:44:42.905927 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m09:44:42.906982 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m09:44:42.907806 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m09:44:42.911275 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m09:44:42.914955 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m09:44:42.918812 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m09:44:42.920784 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a15cf743-7e82-4865-974b-830340da949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4f8f38cd00>]}
[0m09:44:42.922687 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a15cf743-7e82-4865-974b-830340da949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4f8f3c3460>]}
[0m09:44:42.924887 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.61s]
[0m09:44:42.927086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a15cf743-7e82-4865-974b-830340da949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4f90050670>]}
[0m09:44:42.928496 [info ] [Thread-3 (]: 3 of 4 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.62s]
[0m09:44:42.930810 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m09:44:42.932862 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.63s]
[0m09:44:42.934535 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m09:44:42.935975 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m09:44:42.938439 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:42.939509 [debug] [MainThread]: On master: BEGIN
[0m09:44:42.940317 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:42.953799 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:44:42.954937 [debug] [MainThread]: On master: COMMIT
[0m09:44:42.955846 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:42.956633 [debug] [MainThread]: On master: COMMIT
[0m09:44:42.957686 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:44:42.958440 [debug] [MainThread]: On master: Close
[0m09:44:42.959446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:42.960152 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m09:44:42.960786 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m09:44:42.961400 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m09:44:42.962036 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m09:44:42.962906 [info ] [MainThread]: 
[0m09:44:42.964027 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m09:44:42.966556 [debug] [MainThread]: Command end result
[0m09:44:43.011629 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m09:44:43.017113 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m09:44:43.030110 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m09:44:43.030998 [info ] [MainThread]: 
[0m09:44:43.031919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:44:43.032726 [info ] [MainThread]: 
[0m09:44:43.033534 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:44:43.035313 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5905423, "process_in_blocks": "0", "process_kernel_time": 0.270102, "process_mem_max_rss": "116324", "process_out_blocks": "2704", "process_user_time": 4.557735}
[0m09:44:43.036227 [debug] [MainThread]: Command `dbt run` succeeded at 09:44:43.036073 after 2.59 seconds
[0m09:44:43.037087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4f91cd4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4f901dadd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4f913e7b50>]}
[0m09:44:43.038209 [debug] [MainThread]: Flushing usage events
[0m09:44:44.747135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:52:26.373375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b30a860d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b30b736320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b30b7362c0>]}


============================== 16:52:26.376734 | 7a4b99d5-93de-47cc-8773-3c48e24419aa ==============================
[0m16:52:26.376734 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:52:26.377581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:52:26.588199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a4b99d5-93de-47cc-8773-3c48e24419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b3095e39d0>]}
[0m16:52:26.663599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a4b99d5-93de-47cc-8773-3c48e24419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b309b7a890>]}
[0m16:52:26.664631 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:52:26.795382 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:52:26.946770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:52:26.947591 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_floorsize_ranked_avg_prices.sql
[0m16:52:27.270766 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m16:52:27.291704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a4b99d5-93de-47cc-8773-3c48e24419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b308ae2560>]}
[0m16:52:27.398572 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m16:52:27.402662 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m16:52:27.415035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a4b99d5-93de-47cc-8773-3c48e24419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b308ae2860>]}
[0m16:52:27.415777 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m16:52:27.416295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a4b99d5-93de-47cc-8773-3c48e24419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b308ae2890>]}
[0m16:52:27.418433 [info ] [MainThread]: 
[0m16:52:27.419107 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:52:27.419713 [info ] [MainThread]: 
[0m16:52:27.420526 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:27.428215 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m16:52:27.473959 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m16:52:27.474596 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m16:52:27.475055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:27.484685 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m16:52:27.487069 [debug] [ThreadPool]: On list_foo: Close
[0m16:52:27.489325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m16:52:27.498118 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m16:52:27.498735 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m16:52:27.499243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:27.508213 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:52:27.508822 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m16:52:27.509376 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m16:52:27.512692 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m16:52:27.515481 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m16:52:27.516315 [debug] [ThreadPool]: On list_foo_zap: Close
[0m16:52:27.523612 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:27.524235 [debug] [MainThread]: On master: BEGIN
[0m16:52:27.524677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:27.533402 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m16:52:27.533978 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:27.534501 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:52:27.539383 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m16:52:27.542456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a4b99d5-93de-47cc-8773-3c48e24419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b308a962c0>]}
[0m16:52:27.543197 [debug] [MainThread]: On master: ROLLBACK
[0m16:52:27.543960 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:27.544470 [debug] [MainThread]: On master: BEGIN
[0m16:52:27.545373 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:52:27.545888 [debug] [MainThread]: On master: COMMIT
[0m16:52:27.546354 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:27.546781 [debug] [MainThread]: On master: COMMIT
[0m16:52:27.547463 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:52:27.547977 [debug] [MainThread]: On master: Close
[0m16:52:27.550946 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m16:52:27.551656 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m16:52:27.552326 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m16:52:27.553080 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m16:52:27.553814 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m16:52:27.554520 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m16:52:27.555639 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m16:52:27.556484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m16:52:27.557585 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m16:52:27.558556 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m16:52:27.559821 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m16:52:27.560625 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m16:52:27.561594 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m16:52:27.562406 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m16:52:27.563159 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m16:52:27.574187 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m16:52:27.575791 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m16:52:27.581255 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m16:52:27.640312 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m16:52:27.644886 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m16:52:27.646580 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m16:52:27.647732 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m16:52:27.648275 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m16:52:27.680755 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m16:52:27.747393 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m16:52:27.751603 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m16:52:27.754301 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m16:52:27.760733 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m16:52:27.762359 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m16:52:27.763095 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m16:52:27.763857 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m16:52:27.764419 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:52:27.765023 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m16:52:27.765625 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m16:52:27.766270 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m16:52:27.767241 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m16:52:27.768052 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:52:27.768683 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m16:52:27.769334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:27.770277 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:52:27.775284 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m16:52:27.776193 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m16:52:27.777163 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m16:52:27.778274 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m16:52:27.779173 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m16:52:27.779941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m16:52:27.780712 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select 
neighborhood, floor_size_rank,
avg(price_rent) as price_rent_avg, 
avg(price_sale) as price_sale_avg, avg(price_condominium) as price_cond_avg, avg(rent_plus_condo) as rent_plus_condo_avg, 
avg(floor_size) as floor_size_avg, avg(rooms) as rooms_avg, avg(suites) as suites_avg, avg(bathrooms) as bathrooms_avg,
avg(price_rent)/avg(floor_size) as price_rent_per_m2_avg
from rank_floorsize 
where floor_size_rank is not null
group by neighborhood, floor_size_rank
order by neighborhood , floor_size_rank
  );
[0m16:52:27.781617 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m16:52:27.782235 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m16:52:27.782894 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m16:52:27.783649 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m16:52:27.784377 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m16:52:27.790611 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:52:27.791546 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m16:52:27.796053 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m16:52:27.802444 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m16:52:27.803431 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m16:52:27.804885 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices" rename to "gold_flat_kit_studio_avg_prices__dbt_backup"
[0m16:52:27.806436 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices" rename to "gold_floorsize_ranked_avg_prices__dbt_backup"
[0m16:52:27.812943 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m16:52:27.813799 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m16:52:27.814905 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m16:52:27.815739 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:52:27.816476 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:52:27.822344 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m16:52:27.828409 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m16:52:27.829886 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m16:52:27.836381 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m16:52:27.837233 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices" rename to "gold_house_avg_prices__dbt_backup"
[0m16:52:27.841889 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m16:52:27.842843 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m16:52:27.843704 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m16:52:27.844485 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m16:52:27.845186 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:52:27.850381 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m16:52:27.851036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m16:52:27.851797 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:52:27.852799 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m16:52:27.853633 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m16:52:27.891667 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:52:27.903534 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m16:52:27.906625 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m16:52:27.908050 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m16:52:27.909558 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m16:52:27.910171 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m16:52:27.911143 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m16:52:27.912270 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m16:52:27.912938 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m16:52:27.913538 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m16:52:27.914087 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m16:52:27.914734 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m16:52:27.915301 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m16:52:27.918424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:52:27.919886 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m16:52:27.920896 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m16:52:27.929787 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m16:52:27.930646 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m16:52:27.935431 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m16:52:27.939552 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m16:52:27.946799 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m16:52:27.951908 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m16:52:27.954368 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m16:52:27.955983 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m16:52:27.956653 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m16:52:27.957944 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m16:52:27.958641 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m16:52:27.959272 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m16:52:27.959934 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m16:52:27.963592 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:52:27.967141 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m16:52:27.967775 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.007 seconds
[0m16:52:27.968512 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m16:52:27.969741 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.009 seconds
[0m16:52:27.973084 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m16:52:27.977458 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m16:52:27.978113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a4b99d5-93de-47cc-8773-3c48e24419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b30b88aa40>]}
[0m16:52:27.980419 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m16:52:27.981790 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a4b99d5-93de-47cc-8773-3c48e24419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b308a95540>]}
[0m16:52:27.982990 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.42s]
[0m16:52:27.984409 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a4b99d5-93de-47cc-8773-3c48e24419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b308a94700>]}
[0m16:52:27.985664 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.42s]
[0m16:52:27.986890 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a4b99d5-93de-47cc-8773-3c48e24419aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b309b780a0>]}
[0m16:52:27.988042 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m16:52:27.989865 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.43s]
[0m16:52:27.991009 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m16:52:27.992503 [info ] [Thread-3 (]: 3 of 4 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.43s]
[0m16:52:27.994000 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m16:52:27.995243 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m16:52:27.997340 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:27.998265 [debug] [MainThread]: On master: BEGIN
[0m16:52:27.998865 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:52:28.009211 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:52:28.010017 [debug] [MainThread]: On master: COMMIT
[0m16:52:28.010754 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:28.011480 [debug] [MainThread]: On master: COMMIT
[0m16:52:28.012162 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:52:28.012675 [debug] [MainThread]: On master: Close
[0m16:52:28.013394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:28.013909 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m16:52:28.014358 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m16:52:28.014784 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m16:52:28.015197 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m16:52:28.015745 [info ] [MainThread]: 
[0m16:52:28.016315 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m16:52:28.017781 [debug] [MainThread]: Command end result
[0m16:52:28.045376 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m16:52:28.047454 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m16:52:28.056764 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m16:52:28.057363 [info ] [MainThread]: 
[0m16:52:28.057926 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:52:28.058427 [info ] [MainThread]: 
[0m16:52:28.058927 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:52:28.060118 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7587926, "process_in_blocks": "0", "process_kernel_time": 0.176048, "process_mem_max_rss": "116152", "process_out_blocks": "2696", "process_user_time": 3.045842}
[0m16:52:28.060877 [debug] [MainThread]: Command `dbt run` succeeded at 16:52:28.060735 after 1.76 seconds
[0m16:52:28.061471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b30a860d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b30ad08f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b30a724bb0>]}
[0m16:52:28.062008 [debug] [MainThread]: Flushing usage events
[0m16:52:30.241447 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:41.968818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f0dff88df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f0e0e5e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f0e0e5e320>]}


============================== 17:10:41.973566 | 105cf80c-86b8-42ba-bd2c-d6416d245350 ==============================
[0m17:10:41.973566 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:10:41.974770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:10:42.279108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '105cf80c-86b8-42ba-bd2c-d6416d245350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f0defe6710>]}
[0m17:10:42.389738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '105cf80c-86b8-42ba-bd2c-d6416d245350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f0dfd113f0>]}
[0m17:10:42.391134 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:10:42.584647 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:10:42.807737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:10:42.808856 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_floorsize_ranked_avg_prices.sql
[0m17:10:43.278173 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m17:10:43.310214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '105cf80c-86b8-42ba-bd2c-d6416d245350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f0de1e65c0>]}
[0m17:10:43.473842 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m17:10:43.480766 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m17:10:43.498071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '105cf80c-86b8-42ba-bd2c-d6416d245350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f0de996320>]}
[0m17:10:43.499063 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m17:10:43.499796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '105cf80c-86b8-42ba-bd2c-d6416d245350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f0de9965f0>]}
[0m17:10:43.502777 [info ] [MainThread]: 
[0m17:10:43.503605 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:10:43.504302 [info ] [MainThread]: 
[0m17:10:43.505468 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:10:43.516025 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m17:10:43.581895 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m17:10:43.582709 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m17:10:43.583366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:43.597946 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m17:10:43.600305 [debug] [ThreadPool]: On list_foo: Close
[0m17:10:43.603664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m17:10:43.616500 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:10:43.617319 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m17:10:43.617961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:43.628789 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m17:10:43.629592 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m17:10:43.630282 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m17:10:43.634466 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m17:10:43.636930 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m17:10:43.637922 [debug] [ThreadPool]: On list_foo_zap: Close
[0m17:10:43.648773 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:43.649571 [debug] [MainThread]: On master: BEGIN
[0m17:10:43.650218 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:43.663082 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m17:10:43.663902 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:43.664679 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:10:43.671923 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m17:10:43.676390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '105cf80c-86b8-42ba-bd2c-d6416d245350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f0de142bf0>]}
[0m17:10:43.677280 [debug] [MainThread]: On master: ROLLBACK
[0m17:10:43.678324 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:43.679044 [debug] [MainThread]: On master: BEGIN
[0m17:10:43.680353 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:10:43.681086 [debug] [MainThread]: On master: COMMIT
[0m17:10:43.681758 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:43.682395 [debug] [MainThread]: On master: COMMIT
[0m17:10:43.683348 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:10:43.684075 [debug] [MainThread]: On master: Close
[0m17:10:43.688152 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m17:10:43.689426 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m17:10:43.691142 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m17:10:43.692445 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m17:10:43.694179 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m17:10:43.695793 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m17:10:43.697077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m17:10:43.698467 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m17:10:43.699900 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m17:10:43.701485 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m17:10:43.703331 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m17:10:43.705195 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m17:10:43.706369 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m17:10:43.707637 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m17:10:43.718997 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m17:10:43.725392 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:10:43.732954 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m17:10:43.734093 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m17:10:43.804550 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m17:10:43.811329 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m17:10:43.812588 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m17:10:43.813641 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m17:10:43.814632 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m17:10:43.815444 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m17:10:43.987592 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:10:43.989191 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m17:10:43.992598 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m17:10:43.994976 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m17:10:43.997968 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:10:43.999311 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m17:10:44.000285 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:10:44.001465 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m17:10:44.002715 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m17:10:44.003610 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m17:10:44.004499 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m17:10:44.005497 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:10:44.006451 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m17:10:44.007554 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:10:44.008422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:44.010276 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:10:44.021580 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m17:10:44.023101 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m17:10:44.024202 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:10:44.025145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m17:10:44.026365 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m17:10:44.027746 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m17:10:44.028728 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:10:44.030312 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:10:44.031625 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select 
neighborhood, floor_size_rank,
count(neighborhood) as sample_size,
avg(price_rent)/avg(floor_size) as price_rent_per_m2_avg,
avg(price_rent) as price_rent_avg, 
avg(price_sale) as price_sale_avg, avg(price_condominium) as price_cond_avg, avg(rent_plus_condo) as rent_plus_condo_avg, 
avg(floor_size) as floor_size_avg, avg(rooms) as rooms_avg, avg(suites) as suites_avg, avg(bathrooms) as bathrooms_avg

from rank_floorsize 
where floor_size_rank is not null
group by neighborhood, floor_size_rank
order by neighborhood , floor_size_rank
  );
[0m17:10:44.033442 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m17:10:44.035480 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m17:10:44.037300 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m17:10:44.039383 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m17:10:44.046938 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m17:10:44.053320 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:10:44.054483 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m17:10:44.063678 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:10:44.066186 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m17:10:44.073472 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m17:10:44.080226 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:10:44.081373 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices" rename to "gold_house_avg_prices__dbt_backup"
[0m17:10:44.082393 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices" rename to "gold_floorsize_ranked_avg_prices__dbt_backup"
[0m17:10:44.083297 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices" rename to "gold_flat_kit_studio_avg_prices__dbt_backup"
[0m17:10:44.084171 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m17:10:44.086011 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:10:44.086997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:10:44.087793 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:10:44.088581 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:10:44.094955 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:10:44.103041 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:10:44.109279 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m17:10:44.116121 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m17:10:44.117254 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m17:10:44.118774 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m17:10:44.120085 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m17:10:44.121246 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m17:10:44.124123 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:10:44.125355 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:10:44.126172 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:10:44.127240 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m17:10:44.184490 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m17:10:44.187286 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m17:10:44.191763 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m17:10:44.195991 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m17:10:44.197277 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m17:10:44.198948 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:10:44.199854 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:10:44.200723 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m17:10:44.202342 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m17:10:44.203397 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m17:10:44.204534 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m17:10:44.205765 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m17:10:44.210645 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m17:10:44.211835 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m17:10:44.218180 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m17:10:44.225281 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m17:10:44.231620 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m17:10:44.232741 [debug] [Thread-2 (]: SQL status: COMMIT in 0.025 seconds
[0m17:10:44.238436 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m17:10:44.247675 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m17:10:44.250927 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m17:10:44.257696 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m17:10:44.259862 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m17:10:44.260819 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m17:10:44.261877 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m17:10:44.265011 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m17:10:44.266274 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m17:10:44.268503 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m17:10:44.271716 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m17:10:44.276711 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m17:10:44.277674 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m17:10:44.278767 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.011 seconds
[0m17:10:44.282316 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.012 seconds
[0m17:10:44.285205 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m17:10:44.288817 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m17:10:44.289840 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '105cf80c-86b8-42ba-bd2c-d6416d245350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f0dd652cb0>]}
[0m17:10:44.293119 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m17:10:44.295205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '105cf80c-86b8-42ba-bd2c-d6416d245350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f0df2fa9b0>]}
[0m17:10:44.298547 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '105cf80c-86b8-42ba-bd2c-d6416d245350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f0e0e09db0>]}
[0m17:10:44.297183 [info ] [Thread-3 (]: 3 of 4 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.58s]
[0m17:10:44.300597 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.60s]
[0m17:10:44.302311 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '105cf80c-86b8-42ba-bd2c-d6416d245350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f0defe7ca0>]}
[0m17:10:44.304348 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.59s]
[0m17:10:44.305883 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m17:10:44.307476 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m17:10:44.309059 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.60s]
[0m17:10:44.310724 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m17:10:44.312566 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m17:10:44.314935 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:44.315750 [debug] [MainThread]: On master: BEGIN
[0m17:10:44.316757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:44.329200 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:10:44.330008 [debug] [MainThread]: On master: COMMIT
[0m17:10:44.330706 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:44.331364 [debug] [MainThread]: On master: COMMIT
[0m17:10:44.332335 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:10:44.333066 [debug] [MainThread]: On master: Close
[0m17:10:44.334158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:44.335010 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m17:10:44.335915 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m17:10:44.336816 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m17:10:44.337754 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m17:10:44.338963 [info ] [MainThread]: 
[0m17:10:44.339890 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m17:10:44.342080 [debug] [MainThread]: Command end result
[0m17:10:44.381942 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m17:10:44.385065 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m17:10:44.398681 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m17:10:44.399475 [info ] [MainThread]: 
[0m17:10:44.400314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:44.401246 [info ] [MainThread]: 
[0m17:10:44.402205 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:10:44.403854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5406895, "process_in_blocks": "0", "process_kernel_time": 0.260227, "process_mem_max_rss": "116316", "process_out_blocks": "2704", "process_user_time": 4.47191}
[0m17:10:44.404753 [debug] [MainThread]: Command `dbt run` succeeded at 17:10:44.404599 after 2.54 seconds
[0m17:10:44.405581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f0dff88df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f0dfd113f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f0dfe4e710>]}
[0m17:10:44.406627 [debug] [MainThread]: Flushing usage events
[0m17:10:46.147192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:14:32.717303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a15349791b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a153581e680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a153581e620>]}


============================== 20:14:32.721266 | 824d3226-d37d-4e59-8549-65b8539ba72d ==============================
[0m20:14:32.721266 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:14:32.722076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:14:32.950373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '824d3226-d37d-4e59-8549-65b8539ba72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a15357c1b70>]}
[0m20:14:33.033770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '824d3226-d37d-4e59-8549-65b8539ba72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1535786920>]}
[0m20:14:33.036290 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:14:33.178316 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:14:33.355630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:14:33.356229 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:14:33.365258 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m20:14:33.412657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '824d3226-d37d-4e59-8549-65b8539ba72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1532d6a6b0>]}
[0m20:14:33.526790 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m20:14:33.531721 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m20:14:33.557851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '824d3226-d37d-4e59-8549-65b8539ba72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1532c66980>]}
[0m20:14:33.558643 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m20:14:33.559186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '824d3226-d37d-4e59-8549-65b8539ba72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1532c674c0>]}
[0m20:14:33.562041 [info ] [MainThread]: 
[0m20:14:33.562853 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:14:33.563692 [info ] [MainThread]: 
[0m20:14:33.564665 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:14:33.571190 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:14:33.625741 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:14:33.626384 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:14:33.626876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:33.637563 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m20:14:33.639330 [debug] [ThreadPool]: On list_foo: Close
[0m20:14:33.641735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m20:14:33.651144 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m20:14:33.651754 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m20:14:33.652228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:33.662306 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m20:14:33.663022 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m20:14:33.663721 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m20:14:33.670189 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m20:14:33.672623 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m20:14:33.673518 [debug] [ThreadPool]: On list_foo_zap: Close
[0m20:14:33.680445 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:33.681179 [debug] [MainThread]: On master: BEGIN
[0m20:14:33.681703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:14:33.690812 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:14:33.691444 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:33.692012 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:14:33.696663 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:14:33.698592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '824d3226-d37d-4e59-8549-65b8539ba72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1534fd8a30>]}
[0m20:14:33.699537 [debug] [MainThread]: On master: ROLLBACK
[0m20:14:33.701114 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:33.702389 [debug] [MainThread]: On master: BEGIN
[0m20:14:33.704214 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:14:33.705313 [debug] [MainThread]: On master: COMMIT
[0m20:14:33.706257 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:33.707226 [debug] [MainThread]: On master: COMMIT
[0m20:14:33.708945 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:14:33.710153 [debug] [MainThread]: On master: Close
[0m20:14:33.717032 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m20:14:33.718593 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m20:14:33.720144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m20:14:33.722222 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m20:14:33.721160 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:14:33.723401 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:14:33.724486 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m20:14:33.747232 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m20:14:33.733638 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m20:14:33.751448 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m20:14:33.744049 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:14:33.749221 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m20:14:33.745512 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m20:14:33.752792 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:14:33.753891 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m20:14:33.754919 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m20:14:33.755629 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m20:14:33.759721 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:14:33.766040 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m20:14:33.766728 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:14:33.804687 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:14:33.821333 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:14:33.822512 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m20:14:33.842213 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:14:33.843030 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:14:33.851599 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m20:14:33.852708 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:14:33.859506 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:14:33.860966 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:14:33.861954 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m20:14:33.863228 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:14:33.864065 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:14:33.864821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:33.865517 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m20:14:33.866248 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:14:33.866861 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m20:14:33.867668 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:14:33.868434 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m20:14:33.869266 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:14:33.870313 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:14:33.875289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m20:14:33.876101 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:14:33.876980 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m20:14:33.880093 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m20:14:33.881159 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m20:14:33.882366 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m20:14:33.882968 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:14:33.883613 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:14:33.884225 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:14:33.885160 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m20:14:33.885908 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:14:33.886620 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m20:14:33.887594 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select 
neighborhood, floor_size_rank,
count(neighborhood) as sample_size,
avg(price_rent)/avg(floor_size) as price_rent_per_m2_avg,
avg(price_rent) as price_rent_avg, 
avg(price_sale) as price_sale_avg, avg(price_condominium) as price_cond_avg, avg(rent_plus_condo) as rent_plus_condo_avg, 
avg(floor_size) as floor_size_avg, avg(rooms) as rooms_avg, avg(suites) as suites_avg, avg(bathrooms) as bathrooms_avg

from rank_floorsize 
where floor_size_rank is not null
group by neighborhood, floor_size_rank
order by neighborhood , floor_size_rank
  );
[0m20:14:33.894163 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:14:33.899018 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:14:33.904648 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:14:33.905657 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:14:33.906692 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m20:14:33.907515 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:14:33.908134 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m20:14:33.914792 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:14:33.919457 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:14:33.920232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m20:14:33.921192 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m20:14:33.922701 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:14:33.923513 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m20:14:33.941027 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:14:33.953210 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m20:14:33.954085 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m20:14:33.957394 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m20:14:33.958363 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m20:14:33.959844 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:14:33.961844 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:14:33.963033 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:14:33.966046 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m20:14:33.966806 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m20:14:33.967647 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m20:14:33.968579 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m20:14:33.969219 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:14:33.970650 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m20:14:33.972625 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m20:14:33.979108 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:14:33.979988 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m20:14:34.040967 [debug] [Thread-4 (]: SQL status: COMMIT in 0.070 seconds
[0m20:14:34.044412 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m20:14:34.049215 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m20:14:34.053346 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m20:14:34.057801 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m20:14:34.066432 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:14:34.068648 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:14:34.071106 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:14:34.073724 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:14:34.074681 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m20:14:34.075821 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m20:14:34.076708 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m20:14:34.078476 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m20:14:34.079867 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:14:34.080716 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:14:34.081385 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:14:34.085694 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m20:14:34.086367 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.007 seconds
[0m20:14:34.088857 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m20:14:34.091745 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m20:14:34.095258 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m20:14:34.100299 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824d3226-d37d-4e59-8549-65b8539ba72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a153257eb60>]}
[0m20:14:34.101248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824d3226-d37d-4e59-8549-65b8539ba72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a153257f400>]}
[0m20:14:34.102598 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.35s]
[0m20:14:34.103255 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824d3226-d37d-4e59-8549-65b8539ba72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a153257ee30>]}
[0m20:14:34.103913 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824d3226-d37d-4e59-8549-65b8539ba72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a15320341f0>]}
[0m20:14:34.104878 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.38s]
[0m20:14:34.105977 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:14:34.107303 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.35s]
[0m20:14:34.108701 [info ] [Thread-3 (]: 3 of 4 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.34s]
[0m20:14:34.109774 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m20:14:34.111217 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m20:14:34.112250 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:14:34.114591 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:34.115238 [debug] [MainThread]: On master: BEGIN
[0m20:14:34.115740 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:14:34.125359 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:14:34.125980 [debug] [MainThread]: On master: COMMIT
[0m20:14:34.126613 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:34.127329 [debug] [MainThread]: On master: COMMIT
[0m20:14:34.128359 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:14:34.129122 [debug] [MainThread]: On master: Close
[0m20:14:34.130318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:34.131005 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m20:14:34.131633 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m20:14:34.132138 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m20:14:34.132596 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m20:14:34.133238 [info ] [MainThread]: 
[0m20:14:34.134119 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m20:14:34.136391 [debug] [MainThread]: Command end result
[0m20:14:34.169708 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m20:14:34.172034 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m20:14:34.182292 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m20:14:34.182917 [info ] [MainThread]: 
[0m20:14:34.183545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:14:34.184148 [info ] [MainThread]: 
[0m20:14:34.184819 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:14:34.186207 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5460165, "process_in_blocks": "36808", "process_kernel_time": 0.266971, "process_mem_max_rss": "111556", "process_out_blocks": "1848", "process_user_time": 2.871445}
[0m20:14:34.186994 [debug] [MainThread]: Command `dbt run` succeeded at 20:14:34.186846 after 1.55 seconds
[0m20:14:34.187613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a15349791b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1532165780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1532166800>]}
[0m20:14:34.188225 [debug] [MainThread]: Flushing usage events
[0m20:14:35.965608 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:09.456828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729d9441d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729d952c2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729d952c25f0>]}


============================== 20:51:09.461942 | 1a15bb2b-d286-4954-b6b8-6cbd078acb48 ==============================
[0m20:51:09.461942 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:51:09.463363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:51:09.739404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a15bb2b-d286-4954-b6b8-6cbd078acb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729d952ab190>]}
[0m20:51:09.832565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a15bb2b-d286-4954-b6b8-6cbd078acb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729d9419c850>]}
[0m20:51:09.833995 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:51:09.968732 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:51:10.136563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:51:10.137194 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:51:10.145660 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m20:51:10.197550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a15bb2b-d286-4954-b6b8-6cbd078acb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729d9276afb0>]}
[0m20:51:10.322180 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m20:51:10.327078 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m20:51:10.342093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a15bb2b-d286-4954-b6b8-6cbd078acb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729d92619f00>]}
[0m20:51:10.342880 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m20:51:10.343514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a15bb2b-d286-4954-b6b8-6cbd078acb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729d9261a9b0>]}
[0m20:51:10.345817 [info ] [MainThread]: 
[0m20:51:10.346551 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:51:10.347520 [info ] [MainThread]: 
[0m20:51:10.349143 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:51:10.356136 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:51:10.406735 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:51:10.407396 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:51:10.407943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:10.419706 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m20:51:10.421555 [debug] [ThreadPool]: On list_foo: Close
[0m20:51:10.424225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m20:51:10.434427 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m20:51:10.435074 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m20:51:10.435661 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:10.444637 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m20:51:10.445278 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m20:51:10.445771 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m20:51:10.449882 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m20:51:10.452027 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m20:51:10.452932 [debug] [ThreadPool]: On list_foo_zap: Close
[0m20:51:10.459902 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:10.460563 [debug] [MainThread]: On master: BEGIN
[0m20:51:10.461117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:10.471637 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:51:10.472498 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:10.473210 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:51:10.477908 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:51:10.479955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a15bb2b-d286-4954-b6b8-6cbd078acb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729d92677160>]}
[0m20:51:10.481185 [debug] [MainThread]: On master: ROLLBACK
[0m20:51:10.482451 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:10.483307 [debug] [MainThread]: On master: BEGIN
[0m20:51:10.484736 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:51:10.485538 [debug] [MainThread]: On master: COMMIT
[0m20:51:10.486157 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:10.486738 [debug] [MainThread]: On master: COMMIT
[0m20:51:10.487839 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:51:10.488982 [debug] [MainThread]: On master: Close
[0m20:51:10.492076 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m20:51:10.492886 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:51:10.493738 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m20:51:10.494544 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:51:10.495395 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m20:51:10.496223 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m20:51:10.497510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m20:51:10.499011 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m20:51:10.500542 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m20:51:10.501751 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m20:51:10.502645 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m20:51:10.503813 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m20:51:10.504537 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:51:10.505459 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m20:51:10.517083 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:51:10.520565 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:51:10.533127 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m20:51:10.524905 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:51:10.539996 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:51:10.525684 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m20:51:10.531435 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:51:10.563144 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:51:10.561786 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m20:51:10.610733 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m20:51:10.684887 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m20:51:10.687011 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:51:10.691472 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:51:10.692874 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:51:10.694920 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:51:10.695838 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m20:51:10.697172 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:51:10.698522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:10.699570 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:51:10.700516 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:51:10.701339 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m20:51:10.702539 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m20:51:10.703537 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m20:51:10.704374 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:51:10.705363 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:51:10.706682 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:51:10.710423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m20:51:10.711573 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:51:10.712754 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m20:51:10.716823 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m20:51:10.717941 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:51:10.718930 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:51:10.719625 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m20:51:10.720286 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m20:51:10.731870 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m20:51:10.734823 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:51:10.735774 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:51:10.736732 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:51:10.738139 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m20:51:10.739419 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select 
neighborhood, floor_size_rank,
count(neighborhood) as sample_size,
avg(price_rent)/avg(floor_size) as price_rent_per_m2_avg,
avg(price_rent) as price_rent_avg, 
avg(price_sale) as price_sale_avg, avg(price_condominium) as price_cond_avg, avg(rent_plus_condo) as rent_plus_condo_avg, 
avg(floor_size) as floor_size_avg, avg(rooms) as rooms_avg, avg(suites) as suites_avg, avg(bathrooms) as bathrooms_avg

from rank_floorsize 
where floor_size_rank is not null
group by neighborhood, floor_size_rank
order by neighborhood , floor_size_rank
  );
[0m20:51:10.740842 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m20:51:10.742131 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:51:10.743012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:51:10.749382 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:51:10.750426 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:51:10.752002 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:51:10.786920 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m20:51:10.777880 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:51:10.788185 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:51:10.788906 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m20:51:10.790027 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:51:10.791111 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m20:51:10.792501 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m20:51:10.793707 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m20:51:10.794514 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:51:10.798459 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m20:51:10.799682 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:51:10.800540 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m20:51:10.801289 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:51:10.801966 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:51:10.872200 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m20:51:10.877826 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m20:51:10.880776 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m20:51:10.882159 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m20:51:10.883443 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:51:10.894802 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:51:10.894259 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:51:10.896318 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m20:51:10.897303 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m20:51:10.898541 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m20:51:10.899480 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m20:51:10.905021 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m20:51:10.906087 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m20:51:10.907159 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m20:51:10.909425 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:51:10.910208 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:51:10.914719 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m20:51:10.920270 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m20:51:10.921314 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m20:51:10.925486 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m20:51:10.928014 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:51:10.929764 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:51:10.934919 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:51:10.935933 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m20:51:10.936865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a15bb2b-d286-4954-b6b8-6cbd078acb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729d91f7f2b0>]}
[0m20:51:10.937821 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m20:51:10.940891 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m20:51:10.942200 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.43s]
[0m20:51:10.943066 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:51:10.944488 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m20:51:10.945754 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a15bb2b-d286-4954-b6b8-6cbd078acb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729d9263af80>]}
[0m20:51:10.946613 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:51:10.949713 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m20:51:10.951594 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.44s]
[0m20:51:10.953862 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m20:51:10.954979 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m20:51:10.956178 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a15bb2b-d286-4954-b6b8-6cbd078acb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729d933c97e0>]}
[0m20:51:10.958402 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a15bb2b-d286-4954-b6b8-6cbd078acb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729d92deea70>]}
[0m20:51:10.959810 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.46s]
[0m20:51:10.961078 [info ] [Thread-3 (]: 3 of 4 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.45s]
[0m20:51:10.962197 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:51:10.963126 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:51:10.965770 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:10.966637 [debug] [MainThread]: On master: BEGIN
[0m20:51:10.967543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:51:10.976546 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:51:10.977255 [debug] [MainThread]: On master: COMMIT
[0m20:51:10.977793 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:10.978316 [debug] [MainThread]: On master: COMMIT
[0m20:51:10.979174 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:51:10.979794 [debug] [MainThread]: On master: Close
[0m20:51:10.981338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:10.982382 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m20:51:10.983223 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m20:51:10.984315 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m20:51:10.984992 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m20:51:10.986010 [info ] [MainThread]: 
[0m20:51:10.986767 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m20:51:10.988453 [debug] [MainThread]: Command end result
[0m20:51:11.020378 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m20:51:11.022877 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m20:51:11.034716 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m20:51:11.035532 [info ] [MainThread]: 
[0m20:51:11.036306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:51:11.037004 [info ] [MainThread]: 
[0m20:51:11.037748 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:51:11.039247 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6649647, "process_in_blocks": "0", "process_kernel_time": 0.19164, "process_mem_max_rss": "112000", "process_out_blocks": "1848", "process_user_time": 3.195011}
[0m20:51:11.040082 [debug] [MainThread]: Command `dbt run` succeeded at 20:51:11.039879 after 1.67 seconds
[0m20:51:11.041029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729d9441d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729d9419c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729d91ba0c10>]}
[0m20:51:11.042258 [debug] [MainThread]: Flushing usage events
[0m20:51:13.011606 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:00:39.386963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c9188d4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c91976a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c91976a260>]}


============================== 21:00:39.392245 | 1778e0c3-2b7d-4bb7-a1ad-4ab4f6232015 ==============================
[0m21:00:39.392245 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:00:39.394469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:39.736534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1778e0c3-2b7d-4bb7-a1ad-4ab4f6232015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c917c015a0>]}
[0m21:00:39.859158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1778e0c3-2b7d-4bb7-a1ad-4ab4f6232015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c917fefb80>]}
[0m21:00:39.862040 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:00:40.066275 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:00:40.314699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:00:40.315482 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:00:40.328406 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m21:00:40.402564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1778e0c3-2b7d-4bb7-a1ad-4ab4f6232015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c916c58130>]}
[0m21:00:40.576272 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m21:00:40.582257 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m21:00:40.602977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1778e0c3-2b7d-4bb7-a1ad-4ab4f6232015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c916c6e5f0>]}
[0m21:00:40.604031 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m21:00:40.604808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1778e0c3-2b7d-4bb7-a1ad-4ab4f6232015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c916c6c190>]}
[0m21:00:40.608341 [info ] [MainThread]: 
[0m21:00:40.609405 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:00:40.610614 [info ] [MainThread]: 
[0m21:00:40.611964 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:00:40.622178 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m21:00:40.699772 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m21:00:40.700605 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m21:00:40.701336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:40.716418 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m21:00:40.718896 [debug] [ThreadPool]: On list_foo: Close
[0m21:00:40.721640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m21:00:40.735406 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m21:00:40.736221 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m21:00:40.736860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:40.749212 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m21:00:40.750027 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m21:00:40.750861 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m21:00:40.755861 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m21:00:40.759546 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m21:00:40.761171 [debug] [ThreadPool]: On list_foo_zap: Close
[0m21:00:40.769817 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:40.770655 [debug] [MainThread]: On master: BEGIN
[0m21:00:40.771307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:40.784661 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m21:00:40.785502 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:40.786299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:00:40.793939 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m21:00:40.796444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1778e0c3-2b7d-4bb7-a1ad-4ab4f6232015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c916c98f10>]}
[0m21:00:40.797468 [debug] [MainThread]: On master: ROLLBACK
[0m21:00:40.798513 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:40.799241 [debug] [MainThread]: On master: BEGIN
[0m21:00:40.800352 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:00:40.801077 [debug] [MainThread]: On master: COMMIT
[0m21:00:40.801733 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:40.802386 [debug] [MainThread]: On master: COMMIT
[0m21:00:40.803500 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:00:40.804291 [debug] [MainThread]: On master: Close
[0m21:00:40.808877 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m21:00:40.810134 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m21:00:40.811336 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m21:00:40.812433 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m21:00:40.813286 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m21:00:40.814313 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m21:00:40.815489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m21:00:40.816773 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m21:00:40.818119 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m21:00:40.820206 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m21:00:40.821554 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m21:00:40.822991 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m21:00:40.825019 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m21:00:40.827408 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m21:00:40.839518 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m21:00:40.848686 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m21:00:40.849978 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m21:00:40.856815 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m21:00:40.865085 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m21:00:40.871150 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m21:00:40.872783 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m21:00:40.875072 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m21:00:40.876864 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m21:00:40.960990 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m21:00:41.123541 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m21:00:41.128306 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m21:00:41.132489 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m21:00:41.133687 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m21:00:41.135271 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m21:00:41.136681 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m21:00:41.137694 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m21:00:41.138539 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m21:00:41.139460 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m21:00:41.141023 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m21:00:41.142789 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m21:00:41.143968 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:00:41.144912 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:00:41.145806 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m21:00:41.146740 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:00:41.148157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:41.158580 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m21:00:41.160779 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m21:00:41.162132 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m21:00:41.163234 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m21:00:41.164511 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m21:00:41.165748 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m21:00:41.167039 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m21:00:41.168221 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m21:00:41.169215 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:00:41.170043 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m21:00:41.171210 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m21:00:41.177827 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m21:00:41.185625 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m21:00:41.186688 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m21:00:41.188119 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select 
neighborhood, floor_size_rank,
count(neighborhood) as sample_size,
avg(price_rent)/avg(floor_size) as price_rent_per_m2_avg,
avg(price_rent) as price_rent_avg, 
avg(price_sale) as price_sale_avg, avg(price_condominium) as price_cond_avg, avg(rent_plus_condo) as rent_plus_condo_avg, 
avg(floor_size) as floor_size_avg, avg(rooms) as rooms_avg, avg(suites) as suites_avg, avg(bathrooms) as bathrooms_avg

from rank_floorsize 
where floor_size_rank is not null
group by neighborhood, floor_size_rank
order by neighborhood , floor_size_rank
  );
[0m21:00:41.197378 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m21:00:41.198295 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m21:00:41.199623 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m21:00:41.201363 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:00:41.202379 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:00:41.208513 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m21:00:41.209727 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m21:00:41.253139 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m21:00:41.332567 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m21:00:41.341202 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m21:00:41.347659 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m21:00:41.349032 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m21:00:41.350464 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m21:00:41.351387 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m21:00:41.353398 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m21:00:41.354469 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:00:41.355493 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m21:00:41.356568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:00:41.357902 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m21:00:41.361951 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m21:00:41.365447 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m21:00:41.366470 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m21:00:41.368280 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m21:00:41.369332 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m21:00:41.370202 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m21:00:41.382393 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m21:00:41.386766 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m21:00:41.393941 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m21:00:41.394896 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m21:00:41.401425 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m21:00:41.406172 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m21:00:41.409655 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m21:00:41.416354 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m21:00:41.415282 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m21:00:41.417761 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m21:00:41.418650 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m21:00:41.427248 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m21:00:41.427988 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m21:00:41.429526 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m21:00:41.431026 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:00:41.432906 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m21:00:41.433724 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m21:00:41.440458 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m21:00:41.439792 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m21:00:41.443226 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m21:00:41.446047 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m21:00:41.449650 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m21:00:41.454523 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m21:00:41.455762 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1778e0c3-2b7d-4bb7-a1ad-4ab4f6232015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c9165a7010>]}
[0m21:00:41.457880 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1778e0c3-2b7d-4bb7-a1ad-4ab4f6232015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c916c99090>]}
[0m21:00:41.461883 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m21:00:41.463202 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1778e0c3-2b7d-4bb7-a1ad-4ab4f6232015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c916c8f790>]}
[0m21:00:41.464850 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.63s]
[0m21:00:41.466762 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.63s]
[0m21:00:41.468412 [info ] [Thread-3 (]: 3 of 4 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.64s]
[0m21:00:41.470298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1778e0c3-2b7d-4bb7-a1ad-4ab4f6232015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c9165ad150>]}
[0m21:00:41.471988 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m21:00:41.473911 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m21:00:41.475460 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m21:00:41.477510 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.65s]
[0m21:00:41.480347 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m21:00:41.482899 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:41.483790 [debug] [MainThread]: On master: BEGIN
[0m21:00:41.484725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:41.498659 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m21:00:41.499500 [debug] [MainThread]: On master: COMMIT
[0m21:00:41.500177 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:41.500819 [debug] [MainThread]: On master: COMMIT
[0m21:00:41.501857 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:00:41.502611 [debug] [MainThread]: On master: Close
[0m21:00:41.503632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:41.504436 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m21:00:41.505129 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m21:00:41.505800 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m21:00:41.506492 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m21:00:41.507975 [info ] [MainThread]: 
[0m21:00:41.509618 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m21:00:41.512637 [debug] [MainThread]: Command end result
[0m21:00:41.556309 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m21:00:41.562319 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m21:00:41.576255 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m21:00:41.577282 [info ] [MainThread]: 
[0m21:00:41.578269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:41.579045 [info ] [MainThread]: 
[0m21:00:41.579877 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:00:41.581646 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3071203, "process_in_blocks": "0", "process_kernel_time": 0.283804, "process_mem_max_rss": "112892", "process_out_blocks": "1848", "process_user_time": 4.320025}
[0m21:00:41.582591 [debug] [MainThread]: Command `dbt run` succeeded at 21:00:41.582424 after 2.31 seconds
[0m21:00:41.583438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c9188d4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c916c5c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c916c5d990>]}
[0m21:00:41.584834 [debug] [MainThread]: Flushing usage events
[0m21:00:48.778729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:38:24.154231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aaa87d4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aaa966a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aaa966a260>]}


============================== 10:38:24.158811 | 464fe800-6f5d-488e-890b-91f9e723308c ==============================
[0m10:38:24.158811 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:38:24.160059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:38:24.467326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '464fe800-6f5d-488e-890b-91f9e723308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aaa77e95a0>]}
[0m10:38:24.579536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '464fe800-6f5d-488e-890b-91f9e723308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aaa7ee7b50>]}
[0m10:38:24.580963 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:38:24.775330 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:38:25.012099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:38:25.013291 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_floorsize_ranked_avg_prices.sql
[0m10:38:25.507520 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m10:38:25.538492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '464fe800-6f5d-488e-890b-91f9e723308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aaa69e6620>]}
[0m10:38:25.694855 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:38:25.700442 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:38:25.718306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '464fe800-6f5d-488e-890b-91f9e723308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aaa69e69e0>]}
[0m10:38:25.719311 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m10:38:25.720161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '464fe800-6f5d-488e-890b-91f9e723308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aaa69e6a40>]}
[0m10:38:25.723227 [info ] [MainThread]: 
[0m10:38:25.724114 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:38:25.725094 [info ] [MainThread]: 
[0m10:38:25.726505 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:38:25.738113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m10:38:25.803943 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m10:38:25.805006 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m10:38:25.805755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:25.820229 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m10:38:25.822599 [debug] [ThreadPool]: On list_foo: Close
[0m10:38:25.825724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m10:38:25.838350 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:38:25.839212 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m10:38:25.839901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:25.852185 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:38:25.853029 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:38:25.853742 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m10:38:25.859209 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m10:38:25.862059 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m10:38:25.863186 [debug] [ThreadPool]: On list_foo_zap: Close
[0m10:38:25.873432 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:25.874237 [debug] [MainThread]: On master: BEGIN
[0m10:38:25.874910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:38:25.886776 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:38:25.887669 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:25.888441 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:38:25.894825 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m10:38:25.899028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '464fe800-6f5d-488e-890b-91f9e723308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aaa6943a30>]}
[0m10:38:25.899928 [debug] [MainThread]: On master: ROLLBACK
[0m10:38:25.901038 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:25.901845 [debug] [MainThread]: On master: BEGIN
[0m10:38:25.903114 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:38:25.903838 [debug] [MainThread]: On master: COMMIT
[0m10:38:25.904534 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:25.905186 [debug] [MainThread]: On master: COMMIT
[0m10:38:25.906176 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:38:25.906961 [debug] [MainThread]: On master: Close
[0m10:38:25.911230 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m10:38:25.912253 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m10:38:25.913320 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m10:38:25.914381 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m10:38:25.915464 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m10:38:25.916719 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m10:38:25.917856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m10:38:25.918980 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m10:38:25.920550 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m10:38:25.921867 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m10:38:25.923181 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m10:38:25.924495 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m10:38:25.925459 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m10:38:25.927080 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m10:38:25.938974 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m10:38:25.946009 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:38:25.954332 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:38:25.955464 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m10:38:26.024267 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:38:26.030755 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m10:38:26.032175 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m10:38:26.039030 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m10:38:26.051546 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m10:38:26.080180 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m10:38:26.253042 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m10:38:26.254557 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:38:26.257995 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:38:26.260595 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:38:26.262785 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:38:26.264231 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m10:38:26.265231 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:38:26.266204 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:38:26.267347 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:38:26.268854 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:38:26.270800 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m10:38:26.272594 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m10:38:26.273652 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m10:38:26.274598 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:38:26.275752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:26.277150 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:38:26.281116 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m10:38:26.282166 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:38:26.283153 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m10:38:26.288731 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:38:26.300967 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m10:38:26.303391 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:38:26.304295 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m10:38:26.305543 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:38:26.306652 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m10:38:26.307842 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices" rename to "gold_house_avg_prices__dbt_backup"
[0m10:38:26.308758 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:38:26.309907 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select
id,
neighborhood, floor_size_rank,
price_rent/floor_size, 
price_rent, 
price_sale, price_condominium, rent_plus_condo,
floor_size, rooms as rooms_avg, suites, bathrooms 

from rank_floorsize 
order by price_rent_per_m2
  );
[0m10:38:26.311107 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:38:26.312526 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m10:38:26.314092 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:38:26.315405 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m10:38:26.316638 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "price_rent_per_m2" does not exist
LINE 34: order by price_rent_per_m2
                  ^

[0m10:38:26.322947 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:38:26.324857 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:38:26.326363 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: ROLLBACK
[0m10:38:26.333070 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:38:26.335698 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:38:26.336906 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m10:38:26.343665 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m10:38:26.345775 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:38:26.346979 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices" rename to "gold_flat_kit_studio_avg_prices__dbt_backup"
[0m10:38:26.348173 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m10:38:26.349949 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:38:26.357161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:38:26.363816 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m10:38:26.376242 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:38:26.402139 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m10:38:26.404971 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m10:38:26.408208 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:38:26.410069 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:38:26.411995 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:38:26.413054 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m10:38:26.414604 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m10:38:26.418401 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m10:38:26.420124 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:38:26.421211 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:38:26.422693 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m10:38:26.423535 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m10:38:26.427189 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m10:38:26.434940 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:38:26.436441 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m10:38:26.437273 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m10:38:26.445575 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m10:38:26.452512 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m10:38:26.460206 [debug] [Thread-3 (]: Database Error in model gold_floorsize_ranked_avg_prices (models/mart/gold_floorsize_ranked_avg_prices.sql)
  column "price_rent_per_m2" does not exist
  LINE 34: order by price_rent_per_m2
                    ^
  compiled code at target/run/zap_imoveis/models/mart/gold_floorsize_ranked_avg_prices.sql
[0m10:38:26.465441 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:38:26.466656 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m10:38:26.469538 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:38:26.474276 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464fe800-6f5d-488e-890b-91f9e723308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aaa8a933a0>]}
[0m10:38:26.475584 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m10:38:26.482098 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m10:38:26.483268 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m10:38:26.485236 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model zap.gold_floorsize_ranked_avg_prices ...... [[31mERROR[0m in 0.55s]
[0m10:38:26.488558 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:38:26.489847 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:38:26.492718 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m10:38:26.494184 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m10:38:26.495276 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m10:38:26.501474 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m10:38:26.503104 [debug] [Thread-7 (]: Marking all children of 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' to be skipped because of status 'error'.  Reason: Database Error in model gold_floorsize_ranked_avg_prices (models/mart/gold_floorsize_ranked_avg_prices.sql)
  column "price_rent_per_m2" does not exist
  LINE 34: order by price_rent_per_m2
                    ^
  compiled code at target/run/zap_imoveis/models/mart/gold_floorsize_ranked_avg_prices.sql.
[0m10:38:26.506322 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m10:38:26.507393 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:38:26.510066 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464fe800-6f5d-488e-890b-91f9e723308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aaa97bab00>]}
[0m10:38:26.513907 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m10:38:26.515256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464fe800-6f5d-488e-890b-91f9e723308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aaa6a4c3d0>]}
[0m10:38:26.516721 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.58s]
[0m10:38:26.518732 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.60s]
[0m10:38:26.520462 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '464fe800-6f5d-488e-890b-91f9e723308c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aaa855ca00>]}
[0m10:38:26.521822 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m10:38:26.523674 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m10:38:26.525279 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.60s]
[0m10:38:26.527752 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m10:38:26.530213 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:26.531032 [debug] [MainThread]: On master: BEGIN
[0m10:38:26.531686 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:38:26.545049 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:38:26.545852 [debug] [MainThread]: On master: COMMIT
[0m10:38:26.546536 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:26.547186 [debug] [MainThread]: On master: COMMIT
[0m10:38:26.548210 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:38:26.548967 [debug] [MainThread]: On master: Close
[0m10:38:26.549993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:26.550775 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m10:38:26.551667 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m10:38:26.552529 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m10:38:26.553459 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m10:38:26.554768 [info ] [MainThread]: 
[0m10:38:26.555872 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m10:38:26.558281 [debug] [MainThread]: Command end result
[0m10:38:26.600246 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:38:26.603556 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:38:26.616650 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m10:38:26.617476 [info ] [MainThread]: 
[0m10:38:26.618345 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:38:26.619107 [info ] [MainThread]: 
[0m10:38:26.619940 [error] [MainThread]:   Database Error in model gold_floorsize_ranked_avg_prices (models/mart/gold_floorsize_ranked_avg_prices.sql)
  column "price_rent_per_m2" does not exist
  LINE 34: order by price_rent_per_m2
                    ^
  compiled code at target/run/zap_imoveis/models/mart/gold_floorsize_ranked_avg_prices.sql
[0m10:38:26.620640 [info ] [MainThread]: 
[0m10:38:26.621413 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m10:38:26.623065 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.577464, "process_in_blocks": "856", "process_kernel_time": 0.2803, "process_mem_max_rss": "116336", "process_out_blocks": "2680", "process_user_time": 4.468792}
[0m10:38:26.624089 [debug] [MainThread]: Command `dbt run` failed at 10:38:26.623844 after 2.58 seconds
[0m10:38:26.625101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aaa87d4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aaa855ca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79aaa5d0e050>]}
[0m10:38:26.626122 [debug] [MainThread]: Flushing usage events
[0m10:38:37.772336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:38:52.062355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7092bfe48e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7092c0d26320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7092c0d262c0>]}


============================== 10:38:52.067024 | bd9cd36a-ce34-4a6e-a664-793330d9775c ==============================
[0m10:38:52.067024 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:38:52.068105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:38:52.375093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd9cd36a-ce34-4a6e-a664-793330d9775c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7092c0e83880>]}
[0m10:38:52.490781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd9cd36a-ce34-4a6e-a664-793330d9775c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7092c0d121a0>]}
[0m10:38:52.492221 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:38:52.683547 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:38:52.905422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:38:52.906577 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_floorsize_ranked_avg_prices.sql
[0m10:38:53.384426 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m10:38:53.415262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd9cd36a-ce34-4a6e-a664-793330d9775c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7092be0e6680>]}
[0m10:38:53.574355 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:38:53.580139 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:38:53.597807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd9cd36a-ce34-4a6e-a664-793330d9775c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7092be500f10>]}
[0m10:38:53.598865 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m10:38:53.599688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd9cd36a-ce34-4a6e-a664-793330d9775c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7092bf17bca0>]}
[0m10:38:53.602799 [info ] [MainThread]: 
[0m10:38:53.603659 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:38:53.604496 [info ] [MainThread]: 
[0m10:38:53.605804 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:38:53.616334 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m10:38:53.682443 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m10:38:53.683283 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m10:38:53.683965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:53.699455 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m10:38:53.701826 [debug] [ThreadPool]: On list_foo: Close
[0m10:38:53.704601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m10:38:53.716591 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:38:53.717409 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m10:38:53.718111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:38:53.730284 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:38:53.731085 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:38:53.731793 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m10:38:53.737141 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m10:38:53.740281 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m10:38:53.741391 [debug] [ThreadPool]: On list_foo_zap: Close
[0m10:38:53.751869 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:53.752720 [debug] [MainThread]: On master: BEGIN
[0m10:38:53.753394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:38:53.765446 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:38:53.766270 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:53.767064 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:38:53.773767 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m10:38:53.778283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd9cd36a-ce34-4a6e-a664-793330d9775c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7092be0e3220>]}
[0m10:38:53.779366 [debug] [MainThread]: On master: ROLLBACK
[0m10:38:53.780467 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:53.781193 [debug] [MainThread]: On master: BEGIN
[0m10:38:53.782316 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:38:53.783073 [debug] [MainThread]: On master: COMMIT
[0m10:38:53.783752 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:53.784538 [debug] [MainThread]: On master: COMMIT
[0m10:38:53.785572 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:38:53.786378 [debug] [MainThread]: On master: Close
[0m10:38:53.790605 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m10:38:53.791815 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m10:38:53.793461 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m10:38:53.794772 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m10:38:53.796666 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m10:38:53.797772 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m10:38:53.798739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m10:38:53.800392 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m10:38:53.802896 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m10:38:53.804361 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m10:38:53.805817 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m10:38:53.807738 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m10:38:53.809176 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m10:38:53.810627 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m10:38:53.822150 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m10:38:53.828802 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:38:53.837096 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:38:53.838351 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m10:38:53.906927 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:38:53.914148 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m10:38:53.916103 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m10:38:53.923096 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m10:38:53.930386 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m10:38:53.977258 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m10:38:54.133371 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:38:54.137586 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m10:38:54.141163 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:38:54.143147 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:38:54.145660 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:38:54.146608 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:38:54.147982 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m10:38:54.149089 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:38:54.150011 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m10:38:54.150957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:54.151984 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:38:54.152816 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m10:38:54.153960 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:38:54.155932 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m10:38:54.157389 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:38:54.159423 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:38:54.166348 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m10:38:54.167397 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:38:54.168378 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m10:38:54.170388 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m10:38:54.171563 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:38:54.172554 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m10:38:54.173516 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m10:38:54.174484 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m10:38:54.175788 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:38:54.176859 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:38:54.178385 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:38:54.184921 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:38:54.194400 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:38:54.195513 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select
id,
neighborhood, floor_size_rank,
price_rent/floor_size as price_rent_per_m2, 
price_rent, 
price_sale, price_condominium, rent_plus_condo,
floor_size, rooms as rooms_avg, suites, bathrooms 

from rank_floorsize 
order by price_rent_per_m2
  );
[0m10:38:54.197441 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m10:38:54.205577 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:38:54.206461 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m10:38:54.207954 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices" rename to "gold_house_avg_prices__dbt_backup"
[0m10:38:54.210114 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:38:54.211237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:38:54.217738 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m10:38:54.219309 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:38:54.225636 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m10:38:54.227397 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:38:54.236056 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:38:54.237237 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m10:38:54.244727 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:38:54.245871 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m10:38:54.247638 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices" rename to "gold_flat_kit_studio_avg_prices__dbt_backup"
[0m10:38:54.249483 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices" rename to "gold_floorsize_ranked_avg_prices__dbt_backup"
[0m10:38:54.250528 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:38:54.258052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:38:54.264660 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m10:38:54.276456 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m10:38:54.283647 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:38:54.316608 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:38:54.317584 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m10:38:54.324123 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m10:38:54.330557 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m10:38:54.331585 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m10:38:54.333548 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:38:54.335123 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:38:54.336206 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:38:54.337760 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m10:38:54.338744 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:38:54.342321 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m10:38:54.343504 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m10:38:54.348386 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m10:38:54.349399 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:38:54.350503 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:38:54.352285 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:38:54.353721 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m10:38:54.354579 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m10:38:54.366117 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m10:38:54.368565 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m10:38:54.374149 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m10:38:54.381276 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m10:38:54.386512 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m10:38:54.388655 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m10:38:54.389738 [debug] [Thread-3 (]: SQL status: COMMIT in 0.014 seconds
[0m10:38:54.397383 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m10:38:54.398555 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m10:38:54.399831 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m10:38:54.405598 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m10:38:54.407921 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m10:38:54.411415 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:38:54.412824 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m10:38:54.413766 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m10:38:54.414826 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m10:38:54.415940 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m10:38:54.420916 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m10:38:54.425044 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m10:38:54.426037 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m10:38:54.430120 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:38:54.433051 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m10:38:54.434987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd9cd36a-ce34-4a6e-a664-793330d9775c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7092c0e82b60>]}
[0m10:38:54.437617 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m10:38:54.438573 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd9cd36a-ce34-4a6e-a664-793330d9775c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7092bebb8430>]}
[0m10:38:54.440331 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.63s]
[0m10:38:54.442262 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd9cd36a-ce34-4a6e-a664-793330d9775c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7092bebf8fd0>]}
[0m10:38:54.445803 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd9cd36a-ce34-4a6e-a664-793330d9775c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7092be141e40>]}
[0m10:38:54.444275 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.62s]
[0m10:38:54.448090 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m10:38:54.450025 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.64s]
[0m10:38:54.452359 [info ] [Thread-3 (]: 3 of 4 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.64s]
[0m10:38:54.454285 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m10:38:54.455836 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m10:38:54.457474 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m10:38:54.460667 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:54.461843 [debug] [MainThread]: On master: BEGIN
[0m10:38:54.462714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:38:54.475306 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m10:38:54.476196 [debug] [MainThread]: On master: COMMIT
[0m10:38:54.476964 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:54.477623 [debug] [MainThread]: On master: COMMIT
[0m10:38:54.478626 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:38:54.479418 [debug] [MainThread]: On master: Close
[0m10:38:54.480458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:54.481185 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m10:38:54.481809 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m10:38:54.482451 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m10:38:54.483092 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m10:38:54.484025 [info ] [MainThread]: 
[0m10:38:54.485326 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m10:38:54.488009 [debug] [MainThread]: Command end result
[0m10:38:54.527918 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:38:54.530775 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:38:54.544260 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m10:38:54.545064 [info ] [MainThread]: 
[0m10:38:54.545861 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:38:54.546654 [info ] [MainThread]: 
[0m10:38:54.547430 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:38:54.549074 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5945244, "process_in_blocks": "0", "process_kernel_time": 0.293527, "process_mem_max_rss": "116540", "process_out_blocks": "2688", "process_user_time": 4.474039}
[0m10:38:54.549996 [debug] [MainThread]: Command `dbt run` succeeded at 10:38:54.549825 after 2.60 seconds
[0m10:38:54.551145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7092bfe48e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7092c0d121a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7092bfd06980>]}
[0m10:38:54.552378 [debug] [MainThread]: Flushing usage events
[0m10:39:00.694025 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:17:57.564753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787117d5d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787118c0a680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787118c0a620>]}


============================== 11:17:57.568642 | 13c587b8-77ea-4666-89a6-cd39d6c16b43 ==============================
[0m11:17:57.568642 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:17:57.569444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:17:57.790416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13c587b8-77ea-4666-89a6-cd39d6c16b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787118d79ed0>]}
[0m11:17:57.874648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13c587b8-77ea-4666-89a6-cd39d6c16b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787118b9a8f0>]}
[0m11:17:57.875737 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:17:58.009562 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:17:58.170030 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:17:58.170872 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_floorsize_ranked_avg_prices.sql
[0m11:17:58.520181 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m11:17:58.540630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13c587b8-77ea-4666-89a6-cd39d6c16b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787115fe2980>]}
[0m11:17:58.652101 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m11:17:58.656209 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m11:17:58.670415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13c587b8-77ea-4666-89a6-cd39d6c16b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787115fbacb0>]}
[0m11:17:58.671301 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m11:17:58.671909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13c587b8-77ea-4666-89a6-cd39d6c16b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787115fbace0>]}
[0m11:17:58.674222 [info ] [MainThread]: 
[0m11:17:58.674888 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:17:58.675382 [info ] [MainThread]: 
[0m11:17:58.676165 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:17:58.683965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m11:17:58.728547 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m11:17:58.729348 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m11:17:58.730063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:58.740049 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m11:17:58.741788 [debug] [ThreadPool]: On list_foo: Close
[0m11:17:58.743965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m11:17:58.754495 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m11:17:58.755162 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m11:17:58.755613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:17:58.765965 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m11:17:58.766650 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m11:17:58.767164 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m11:17:58.770315 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m11:17:58.772498 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m11:17:58.773351 [debug] [ThreadPool]: On list_foo_zap: Close
[0m11:17:58.781558 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:58.782287 [debug] [MainThread]: On master: BEGIN
[0m11:17:58.782795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:17:58.791573 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:17:58.792205 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:58.792753 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:17:58.797945 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m11:17:58.799862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13c587b8-77ea-4666-89a6-cd39d6c16b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787118bd7ac0>]}
[0m11:17:58.800641 [debug] [MainThread]: On master: ROLLBACK
[0m11:17:58.801431 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:58.801974 [debug] [MainThread]: On master: BEGIN
[0m11:17:58.802991 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:17:58.803570 [debug] [MainThread]: On master: COMMIT
[0m11:17:58.804074 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:58.804531 [debug] [MainThread]: On master: COMMIT
[0m11:17:58.805238 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:17:58.805768 [debug] [MainThread]: On master: Close
[0m11:17:58.808958 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m11:17:58.809694 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m11:17:58.810341 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m11:17:58.811084 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m11:17:58.812199 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m11:17:58.813600 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m11:17:58.814872 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m11:17:58.815995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m11:17:58.817015 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m11:17:58.818655 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m11:17:58.819513 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m11:17:58.820429 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m11:17:58.821856 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m11:17:58.823238 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m11:17:58.824574 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m11:17:58.836305 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m11:17:58.837611 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m11:17:58.843908 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m11:17:58.906928 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m11:17:58.911252 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m11:17:58.913700 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m11:17:58.920682 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m11:17:58.926978 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m11:17:58.938724 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m11:17:59.092455 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m11:17:59.096323 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m11:17:59.097299 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m11:17:59.098753 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m11:17:59.099920 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m11:17:59.100996 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m11:17:59.101641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:17:59.102550 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m11:17:59.103355 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m11:17:59.104789 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m11:17:59.105813 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m11:17:59.106709 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m11:17:59.107390 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:17:59.108106 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:17:59.108890 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m11:17:59.109964 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:17:59.111664 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m11:17:59.113296 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m11:17:59.114484 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m11:17:59.118796 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m11:17:59.119627 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m11:17:59.120326 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m11:17:59.120997 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m11:17:59.121697 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m11:17:59.131676 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m11:17:59.132551 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m11:17:59.133451 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m11:17:59.134117 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m11:17:59.134721 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m11:17:59.135447 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m11:17:59.137078 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select
id,
neighborhood, floor_size_rank,
price_rent/floor_size as price_rent_per_m2, 
price_rent, 
price_sale, price_condominium, rent_plus_condo,
floor_size, rooms, suites, bathrooms 
from rank_floorsize 
order by price_rent_per_m2
  );
[0m11:17:59.138805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:17:59.145794 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m11:17:59.147573 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m11:17:59.162014 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m11:17:59.163322 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m11:17:59.168742 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m11:17:59.175394 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m11:17:59.176055 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m11:17:59.182674 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m11:17:59.183455 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m11:17:59.184121 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m11:17:59.184904 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m11:17:59.185646 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:17:59.186346 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m11:17:59.187073 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:17:59.189539 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m11:17:59.190521 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:17:59.194871 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m11:17:59.195986 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m11:17:59.196958 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m11:17:59.200144 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m11:17:59.200900 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m11:17:59.212287 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m11:17:59.211632 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m11:17:59.214090 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m11:17:59.215008 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m11:17:59.221436 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m11:17:59.223024 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m11:17:59.224039 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m11:17:59.229137 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m11:17:59.230164 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m11:17:59.230933 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m11:17:59.233246 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m11:17:59.233984 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m11:17:59.238136 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m11:17:59.239334 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m11:17:59.240357 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:17:59.245997 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m11:17:59.248688 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m11:17:59.252616 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m11:17:59.253570 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m11:17:59.256496 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m11:17:59.258225 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m11:17:59.262017 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m11:17:59.265599 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m11:17:59.266764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c587b8-77ea-4666-89a6-cd39d6c16b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78711546f100>]}
[0m11:17:59.267603 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:17:59.268741 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c587b8-77ea-4666-89a6-cd39d6c16b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78711535a350>]}
[0m11:17:59.269536 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:17:59.270965 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.45s]
[0m11:17:59.273064 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m11:17:59.274091 [info ] [Thread-3 (]: 3 of 4 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.45s]
[0m11:17:59.277055 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m11:17:59.278428 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m11:17:59.280548 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m11:17:59.281956 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c587b8-77ea-4666-89a6-cd39d6c16b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787116764640>]}
[0m11:17:59.283548 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c587b8-77ea-4666-89a6-cd39d6c16b43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78711546ec50>]}
[0m11:17:59.284940 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.46s]
[0m11:17:59.286094 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.46s]
[0m11:17:59.287120 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m11:17:59.287990 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m11:17:59.290402 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:59.291132 [debug] [MainThread]: On master: BEGIN
[0m11:17:59.291621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:17:59.301343 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m11:17:59.301996 [debug] [MainThread]: On master: COMMIT
[0m11:17:59.302480 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:59.302946 [debug] [MainThread]: On master: COMMIT
[0m11:17:59.303716 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:17:59.304304 [debug] [MainThread]: On master: Close
[0m11:17:59.305085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:59.305632 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m11:17:59.306124 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m11:17:59.306590 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m11:17:59.307053 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m11:17:59.307677 [info ] [MainThread]: 
[0m11:17:59.308247 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m11:17:59.309760 [debug] [MainThread]: Command end result
[0m11:17:59.339035 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m11:17:59.341252 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m11:17:59.350729 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m11:17:59.351340 [info ] [MainThread]: 
[0m11:17:59.351918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:17:59.352449 [info ] [MainThread]: 
[0m11:17:59.353005 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m11:17:59.354306 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8674718, "process_in_blocks": "0", "process_kernel_time": 0.195939, "process_mem_max_rss": "115672", "process_out_blocks": "2680", "process_user_time": 3.233993}
[0m11:17:59.355026 [debug] [MainThread]: Command `dbt run` succeeded at 11:17:59.354912 after 1.87 seconds
[0m11:17:59.355568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787117d5d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78711802fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787115fb64a0>]}
[0m11:17:59.356142 [debug] [MainThread]: Flushing usage events
[0m11:18:05.497193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:35:19.871754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c3ff139120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c40000e5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c40000e560>]}


============================== 20:35:19.875034 | 52ed2739-f11e-4c95-8bf4-06a92216af5b ==============================
[0m20:35:19.875034 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:35:19.875825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:35:20.099945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52ed2739-f11e-4c95-8bf4-06a92216af5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c3fe466da0>]}
[0m20:35:20.196997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52ed2739-f11e-4c95-8bf4-06a92216af5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c3feec0b20>]}
[0m20:35:20.198651 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:35:20.358928 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:35:20.544715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:35:20.545393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:35:20.556064 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m20:35:20.610976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52ed2739-f11e-4c95-8bf4-06a92216af5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c3fd58a9e0>]}
[0m20:35:20.739197 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m20:35:20.743559 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m20:35:20.758787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52ed2739-f11e-4c95-8bf4-06a92216af5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c3fd43a140>]}
[0m20:35:20.759673 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m20:35:20.760283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52ed2739-f11e-4c95-8bf4-06a92216af5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c3fd43a110>]}
[0m20:35:20.762556 [info ] [MainThread]: 
[0m20:35:20.763200 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:35:20.763753 [info ] [MainThread]: 
[0m20:35:20.764848 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:35:20.772533 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:35:20.825089 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:35:20.825737 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:35:20.826223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:20.837109 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m20:35:20.839035 [debug] [ThreadPool]: On list_foo: Close
[0m20:35:20.841470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m20:35:20.851544 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m20:35:20.852182 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m20:35:20.852667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:35:20.861241 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:35:20.861865 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m20:35:20.862368 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m20:35:20.866430 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m20:35:20.869032 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m20:35:20.869938 [debug] [ThreadPool]: On list_foo_zap: Close
[0m20:35:20.877749 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:20.878380 [debug] [MainThread]: On master: BEGIN
[0m20:35:20.878837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:20.888452 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:35:20.889084 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:20.889730 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:35:20.893925 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m20:35:20.895888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52ed2739-f11e-4c95-8bf4-06a92216af5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c3fd490c10>]}
[0m20:35:20.896617 [debug] [MainThread]: On master: ROLLBACK
[0m20:35:20.897669 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:20.898595 [debug] [MainThread]: On master: BEGIN
[0m20:35:20.899998 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:35:20.900807 [debug] [MainThread]: On master: COMMIT
[0m20:35:20.901634 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:20.902118 [debug] [MainThread]: On master: COMMIT
[0m20:35:20.902877 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:35:20.903432 [debug] [MainThread]: On master: Close
[0m20:35:20.906655 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m20:35:20.907402 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:35:20.908175 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m20:35:20.908906 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:35:20.909542 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m20:35:20.910645 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m20:35:20.912252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m20:35:20.913692 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m20:35:20.915589 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m20:35:20.916758 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m20:35:20.917668 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m20:35:20.918603 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m20:35:20.919378 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m20:35:20.920053 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:35:20.931562 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:35:20.933783 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:35:20.934664 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m20:35:20.938886 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:35:20.943442 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:35:20.948258 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m20:35:20.949470 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m20:35:20.950874 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:35:20.957175 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:35:20.968423 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m20:35:21.111382 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:35:21.113355 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m20:35:21.116033 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:35:21.117599 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:35:21.119111 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:35:21.120229 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:35:21.121230 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:35:21.122090 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m20:35:21.122768 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m20:35:21.123700 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:35:21.124760 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m20:35:21.125913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:21.126767 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:35:21.127470 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m20:35:21.128056 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:35:21.128997 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:35:21.138325 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m20:35:21.139357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m20:35:21.140451 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:35:21.141460 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m20:35:21.142509 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:35:21.143248 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m20:35:21.143983 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m20:35:21.144629 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:35:21.145233 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m20:35:21.145827 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:35:21.146498 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select
id,
neighborhood, floor_size_rank,
price_rent/floor_size as price_rent_per_m2, 
price_rent, 
price_sale, price_condominium, rent_plus_condo,
floor_size, rooms, suites, bathrooms 
from rank_floorsize 
order by price_rent_per_m2
  );
[0m20:35:21.147659 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m20:35:21.150635 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:35:21.152167 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:35:21.158363 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:35:21.159278 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m20:35:21.170027 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:35:21.171508 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:35:21.177243 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:35:21.183997 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:35:21.184960 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m20:35:21.185768 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m20:35:21.186555 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m20:35:21.187292 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m20:35:21.188972 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:21.189906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:35:21.190845 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:35:21.258450 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.070 seconds
[0m20:35:21.302420 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m20:35:21.304911 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m20:35:21.309214 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m20:35:21.312102 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m20:35:21.313105 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:35:21.314044 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:35:21.315187 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:35:21.316343 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:35:21.317483 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m20:35:21.318684 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m20:35:21.319738 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m20:35:21.320789 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m20:35:21.323719 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:35:21.324977 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m20:35:21.326048 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m20:35:21.326665 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m20:35:21.340975 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m20:35:21.341778 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m20:35:21.345901 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m20:35:21.350733 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m20:35:21.358322 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:35:21.359876 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:35:21.362669 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:35:21.364257 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:35:21.365337 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m20:35:21.366373 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m20:35:21.367620 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m20:35:21.368759 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m20:35:21.370011 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:35:21.370869 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:35:21.371655 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:35:21.372319 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:35:21.377054 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m20:35:21.380064 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m20:35:21.383030 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m20:35:21.385905 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m20:35:21.391027 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ed2739-f11e-4c95-8bf4-06a92216af5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c3fcda7010>]}
[0m20:35:21.391789 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ed2739-f11e-4c95-8bf4-06a92216af5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c3fcda6cb0>]}
[0m20:35:21.392801 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.47s]
[0m20:35:21.393672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ed2739-f11e-4c95-8bf4-06a92216af5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c3fcda72b0>]}
[0m20:35:21.394869 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ed2739-f11e-4c95-8bf4-06a92216af5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c3fd490190>]}
[0m20:35:21.396029 [info ] [Thread-3 (]: 3 of 4 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.47s]
[0m20:35:21.398145 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:35:21.399783 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.48s]
[0m20:35:21.401295 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.47s]
[0m20:35:21.402345 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:35:21.403483 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m20:35:21.404310 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m20:35:21.406051 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:21.406673 [debug] [MainThread]: On master: BEGIN
[0m20:35:21.407163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:21.416820 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:35:21.417691 [debug] [MainThread]: On master: COMMIT
[0m20:35:21.418249 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:21.418722 [debug] [MainThread]: On master: COMMIT
[0m20:35:21.419473 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:35:21.420002 [debug] [MainThread]: On master: Close
[0m20:35:21.420811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:21.421358 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m20:35:21.421832 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m20:35:21.422311 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m20:35:21.422788 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m20:35:21.423751 [info ] [MainThread]: 
[0m20:35:21.424519 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m20:35:21.426092 [debug] [MainThread]: Command end result
[0m20:35:21.456861 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m20:35:21.459164 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m20:35:21.469234 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m20:35:21.469869 [info ] [MainThread]: 
[0m20:35:21.470744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:35:21.471557 [info ] [MainThread]: 
[0m20:35:21.472146 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:35:21.473458 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6792655, "process_in_blocks": "0", "process_kernel_time": 0.211548, "process_mem_max_rss": "112708", "process_out_blocks": "1840", "process_user_time": 3.115352}
[0m20:35:21.474303 [debug] [MainThread]: Command `dbt run` succeeded at 20:35:21.474112 after 1.68 seconds
[0m20:35:21.474887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c3ff139120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c3fe7aaa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c3fe42f430>]}
[0m20:35:21.475490 [debug] [MainThread]: Flushing usage events
[0m20:35:22.846547 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:43.611471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71df7b794e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71df7c66a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71df7c66a260>]}


============================== 20:50:43.614704 | c480b364-a97e-4edc-a47c-7eee9b0659e8 ==============================
[0m20:50:43.614704 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:50:43.615496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:50:43.826321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c480b364-a97e-4edc-a47c-7eee9b0659e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71df7a7e95a0>]}
[0m20:50:43.901304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c480b364-a97e-4edc-a47c-7eee9b0659e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71df7aea7b50>]}
[0m20:50:43.902348 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:50:44.052786 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:50:44.248422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:50:44.249253 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_floorsize_ranked_avg_prices.sql
[0m20:50:44.592288 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m20:50:44.613368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c480b364-a97e-4edc-a47c-7eee9b0659e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71df799ea620>]}
[0m20:50:44.723857 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m20:50:44.727892 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m20:50:44.740475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c480b364-a97e-4edc-a47c-7eee9b0659e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71df799ea9e0>]}
[0m20:50:44.741297 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m20:50:44.741935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c480b364-a97e-4edc-a47c-7eee9b0659e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71df799eaa40>]}
[0m20:50:44.744177 [info ] [MainThread]: 
[0m20:50:44.744768 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:50:44.745254 [info ] [MainThread]: 
[0m20:50:44.745977 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:50:44.754250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:50:44.800072 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:50:44.800717 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:50:44.801219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:44.811999 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m20:50:44.813881 [debug] [ThreadPool]: On list_foo: Close
[0m20:50:44.816781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m20:50:44.830573 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m20:50:44.831382 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m20:50:44.832008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:44.841409 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m20:50:44.842050 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m20:50:44.842530 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m20:50:44.845763 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m20:50:44.848408 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m20:50:44.849206 [debug] [ThreadPool]: On list_foo_zap: Close
[0m20:50:44.856465 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:44.857080 [debug] [MainThread]: On master: BEGIN
[0m20:50:44.857679 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:44.866521 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:50:44.867161 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:44.867711 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:50:44.872469 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m20:50:44.877442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c480b364-a97e-4edc-a47c-7eee9b0659e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71df79943a30>]}
[0m20:50:44.878969 [debug] [MainThread]: On master: ROLLBACK
[0m20:50:44.880077 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:44.880839 [debug] [MainThread]: On master: BEGIN
[0m20:50:44.882095 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:50:44.882806 [debug] [MainThread]: On master: COMMIT
[0m20:50:44.883689 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:44.884656 [debug] [MainThread]: On master: COMMIT
[0m20:50:44.886162 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:50:44.887142 [debug] [MainThread]: On master: Close
[0m20:50:44.891418 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m20:50:44.892472 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:50:44.894784 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:50:44.893821 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m20:50:44.896299 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m20:50:44.897532 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m20:50:44.899208 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m20:50:44.900789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m20:50:44.902006 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m20:50:44.903344 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m20:50:44.904630 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m20:50:44.905891 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m20:50:44.907167 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m20:50:44.908068 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:50:44.909218 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:50:44.920412 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m20:50:44.925181 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:50:44.932418 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:50:44.998451 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:50:45.002877 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m20:50:45.004446 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m20:50:45.016365 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:50:45.028739 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m20:50:45.039788 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:50:45.118148 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:50:45.119076 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:50:45.120682 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:50:45.124029 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m20:50:45.125644 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:50:45.126389 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:50:45.127056 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m20:50:45.127707 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m20:50:45.128349 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:50:45.129010 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:50:45.129610 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:50:45.130373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:45.131601 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m20:50:45.132454 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m20:50:45.133569 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:50:45.134731 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:50:45.142194 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m20:50:45.143101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m20:50:45.143868 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:50:45.144697 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:50:45.145429 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m20:50:45.146046 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m20:50:45.146859 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m20:50:45.147904 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m20:50:45.148673 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:50:45.149749 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:50:45.151054 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m20:50:45.152853 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select
*,
price_rent/floor_size as price_rent_per_m2, 
from rank_floorsize 
order by price_rent_per_m2
  );
[0m20:50:45.154017 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:50:45.154906 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:50:45.161887 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 28: from rank_floorsize 
         ^

[0m20:50:45.163329 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:50:45.168308 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:50:45.174112 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:50:45.174785 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: ROLLBACK
[0m20:50:45.179702 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:50:45.180734 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices" rename to "gold_flat_kit_studio_avg_prices__dbt_backup"
[0m20:50:45.181871 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m20:50:45.183199 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices" rename to "gold_house_avg_prices__dbt_backup"
[0m20:50:45.184556 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m20:50:45.186155 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:50:45.187118 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:50:45.187984 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:50:45.193103 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:50:45.199893 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:50:45.205000 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:50:45.205851 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m20:50:45.207228 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m20:50:45.208272 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m20:50:45.209993 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:50:45.210834 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:50:45.216792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m20:50:45.245315 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m20:50:45.250118 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m20:50:45.253003 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m20:50:45.254324 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:50:45.255844 [debug] [Thread-3 (]: Database Error in model gold_floorsize_ranked_avg_prices (models/mart/gold_floorsize_ranked_avg_prices.sql)
  syntax error at or near "from"
  LINE 28: from rank_floorsize 
           ^
  compiled code at target/run/zap_imoveis/models/mart/gold_floorsize_ranked_avg_prices.sql
[0m20:50:45.256628 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:50:45.257229 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:50:45.257823 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m20:50:45.260971 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m20:50:45.261767 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c480b364-a97e-4edc-a47c-7eee9b0659e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71df7ba533a0>]}
[0m20:50:45.262404 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m20:50:45.263663 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model zap.gold_floorsize_ranked_avg_prices ...... [[31mERROR[0m in 0.35s]
[0m20:50:45.264836 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:50:45.265751 [debug] [Thread-7 (]: Marking all children of 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' to be skipped because of status 'error'.  Reason: Database Error in model gold_floorsize_ranked_avg_prices (models/mart/gold_floorsize_ranked_avg_prices.sql)
  syntax error at or near "from"
  LINE 28: from rank_floorsize 
           ^
  compiled code at target/run/zap_imoveis/models/mart/gold_floorsize_ranked_avg_prices.sql.
[0m20:50:45.266443 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:50:45.267039 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m20:50:45.268516 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m20:50:45.285837 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m20:50:45.288104 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m20:50:45.293286 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m20:50:45.299842 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:50:45.301748 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:50:45.303084 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:50:45.304116 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m20:50:45.305245 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m20:50:45.306528 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m20:50:45.310273 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:50:45.311110 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:50:45.314535 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m20:50:45.315388 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m20:50:45.318564 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m20:50:45.321835 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m20:50:45.323179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c480b364-a97e-4edc-a47c-7eee9b0659e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71df7c7bab00>]}
[0m20:50:45.324388 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.42s]
[0m20:50:45.326098 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c480b364-a97e-4edc-a47c-7eee9b0659e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71df7a11e590>]}
[0m20:50:45.327477 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c480b364-a97e-4edc-a47c-7eee9b0659e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71df79a4bbb0>]}
[0m20:50:45.328394 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m20:50:45.329734 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.42s]
[0m20:50:45.331207 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.42s]
[0m20:50:45.332819 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:50:45.333746 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m20:50:45.335723 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:45.336316 [debug] [MainThread]: On master: BEGIN
[0m20:50:45.336892 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:45.346300 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:50:45.346903 [debug] [MainThread]: On master: COMMIT
[0m20:50:45.347385 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:45.347821 [debug] [MainThread]: On master: COMMIT
[0m20:50:45.348514 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:50:45.349038 [debug] [MainThread]: On master: Close
[0m20:50:45.349824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:45.350384 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m20:50:45.350844 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m20:50:45.351290 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m20:50:45.351705 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m20:50:45.352278 [info ] [MainThread]: 
[0m20:50:45.352854 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m20:50:45.354415 [debug] [MainThread]: Command end result
[0m20:50:45.383525 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m20:50:45.385604 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m20:50:45.395559 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m20:50:45.396122 [info ] [MainThread]: 
[0m20:50:45.396669 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:50:45.397235 [info ] [MainThread]: 
[0m20:50:45.397818 [error] [MainThread]:   Database Error in model gold_floorsize_ranked_avg_prices (models/mart/gold_floorsize_ranked_avg_prices.sql)
  syntax error at or near "from"
  LINE 28: from rank_floorsize 
           ^
  compiled code at target/run/zap_imoveis/models/mart/gold_floorsize_ranked_avg_prices.sql
[0m20:50:45.398342 [info ] [MainThread]: 
[0m20:50:45.398854 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m20:50:45.400045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8609966, "process_in_blocks": "0", "process_kernel_time": 0.210892, "process_mem_max_rss": "116004", "process_out_blocks": "2688", "process_user_time": 3.098414}
[0m20:50:45.400713 [debug] [MainThread]: Command `dbt run` failed at 20:50:45.400606 after 1.86 seconds
[0m20:50:45.401240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71df7b794e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71df7bc3cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71df7b65a620>]}
[0m20:50:45.401784 [debug] [MainThread]: Flushing usage events
[0m20:50:46.708629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:10.264512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7281c7dd4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7281c8c6a320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7281c8c6a2c0>]}


============================== 20:51:10.268079 | 5fe5f0b3-eed5-4420-90c3-135edb480d93 ==============================
[0m20:51:10.268079 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:51:10.268868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:51:10.478067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fe5f0b3-eed5-4420-90c3-135edb480d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7281c8c17970>]}
[0m20:51:10.552793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fe5f0b3-eed5-4420-90c3-135edb480d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7281c6dd06d0>]}
[0m20:51:10.553841 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:51:10.683733 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:51:10.834978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:51:10.835799 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_floorsize_ranked_avg_prices.sql
[0m20:51:11.157601 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m20:51:11.178911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fe5f0b3-eed5-4420-90c3-135edb480d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7281c5fe6680>]}
[0m20:51:11.285248 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m20:51:11.289305 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m20:51:11.301647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fe5f0b3-eed5-4420-90c3-135edb480d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7281c5fbd840>]}
[0m20:51:11.302398 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m20:51:11.302899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fe5f0b3-eed5-4420-90c3-135edb480d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7281c5fbd870>]}
[0m20:51:11.305047 [info ] [MainThread]: 
[0m20:51:11.305690 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:51:11.306253 [info ] [MainThread]: 
[0m20:51:11.307338 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:51:11.316864 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:51:11.361754 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:51:11.362357 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:51:11.362795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:11.374190 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m20:51:11.375888 [debug] [ThreadPool]: On list_foo: Close
[0m20:51:11.378529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m20:51:11.387524 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m20:51:11.388112 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m20:51:11.388564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:11.396748 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:51:11.397364 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m20:51:11.397838 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m20:51:11.400939 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m20:51:11.402762 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m20:51:11.403522 [debug] [ThreadPool]: On list_foo_zap: Close
[0m20:51:11.411563 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:11.412144 [debug] [MainThread]: On master: BEGIN
[0m20:51:11.412601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:11.422604 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m20:51:11.423210 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:11.423745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:51:11.429313 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m20:51:11.432529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fe5f0b3-eed5-4420-90c3-135edb480d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7281c9003370>]}
[0m20:51:11.433188 [debug] [MainThread]: On master: ROLLBACK
[0m20:51:11.433988 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:11.434508 [debug] [MainThread]: On master: BEGIN
[0m20:51:11.435421 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:51:11.435930 [debug] [MainThread]: On master: COMMIT
[0m20:51:11.436445 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:11.436904 [debug] [MainThread]: On master: COMMIT
[0m20:51:11.437642 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:51:11.438251 [debug] [MainThread]: On master: Close
[0m20:51:11.441427 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m20:51:11.442117 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:51:11.442922 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m20:51:11.443656 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:51:11.444725 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m20:51:11.445935 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m20:51:11.446777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m20:51:11.447568 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m20:51:11.448466 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m20:51:11.449763 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m20:51:11.450760 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m20:51:11.451880 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m20:51:11.452852 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:51:11.454316 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m20:51:11.465819 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:51:11.467764 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:51:11.474948 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:51:11.475661 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m20:51:11.537405 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:51:11.542315 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m20:51:11.543236 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m20:51:11.544571 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:51:11.566896 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:51:11.573590 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m20:51:11.625362 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:51:11.629110 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m20:51:11.632208 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:51:11.633830 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:51:11.635451 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:51:11.636743 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m20:51:11.637545 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:51:11.638202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:11.639055 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:51:11.639880 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:51:11.640507 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m20:51:11.641511 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m20:51:11.642409 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m20:51:11.643178 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:51:11.643949 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:51:11.644838 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:51:11.650286 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m20:51:11.651404 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:51:11.652499 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m20:51:11.654046 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m20:51:11.655259 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:51:11.656182 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m20:51:11.656906 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m20:51:11.657676 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:51:11.658404 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m20:51:11.659019 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:51:11.665248 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:51:11.670730 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:51:11.671440 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:51:11.672095 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m20:51:11.677475 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:51:11.678441 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices" rename to "gold_apartment_avg_prices__dbt_backup"
[0m20:51:11.679769 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select
*,
price_rent/floor_size as price_rent_per_m2
from rank_floorsize 
order by price_rent_per_m2
  );
[0m20:51:11.681018 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices" rename to "gold_flat_kit_studio_avg_prices__dbt_backup"
[0m20:51:11.682612 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:51:11.683622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:51:11.688289 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:51:11.689312 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:51:11.695512 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m20:51:11.695085 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:51:11.696423 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m20:51:11.701338 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:51:11.707652 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:51:11.708312 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m20:51:11.709009 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices" rename to "gold_house_avg_prices__dbt_backup"
[0m20:51:11.709712 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:51:11.710319 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices" rename to "gold_floorsize_ranked_avg_prices__dbt_backup"
[0m20:51:11.716837 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:51:11.718072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m20:51:11.734108 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m20:51:11.739970 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m20:51:11.745443 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:51:11.748236 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m20:51:11.753456 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:51:11.754420 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:51:11.755044 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m20:51:11.755673 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:51:11.756299 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m20:51:11.756891 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m20:51:11.757565 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m20:51:11.758248 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:51:11.760989 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m20:51:11.761690 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:51:11.762325 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:51:11.762885 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m20:51:11.763490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m20:51:11.766081 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m20:51:11.766977 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m20:51:11.776179 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m20:51:11.780707 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m20:51:11.781664 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:51:11.788221 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m20:51:11.790702 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:51:11.791962 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:51:11.792974 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m20:51:11.797240 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m20:51:11.798230 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m20:51:11.799026 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m20:51:11.800643 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:51:11.801528 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m20:51:11.802294 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:51:11.803585 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:51:11.804304 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:51:11.808516 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m20:51:11.809356 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m20:51:11.813824 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m20:51:11.816747 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m20:51:11.818230 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:51:11.820362 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m20:51:11.823461 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe5f0b3-eed5-4420-90c3-135edb480d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7281c80913c0>]}
[0m20:51:11.824806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe5f0b3-eed5-4420-90c3-135edb480d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7281c5fbfc70>]}
[0m20:51:11.825536 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m20:51:11.826775 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.37s]
[0m20:51:11.827956 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe5f0b3-eed5-4420-90c3-135edb480d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7281c545e920>]}
[0m20:51:11.828938 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.38s]
[0m20:51:11.830484 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:51:11.831524 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.37s]
[0m20:51:11.832408 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:51:11.833724 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m20:51:11.835463 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m20:51:11.837973 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m20:51:11.839884 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fe5f0b3-eed5-4420-90c3-135edb480d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7281c6de45b0>]}
[0m20:51:11.841345 [info ] [Thread-3 (]: 3 of 4 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.39s]
[0m20:51:11.842419 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:51:11.844103 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:11.844696 [debug] [MainThread]: On master: BEGIN
[0m20:51:11.845145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:51:11.856338 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:51:11.857148 [debug] [MainThread]: On master: COMMIT
[0m20:51:11.858363 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:11.859182 [debug] [MainThread]: On master: COMMIT
[0m20:51:11.859945 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:51:11.860480 [debug] [MainThread]: On master: Close
[0m20:51:11.861218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:11.861725 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m20:51:11.862152 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m20:51:11.862569 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m20:51:11.862971 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m20:51:11.863542 [info ] [MainThread]: 
[0m20:51:11.864047 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m20:51:11.865590 [debug] [MainThread]: Command end result
[0m20:51:11.894299 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m20:51:11.896414 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m20:51:11.905355 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m20:51:11.906041 [info ] [MainThread]: 
[0m20:51:11.906616 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:51:11.907122 [info ] [MainThread]: 
[0m20:51:11.907713 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:51:11.909218 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7174336, "process_in_blocks": "0", "process_kernel_time": 0.179123, "process_mem_max_rss": "115484", "process_out_blocks": "2688", "process_user_time": 2.998069}
[0m20:51:11.909903 [debug] [MainThread]: Command `dbt run` succeeded at 20:51:11.909797 after 1.72 seconds
[0m20:51:11.910426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7281c7dd4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7281c8c17970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7281c7c9b0a0>]}
[0m20:51:11.910953 [debug] [MainThread]: Flushing usage events
[0m20:51:13.129186 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:09:35.148071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804aa51d060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804ab3c2500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804ab3c24a0>]}


============================== 13:09:35.152000 | 319ec057-6192-4091-8217-8d1a173274c0 ==============================
[0m13:09:35.152000 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:09:35.152885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:09:35.402041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '319ec057-6192-4091-8217-8d1a173274c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804ab3671c0>]}
[0m13:09:35.485070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '319ec057-6192-4091-8217-8d1a173274c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804ab3a47f0>]}
[0m13:09:35.487287 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:09:35.633091 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:09:35.831711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:09:35.832338 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:09:35.841192 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m13:09:35.892812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '319ec057-6192-4091-8217-8d1a173274c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804a8838130>]}
[0m13:09:36.009464 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m13:09:36.014006 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m13:09:36.039545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '319ec057-6192-4091-8217-8d1a173274c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804a881a1a0>]}
[0m13:09:36.040561 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m13:09:36.041497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '319ec057-6192-4091-8217-8d1a173274c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804a881a110>]}
[0m13:09:36.044210 [info ] [MainThread]: 
[0m13:09:36.045024 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:09:36.045664 [info ] [MainThread]: 
[0m13:09:36.046535 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:09:36.052872 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m13:09:36.110376 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m13:09:36.111052 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m13:09:36.111557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:36.122478 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m13:09:36.124830 [debug] [ThreadPool]: On list_foo: Close
[0m13:09:36.127692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m13:09:36.137588 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m13:09:36.138454 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m13:09:36.139914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:09:36.150771 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:09:36.151458 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m13:09:36.152051 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m13:09:36.168086 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m13:09:36.170724 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m13:09:36.171656 [debug] [ThreadPool]: On list_foo_zap: Close
[0m13:09:36.179969 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:36.180698 [debug] [MainThread]: On master: BEGIN
[0m13:09:36.181276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:09:36.189215 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:09:36.189928 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:36.190663 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:09:36.196844 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m13:09:36.198994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '319ec057-6192-4091-8217-8d1a173274c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804a8874b20>]}
[0m13:09:36.199767 [debug] [MainThread]: On master: ROLLBACK
[0m13:09:36.200571 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:36.201128 [debug] [MainThread]: On master: BEGIN
[0m13:09:36.201972 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:09:36.202713 [debug] [MainThread]: On master: COMMIT
[0m13:09:36.203346 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:36.203862 [debug] [MainThread]: On master: COMMIT
[0m13:09:36.204778 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:09:36.205492 [debug] [MainThread]: On master: Close
[0m13:09:36.209172 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m13:09:36.210106 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m13:09:36.210814 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m13:09:36.211578 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m13:09:36.212372 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m13:09:36.213427 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m13:09:36.214615 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m13:09:36.215915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m13:09:36.216776 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m13:09:36.218185 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m13:09:36.219823 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m13:09:36.221076 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m13:09:36.222124 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m13:09:36.223046 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m13:09:36.223930 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m13:09:36.235869 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m13:09:36.237356 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:09:36.243672 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m13:09:36.248081 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m13:09:36.252379 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m13:09:36.254224 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m13:09:36.260914 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m13:09:36.267088 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m13:09:36.294293 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m13:09:36.408105 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m13:09:36.408940 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m13:09:36.410439 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m13:09:36.414359 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:09:36.416045 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m13:09:36.416819 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m13:09:36.417524 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:09:36.418667 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:09:36.419793 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m13:09:36.420590 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m13:09:36.421393 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m13:09:36.422604 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m13:09:36.423965 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m13:09:36.425140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:36.426143 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:09:36.427203 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:09:36.428001 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m13:09:36.429330 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m13:09:36.430120 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m13:09:36.436523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:09:36.437470 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:09:36.438351 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m13:09:36.439014 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:09:36.439771 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m13:09:36.440668 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m13:09:36.441767 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m13:09:36.454199 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m13:09:36.454919 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m13:09:36.456017 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m13:09:36.457408 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m13:09:36.458430 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select
*,
price_rent/floor_size as price_rent_per_m2
from rank_floorsize 
order by price_rent_per_m2
  );
[0m13:09:36.459568 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:09:36.464995 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:09:36.465747 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:09:36.466532 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:09:36.467144 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m13:09:36.467755 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:09:36.472222 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m13:09:36.494433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m13:09:36.496407 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m13:09:36.501701 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m13:09:36.502735 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m13:09:36.505573 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m13:09:36.506419 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m13:09:36.507361 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m13:09:36.508429 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:09:36.509357 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:09:36.510110 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m13:09:36.510872 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m13:09:36.511618 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:09:36.513896 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m13:09:36.582314 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m13:09:36.583167 [debug] [Thread-2 (]: SQL status: COMMIT in 0.068 seconds
[0m13:09:36.584215 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m13:09:36.585171 [debug] [Thread-1 (]: SQL status: COMMIT in 0.070 seconds
[0m13:09:36.586268 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m13:09:36.597950 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m13:09:36.600975 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m13:09:36.605441 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m13:09:36.606378 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m13:09:36.612865 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m13:09:36.615195 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m13:09:36.617479 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:09:36.624015 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m13:09:36.623557 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m13:09:36.625843 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m13:09:36.626912 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m13:09:36.631223 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m13:09:36.633026 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m13:09:36.635622 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m13:09:36.637122 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:09:36.638323 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:09:36.639704 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m13:09:36.641559 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m13:09:36.648297 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m13:09:36.650977 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m13:09:36.655481 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:09:36.656966 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m13:09:36.660462 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m13:09:36.663238 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m13:09:36.665685 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319ec057-6192-4091-8217-8d1a173274c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804a8193010>]}
[0m13:09:36.666798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319ec057-6192-4091-8217-8d1a173274c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804a8193160>]}
[0m13:09:36.668046 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.43s]
[0m13:09:36.668924 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319ec057-6192-4091-8217-8d1a173274c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804a8193100>]}
[0m13:09:36.670003 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319ec057-6192-4091-8217-8d1a173274c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804a7c4a8f0>]}
[0m13:09:36.671141 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.44s]
[0m13:09:36.672760 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m13:09:36.674733 [info ] [Thread-3 (]: 3 of 4 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.45s]
[0m13:09:36.676736 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.44s]
[0m13:09:36.678033 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m13:09:36.679297 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m13:09:36.680348 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m13:09:36.682318 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:36.682985 [debug] [MainThread]: On master: BEGIN
[0m13:09:36.683582 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:09:36.694326 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:09:36.695370 [debug] [MainThread]: On master: COMMIT
[0m13:09:36.696315 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:36.697156 [debug] [MainThread]: On master: COMMIT
[0m13:09:36.698438 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:09:36.699491 [debug] [MainThread]: On master: Close
[0m13:09:36.700798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:36.701694 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m13:09:36.702540 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m13:09:36.703339 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m13:09:36.704188 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m13:09:36.705188 [info ] [MainThread]: 
[0m13:09:36.706209 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m13:09:36.709055 [debug] [MainThread]: Command end result
[0m13:09:36.740803 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m13:09:36.744626 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m13:09:36.753402 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m13:09:36.754000 [info ] [MainThread]: 
[0m13:09:36.754604 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:09:36.755124 [info ] [MainThread]: 
[0m13:09:36.755699 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:09:36.757231 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7047015, "process_in_blocks": "34784", "process_kernel_time": 0.284622, "process_mem_max_rss": "112200", "process_out_blocks": "1848", "process_user_time": 3.507676}
[0m13:09:36.758210 [debug] [MainThread]: Command `dbt run` succeeded at 13:09:36.757958 after 1.71 seconds
[0m13:09:36.758910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804aa51d060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804a896a8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7804a896b940>]}
[0m13:09:36.759623 [debug] [MainThread]: Flushing usage events
[0m13:09:37.674744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:37:06.595016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afee31790f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afee4056590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afee4056530>]}


============================== 13:37:06.598758 | 13c59f01-4fb0-4fca-a1d6-78d23cbd5b62 ==============================
[0m13:37:06.598758 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:37:06.599766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:37:06.819658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13c59f01-4fb0-4fca-a1d6-78d23cbd5b62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afee21dada0>]}
[0m13:37:06.910536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13c59f01-4fb0-4fca-a1d6-78d23cbd5b62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afee2893e20>]}
[0m13:37:06.911887 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:37:07.050699 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:37:07.215000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:37:07.215616 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:37:07.223938 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m13:37:07.271522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13c59f01-4fb0-4fca-a1d6-78d23cbd5b62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afee157a9e0>]}
[0m13:37:07.387101 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m13:37:07.391179 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m13:37:07.405180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13c59f01-4fb0-4fca-a1d6-78d23cbd5b62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afee142a200>]}
[0m13:37:07.405977 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m13:37:07.406524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13c59f01-4fb0-4fca-a1d6-78d23cbd5b62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afee142a170>]}
[0m13:37:07.408707 [info ] [MainThread]: 
[0m13:37:07.409426 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:37:07.410234 [info ] [MainThread]: 
[0m13:37:07.411448 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:37:07.417873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m13:37:07.469978 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m13:37:07.470632 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m13:37:07.471108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:07.481968 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m13:37:07.483717 [debug] [ThreadPool]: On list_foo: Close
[0m13:37:07.486602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m13:37:07.496881 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m13:37:07.497518 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m13:37:07.497995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:37:07.506798 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:37:07.507435 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m13:37:07.507927 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m13:37:07.512091 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m13:37:07.513842 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m13:37:07.514701 [debug] [ThreadPool]: On list_foo_zap: Close
[0m13:37:07.521980 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:07.522616 [debug] [MainThread]: On master: BEGIN
[0m13:37:07.523077 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:37:07.532564 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:37:07.533185 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:07.533788 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:37:07.538147 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:37:07.539993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13c59f01-4fb0-4fca-a1d6-78d23cbd5b62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afee1480c10>]}
[0m13:37:07.540723 [debug] [MainThread]: On master: ROLLBACK
[0m13:37:07.541518 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:07.542152 [debug] [MainThread]: On master: BEGIN
[0m13:37:07.543430 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:37:07.544212 [debug] [MainThread]: On master: COMMIT
[0m13:37:07.544908 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:07.545515 [debug] [MainThread]: On master: COMMIT
[0m13:37:07.546542 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:37:07.547204 [debug] [MainThread]: On master: Close
[0m13:37:07.550404 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m13:37:07.551473 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m13:37:07.552359 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m13:37:07.553416 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m13:37:07.554678 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m13:37:07.555985 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m13:37:07.556742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m13:37:07.557558 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m13:37:07.558456 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m13:37:07.559416 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m13:37:07.560463 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m13:37:07.561804 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m13:37:07.562674 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m13:37:07.563792 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m13:37:07.575756 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m13:37:07.578123 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:37:07.582455 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m13:37:07.583455 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m13:37:07.587686 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m13:37:07.592521 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m13:37:07.594277 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m13:37:07.595212 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m13:37:07.617399 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m13:37:07.641070 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m13:37:07.772630 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m13:37:07.779346 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m13:37:07.784880 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m13:37:07.789662 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:37:07.790708 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m13:37:07.792218 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m13:37:07.793571 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m13:37:07.794667 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m13:37:07.795729 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m13:37:07.797088 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:37:07.798320 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:37:07.799202 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m13:37:07.800138 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:37:07.801118 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m13:37:07.802190 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:37:07.803662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:07.810557 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m13:37:07.811861 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m13:37:07.813483 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m13:37:07.814593 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m13:37:07.815603 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m13:37:07.816430 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m13:37:07.817187 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select
*,
price_rent/floor_size as price_rent_per_m2
from rank_floorsize 
order by price_rent_per_m2
  );
[0m13:37:07.818377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m13:37:07.819336 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:37:07.820102 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m13:37:07.821023 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:37:07.827370 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:37:07.835498 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m13:37:07.836520 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m13:37:07.837549 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m13:37:07.843853 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m13:37:07.844994 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m13:37:07.846229 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m13:37:07.848113 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:37:07.849224 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:37:07.855499 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:37:07.862035 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m13:37:07.880994 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m13:37:07.883494 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m13:37:07.887939 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m13:37:07.953041 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:37:07.953738 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m13:37:07.954632 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m13:37:07.955884 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m13:37:07.956595 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m13:37:07.957214 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m13:37:07.957835 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m13:37:07.959653 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:37:07.960805 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:37:07.963787 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m13:37:07.964575 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m13:37:07.965391 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m13:37:07.968087 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m13:37:07.969087 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:37:07.979794 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m13:37:07.984689 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m13:37:07.985757 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m13:37:07.986851 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m13:37:07.999245 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m13:37:07.997007 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m13:37:08.000725 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m13:37:08.002443 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m13:37:08.003306 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m13:37:08.004308 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:37:08.005301 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:37:08.006024 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m13:37:08.010829 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m13:37:08.011903 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m13:37:08.016152 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m13:37:08.020097 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m13:37:08.022114 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m13:37:08.024100 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m13:37:08.026886 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m13:37:08.030400 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m13:37:08.031484 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c59f01-4fb0-4fca-a1d6-78d23cbd5b62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afee3449e40>]}
[0m13:37:08.032506 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m13:37:08.033690 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c59f01-4fb0-4fca-a1d6-78d23cbd5b62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afee0987100>]}
[0m13:37:08.035367 [info ] [Thread-3 (]: 3 of 4 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.47s]
[0m13:37:08.036213 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:37:08.037713 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.48s]
[0m13:37:08.038488 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:37:08.039723 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m13:37:08.041801 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m13:37:08.043349 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m13:37:08.045836 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m13:37:08.047309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c59f01-4fb0-4fca-a1d6-78d23cbd5b62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afee098dde0>]}
[0m13:37:08.048563 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.49s]
[0m13:37:08.049793 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c59f01-4fb0-4fca-a1d6-78d23cbd5b62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afee0d96920>]}
[0m13:37:08.050732 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m13:37:08.051783 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.49s]
[0m13:37:08.052941 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m13:37:08.054637 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:08.055245 [debug] [MainThread]: On master: BEGIN
[0m13:37:08.055774 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:37:08.064620 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:37:08.065461 [debug] [MainThread]: On master: COMMIT
[0m13:37:08.066028 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:08.066514 [debug] [MainThread]: On master: COMMIT
[0m13:37:08.067346 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:37:08.067916 [debug] [MainThread]: On master: Close
[0m13:37:08.068769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:08.069351 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m13:37:08.069838 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m13:37:08.070335 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m13:37:08.070788 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m13:37:08.071415 [info ] [MainThread]: 
[0m13:37:08.072029 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m13:37:08.073621 [debug] [MainThread]: Command end result
[0m13:37:08.102002 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m13:37:08.104137 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m13:37:08.113937 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m13:37:08.114554 [info ] [MainThread]: 
[0m13:37:08.115199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:37:08.115815 [info ] [MainThread]: 
[0m13:37:08.116443 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:37:08.117708 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5995817, "process_in_blocks": "0", "process_kernel_time": 0.232691, "process_mem_max_rss": "112176", "process_out_blocks": "1840", "process_user_time": 3.503349}
[0m13:37:08.118422 [debug] [MainThread]: Command `dbt run` succeeded at 13:37:08.118300 after 1.60 seconds
[0m13:37:08.118963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afee31790f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afee2893e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afee144fb50>]}
[0m13:37:08.119530 [debug] [MainThread]: Flushing usage events
[0m13:37:10.103277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:18.030277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9f9ed5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9fad6a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9fad6a500>]}


============================== 20:58:18.035618 | 3d09b994-9697-4682-ac99-34c64da49d20 ==============================
[0m20:58:18.035618 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:58:18.036774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:58:18.444588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d09b994-9697-4682-ac99-34c64da49d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9fad570d0>]}
[0m20:58:18.622206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d09b994-9697-4682-ac99-34c64da49d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9f96bbbe0>]}
[0m20:58:18.624261 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:58:18.827550 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m20:58:19.089179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:58:19.089877 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:58:19.103399 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m20:58:19.159629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d09b994-9697-4682-ac99-34c64da49d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9f8258130>]}
[0m20:58:19.299122 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m20:58:19.304156 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m20:58:19.333793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d09b994-9697-4682-ac99-34c64da49d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9f823a500>]}
[0m20:58:19.334609 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m20:58:19.335386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d09b994-9697-4682-ac99-34c64da49d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9f823a4d0>]}
[0m20:58:19.339462 [info ] [MainThread]: 
[0m20:58:19.340602 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:58:19.341444 [info ] [MainThread]: 
[0m20:58:19.342733 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:58:19.351400 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:58:19.415861 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:58:19.417014 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:58:19.418041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:19.431667 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m20:58:19.435002 [debug] [ThreadPool]: On list_foo: Close
[0m20:58:19.438386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m20:58:19.452248 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m20:58:19.453244 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m20:58:19.454232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:19.466197 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m20:58:19.467245 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m20:58:19.468123 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m20:58:19.485368 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m20:58:19.488275 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m20:58:19.489507 [debug] [ThreadPool]: On list_foo_zap: Close
[0m20:58:19.500684 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:19.501672 [debug] [MainThread]: On master: BEGIN
[0m20:58:19.502730 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:19.514038 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:58:19.515187 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:19.516223 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:58:19.522625 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m20:58:19.525464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d09b994-9697-4682-ac99-34c64da49d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9f8290fa0>]}
[0m20:58:19.526881 [debug] [MainThread]: On master: ROLLBACK
[0m20:58:19.529179 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:19.530297 [debug] [MainThread]: On master: BEGIN
[0m20:58:19.532321 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:58:19.533410 [debug] [MainThread]: On master: COMMIT
[0m20:58:19.534381 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:19.535334 [debug] [MainThread]: On master: COMMIT
[0m20:58:19.536759 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:58:19.537754 [debug] [MainThread]: On master: Close
[0m20:58:19.542171 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m20:58:19.543347 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:58:19.544510 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:58:19.546139 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m20:58:19.548112 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m20:58:19.550079 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m20:58:19.552014 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m20:58:19.553689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m20:58:19.555225 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m20:58:19.556677 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m20:58:19.558109 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m20:58:19.559372 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m20:58:19.560591 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:58:19.562749 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:58:19.564561 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m20:58:19.590210 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:58:19.591617 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:58:19.598941 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:58:19.600162 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m20:58:19.602115 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:58:19.609791 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m20:58:19.611202 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m20:58:19.612601 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:58:19.647516 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m20:58:19.781687 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:58:19.783407 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:58:19.787004 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m20:58:19.789697 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:58:19.791529 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:58:19.793454 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:58:19.794980 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m20:58:19.796550 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:58:19.798162 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:58:19.799635 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m20:58:19.800901 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:58:19.802107 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m20:58:19.803301 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m20:58:19.804352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:19.805732 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:58:19.807594 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:58:19.821365 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m20:58:19.822838 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:58:19.824125 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m20:58:19.825523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m20:58:19.827134 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:58:19.828732 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m20:58:19.830421 [debug] [Thread-3 (]: SQL status: BEGIN in 0.023 seconds
[0m20:58:19.831873 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m20:58:19.833214 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:58:19.834565 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:58:19.835868 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:58:19.836965 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m20:58:19.838022 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select
*,
price_rent/floor_size as price_rent_per_m2
from rank_floorsize 
order by price_rent_per_m2
  );
[0m20:58:19.839163 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m20:58:19.859248 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:58:19.866005 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:58:19.867262 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m20:58:19.868519 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m20:58:19.870178 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m20:58:19.872091 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:58:19.880764 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:58:19.882267 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m20:58:19.883565 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:58:19.890084 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m20:58:19.894248 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:58:20.037143 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m20:58:20.047268 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m20:58:20.046890 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m20:58:20.052351 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m20:58:20.055350 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m20:58:20.056633 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:58:20.057809 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:58:20.058657 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:58:20.059558 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:58:20.061053 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m20:58:20.065957 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m20:58:20.067300 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m20:58:20.068617 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m20:58:20.069988 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:58:20.071642 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m20:58:20.075231 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m20:58:20.076395 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m20:58:20.077867 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m20:58:20.084978 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m20:58:20.096903 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m20:58:20.104221 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m20:58:20.116116 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m20:58:20.131013 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m20:58:20.117610 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m20:58:20.133963 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m20:58:20.128248 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m20:58:20.135406 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m20:58:20.137764 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m20:58:20.139256 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m20:58:20.140144 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m20:58:20.141429 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m20:58:20.142474 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:58:20.149607 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m20:58:20.150819 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m20:58:20.151751 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.008 seconds
[0m20:58:20.152826 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m20:58:20.155318 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m20:58:20.158182 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m20:58:20.162219 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m20:58:20.168379 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d09b994-9697-4682-ac99-34c64da49d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9f7ba7520>]}
[0m20:58:20.169751 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d09b994-9697-4682-ac99-34c64da49d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9f77d0c70>]}
[0m20:58:20.170716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d09b994-9697-4682-ac99-34c64da49d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9f83052a0>]}
[0m20:58:20.171954 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d09b994-9697-4682-ac99-34c64da49d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9f77818a0>]}
[0m20:58:20.173112 [info ] [Thread-3 (]: 3 of 4 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.61s]
[0m20:58:20.174647 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.61s]
[0m20:58:20.176117 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.61s]
[0m20:58:20.177846 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.61s]
[0m20:58:20.179563 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m20:58:20.181059 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m20:58:20.182551 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m20:58:20.183877 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m20:58:20.186395 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:20.187042 [debug] [MainThread]: On master: BEGIN
[0m20:58:20.187544 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:58:20.196739 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:58:20.197504 [debug] [MainThread]: On master: COMMIT
[0m20:58:20.198039 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:20.198512 [debug] [MainThread]: On master: COMMIT
[0m20:58:20.199289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:58:20.199829 [debug] [MainThread]: On master: Close
[0m20:58:20.200634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:20.201212 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m20:58:20.201692 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m20:58:20.202176 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m20:58:20.202613 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m20:58:20.203269 [info ] [MainThread]: 
[0m20:58:20.203854 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m20:58:20.205636 [debug] [MainThread]: Command end result
[0m20:58:20.243028 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m20:58:20.247060 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m20:58:20.257296 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m20:58:20.257982 [info ] [MainThread]: 
[0m20:58:20.258690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:58:20.259362 [info ] [MainThread]: 
[0m20:58:20.260015 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m20:58:20.262027 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.318154, "process_in_blocks": "35464", "process_kernel_time": 0.300654, "process_mem_max_rss": "112000", "process_out_blocks": "1848", "process_user_time": 3.992691}
[0m20:58:20.263206 [debug] [MainThread]: Command `dbt run` succeeded at 20:58:20.262901 after 2.32 seconds
[0m20:58:20.264008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9f9ed5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9f9d8bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a9f7678dc0>]}
[0m20:58:20.264658 [debug] [MainThread]: Flushing usage events
[0m20:58:21.152360 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:23:33.598856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7912379950c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79123886a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79123886a530>]}


============================== 21:23:33.602437 | fd98de21-3c19-4fb1-9c3a-3b58122c94ff ==============================
[0m21:23:33.602437 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:23:33.603269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:23:33.829131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd98de21-3c19-4fb1-9c3a-3b58122c94ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79123880f2e0>]}
[0m21:23:33.918308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd98de21-3c19-4fb1-9c3a-3b58122c94ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7912369e0100>]}
[0m21:23:33.919410 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:23:34.054893 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:23:34.221322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:23:34.221979 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:23:34.231747 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m21:23:34.279557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd98de21-3c19-4fb1-9c3a-3b58122c94ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791235c54130>]}
[0m21:23:34.395981 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m21:23:34.400798 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m21:23:34.414875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd98de21-3c19-4fb1-9c3a-3b58122c94ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791235c36380>]}
[0m21:23:34.415769 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m21:23:34.416522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd98de21-3c19-4fb1-9c3a-3b58122c94ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791235c361d0>]}
[0m21:23:34.418806 [info ] [MainThread]: 
[0m21:23:34.419441 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:23:34.419963 [info ] [MainThread]: 
[0m21:23:34.420715 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:23:34.427158 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m21:23:34.476613 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m21:23:34.477268 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m21:23:34.477755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:34.488471 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m21:23:34.490264 [debug] [ThreadPool]: On list_foo: Close
[0m21:23:34.492950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m21:23:34.502314 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m21:23:34.502955 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m21:23:34.503430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:34.513749 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m21:23:34.514861 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m21:23:34.515537 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m21:23:34.518989 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m21:23:34.521418 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m21:23:34.522308 [debug] [ThreadPool]: On list_foo_zap: Close
[0m21:23:34.530542 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:34.531333 [debug] [MainThread]: On master: BEGIN
[0m21:23:34.532159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:23:34.541280 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m21:23:34.541935 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:34.542509 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:23:34.546811 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m21:23:34.549330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd98de21-3c19-4fb1-9c3a-3b58122c94ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791235c8d120>]}
[0m21:23:34.550158 [debug] [MainThread]: On master: ROLLBACK
[0m21:23:34.550994 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:34.551576 [debug] [MainThread]: On master: BEGIN
[0m21:23:34.552465 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:23:34.553029 [debug] [MainThread]: On master: COMMIT
[0m21:23:34.553521 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:34.554007 [debug] [MainThread]: On master: COMMIT
[0m21:23:34.554662 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:23:34.555187 [debug] [MainThread]: On master: Close
[0m21:23:34.558216 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m21:23:34.558974 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m21:23:34.559812 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m21:23:34.560590 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m21:23:34.561415 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m21:23:34.562197 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m21:23:34.563325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m21:23:34.564577 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m21:23:34.566012 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m21:23:34.567197 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m21:23:34.567946 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m21:23:34.568815 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m21:23:34.569481 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m21:23:34.570277 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m21:23:34.581377 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m21:23:34.584085 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m21:23:34.588842 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m21:23:34.589905 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m21:23:34.594559 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m21:23:34.600720 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m21:23:34.601857 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m21:23:34.602994 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m21:23:34.603771 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m21:23:34.657817 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m21:23:34.743519 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m21:23:34.752183 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m21:23:34.749724 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m21:23:34.741295 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m21:23:34.754666 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m21:23:34.755365 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m21:23:34.756265 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m21:23:34.756942 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m21:23:34.757657 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m21:23:34.758286 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m21:23:34.759032 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:23:34.760343 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m21:23:34.761235 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m21:23:34.762129 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:23:34.763793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:34.764821 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:23:34.771686 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m21:23:34.772576 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m21:23:34.773949 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select
*,
price_rent/floor_size as price_rent_per_m2
from rank_floorsize 
order by price_rent_per_m2
  );
[0m21:23:34.774956 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m21:23:34.775837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m21:23:34.776846 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m21:23:34.778045 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m21:23:34.778801 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m21:23:34.779842 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:23:34.780824 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m21:23:34.781951 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m21:23:34.783239 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m21:23:34.793417 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m21:23:34.794629 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m21:23:34.796599 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m21:23:34.797726 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:23:34.805024 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m21:23:34.806098 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m21:23:34.806694 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m21:23:34.811103 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m21:23:34.812037 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m21:23:34.813741 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m21:23:34.825743 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m21:23:34.839104 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m21:23:34.846785 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m21:23:34.848083 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m21:23:34.849115 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:23:34.849844 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:23:34.850481 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m21:23:34.851264 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m21:23:34.854444 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m21:23:34.856759 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m21:23:34.857948 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m21:23:34.859248 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:23:34.860084 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m21:23:34.860677 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m21:23:34.920344 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m21:23:34.923387 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m21:23:34.924354 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m21:23:34.936315 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m21:23:34.937105 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m21:23:34.943538 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m21:23:34.944586 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m21:23:34.948123 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m21:23:34.948874 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m21:23:34.952769 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m21:23:34.957480 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m21:23:34.958487 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m21:23:34.960979 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m21:23:34.963070 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m21:23:34.964088 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m21:23:34.964933 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m21:23:34.966018 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:23:34.966813 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m21:23:34.971038 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m21:23:34.975590 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m21:23:34.976515 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m21:23:34.979052 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m21:23:34.980411 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:23:34.983315 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m21:23:34.986292 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m21:23:34.989238 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m21:23:34.989859 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd98de21-3c19-4fb1-9c3a-3b58122c94ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7912355a2cb0>]}
[0m21:23:34.991406 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd98de21-3c19-4fb1-9c3a-3b58122c94ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79123785f640>]}
[0m21:23:34.992398 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:23:34.993614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd98de21-3c19-4fb1-9c3a-3b58122c94ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791235c575e0>]}
[0m21:23:34.994748 [info ] [Thread-3 (]: 3 of 4 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.42s]
[0m21:23:34.996308 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.42s]
[0m21:23:34.998997 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m21:23:35.000106 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.43s]
[0m21:23:35.001270 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m21:23:35.002347 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m21:23:35.003290 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m21:23:35.004302 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd98de21-3c19-4fb1-9c3a-3b58122c94ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791235c57790>]}
[0m21:23:35.005898 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.44s]
[0m21:23:35.006979 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m21:23:35.008641 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:35.009292 [debug] [MainThread]: On master: BEGIN
[0m21:23:35.009787 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:23:35.019560 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m21:23:35.020216 [debug] [MainThread]: On master: COMMIT
[0m21:23:35.020720 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:35.021219 [debug] [MainThread]: On master: COMMIT
[0m21:23:35.021945 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:23:35.022504 [debug] [MainThread]: On master: Close
[0m21:23:35.023277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:35.023823 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m21:23:35.024335 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m21:23:35.024796 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m21:23:35.025267 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m21:23:35.025867 [info ] [MainThread]: 
[0m21:23:35.026467 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m21:23:35.028160 [debug] [MainThread]: Command end result
[0m21:23:35.056245 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m21:23:35.058497 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m21:23:35.068359 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m21:23:35.068981 [info ] [MainThread]: 
[0m21:23:35.069576 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:23:35.070132 [info ] [MainThread]: 
[0m21:23:35.070700 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:23:35.071981 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5514128, "process_in_blocks": "0", "process_kernel_time": 0.202423, "process_mem_max_rss": "112088", "process_out_blocks": "1848", "process_user_time": 3.02233}
[0m21:23:35.072697 [debug] [MainThread]: Command `dbt run` succeeded at 21:23:35.072588 after 1.55 seconds
[0m21:23:35.073267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7912379950c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791237fa77f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791237810880>]}
[0m21:23:35.073833 [debug] [MainThread]: Flushing usage events
[0m21:23:36.345381 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:56:05.159403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf6922d50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf69316a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf69316a530>]}


============================== 22:56:05.165547 | ca9de98e-03a1-4516-8077-2a5608cc10ed ==============================
[0m22:56:05.165547 [info ] [MainThread]: Running with dbt=1.9.2
[0m22:56:05.166454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:56:05.393490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca9de98e-03a1-4516-8077-2a5608cc10ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf691602da0>]}
[0m22:56:05.474475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca9de98e-03a1-4516-8077-2a5608cc10ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf6919ebe20>]}
[0m22:56:05.476761 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:56:05.618694 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m22:56:05.810589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:56:05.811313 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:56:05.820166 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m22:56:05.866876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca9de98e-03a1-4516-8077-2a5608cc10ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf69078a9e0>]}
[0m22:56:05.980287 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m22:56:05.984377 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m22:56:06.009893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca9de98e-03a1-4516-8077-2a5608cc10ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf69063a200>]}
[0m22:56:06.010697 [info ] [MainThread]: Found 4 models, 1 source, 431 macros
[0m22:56:06.011683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca9de98e-03a1-4516-8077-2a5608cc10ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf69063a170>]}
[0m22:56:06.015376 [info ] [MainThread]: 
[0m22:56:06.016107 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:56:06.016677 [info ] [MainThread]: 
[0m22:56:06.017488 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:56:06.023991 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m22:56:06.083764 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m22:56:06.084395 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m22:56:06.084877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:56:06.095919 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m22:56:06.098186 [debug] [ThreadPool]: On list_foo: Close
[0m22:56:06.100622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m22:56:06.109201 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m22:56:06.109827 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m22:56:06.110286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:56:06.119487 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m22:56:06.120126 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m22:56:06.120644 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m22:56:06.137574 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m22:56:06.139324 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m22:56:06.140101 [debug] [ThreadPool]: On list_foo_zap: Close
[0m22:56:06.148476 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:06.149146 [debug] [MainThread]: On master: BEGIN
[0m22:56:06.149630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:56:06.159000 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m22:56:06.159641 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:06.160195 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:56:06.166208 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m22:56:06.168389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca9de98e-03a1-4516-8077-2a5608cc10ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf690690c10>]}
[0m22:56:06.169105 [debug] [MainThread]: On master: ROLLBACK
[0m22:56:06.169961 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:06.170484 [debug] [MainThread]: On master: BEGIN
[0m22:56:06.171403 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:56:06.171967 [debug] [MainThread]: On master: COMMIT
[0m22:56:06.172455 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:06.172936 [debug] [MainThread]: On master: COMMIT
[0m22:56:06.173678 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:56:06.174224 [debug] [MainThread]: On master: Close
[0m22:56:06.177262 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_apartment_avg_prices
[0m22:56:06.178252 [debug] [Thread-2 (]: Began running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m22:56:06.179492 [debug] [Thread-3 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m22:56:06.180758 [info ] [Thread-1 (]: 1 of 4 START sql view model zap.gold_apartment_avg_prices ...................... [RUN]
[0m22:56:06.181796 [debug] [Thread-4 (]: Began running node model.zap_imoveis.gold_house_avg_prices
[0m22:56:06.182643 [info ] [Thread-2 (]: 2 of 4 START sql view model zap.gold_flat_kit_studio_avg_prices ................ [RUN]
[0m22:56:06.183964 [info ] [Thread-3 (]: 3 of 4 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m22:56:06.184874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_apartment_avg_prices)
[0m22:56:06.185737 [info ] [Thread-4 (]: 4 of 4 START sql view model zap.gold_house_avg_prices .......................... [RUN]
[0m22:56:06.186695 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices'
[0m22:56:06.187547 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices'
[0m22:56:06.188200 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_apartment_avg_prices
[0m22:56:06.189197 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.zap_imoveis.gold_house_avg_prices'
[0m22:56:06.189844 [debug] [Thread-2 (]: Began compiling node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m22:56:06.190701 [debug] [Thread-3 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m22:56:06.202131 [debug] [Thread-4 (]: Began compiling node model.zap_imoveis.gold_house_avg_prices
[0m22:56:06.204529 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m22:56:06.210397 [debug] [Thread-2 (]: Writing injected SQL for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m22:56:06.216312 [debug] [Thread-3 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m22:56:06.220448 [debug] [Thread-4 (]: Writing injected SQL for node "model.zap_imoveis.gold_house_avg_prices"
[0m22:56:06.222250 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_apartment_avg_prices
[0m22:56:06.223690 [debug] [Thread-2 (]: Began executing node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m22:56:06.230314 [debug] [Thread-3 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m22:56:06.257417 [debug] [Thread-4 (]: Began executing node model.zap_imoveis.gold_house_avg_prices
[0m22:56:06.401838 [debug] [Thread-2 (]: Writing runtime sql for node "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m22:56:06.402988 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m22:56:06.403624 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: BEGIN
[0m22:56:06.404184 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:56:06.406099 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_apartment_avg_prices"
[0m22:56:06.407113 [debug] [Thread-3 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m22:56:06.409913 [debug] [Thread-4 (]: Writing runtime sql for node "model.zap_imoveis.gold_house_avg_prices"
[0m22:56:06.412690 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m22:56:06.413983 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: BEGIN
[0m22:56:06.415155 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m22:56:06.416053 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m22:56:06.416670 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:56:06.417287 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m22:56:06.417919 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m22:56:06.418534 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m22:56:06.419895 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: BEGIN
[0m22:56:06.420637 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */

  create view "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE 
	kind LIKE 'Flats%' OR 
	KIND LIKE 'Studios%' OR 
	KIND LIKE 'Kitnets'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m22:56:06.422084 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:56:06.423128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:56:06.429179 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m22:56:06.430488 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:56:06.431740 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m22:56:06.441545 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m22:56:06.442609 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m22:56:06.443764 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */

  create view "foo"."zap"."gold_house_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind LIKE 'casas%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc
  );
[0m22:56:06.444424 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m22:56:06.445549 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
alter table "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_tmp" rename to "gold_flat_kit_studio_avg_prices"
[0m22:56:06.446859 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m22:56:06.448231 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m22:56:06.449401 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select
*,
price_rent/floor_size as price_rent_per_m2
from rank_floorsize 
order by price_rent_per_m2
  );
[0m22:56:06.450367 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:56:06.451098 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */

  create view "foo"."zap"."gold_apartment_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
    WHERE kind like 'apartamentos%'
),
final as (
	select 
	neighborhood,
	count(id) as sample_size,
	ROUND(avg(floor_size),2 ) as floor_size_avg,
	ROUND(avg(price_rent), 2) as price_rent_avg,
	ROUND(avg(price_condominium), 2) as price_condominium_avg,
	ROUND(avg(rent_plus_condo), 2) as rent_plus_condo_avg,
	ROUND(avg(price_rent) / avg(floor_size) , 2) as price_rent_per_m2_avg,
	ROUND(avg(rent_plus_condo) / avg(floor_size), 2) as rent_plus_condo__per_m2_avg,
	ROUND(avg(price_sale), 2) as price_sale_avg,
	ROUND(avg(price_sale) / avg(floor_size), 2) as price_sale_per_m2_avg
	from source 
	group by neighborhood 
)
select * from final 
order by price_rent_per_m2_avg desc


-- as avg ignores null values, we are getting the correct measures;
  );
[0m22:56:06.451869 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:56:06.458502 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:56:06.476626 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m22:56:06.477654 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m22:56:06.484786 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m22:56:06.489680 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m22:56:06.490694 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m22:56:06.499224 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m22:56:06.499960 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
alter table "foo"."zap"."gold_house_avg_prices__dbt_tmp" rename to "gold_house_avg_prices"
[0m22:56:06.500646 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m22:56:06.501290 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: COMMIT
[0m22:56:06.501917 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
alter table "foo"."zap"."gold_apartment_avg_prices__dbt_tmp" rename to "gold_apartment_avg_prices"
[0m22:56:06.503958 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:56:06.505100 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:56:06.562852 [debug] [Thread-2 (]: SQL status: COMMIT in 0.060 seconds
[0m22:56:06.565286 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m22:56:06.568290 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m22:56:06.569167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.066 seconds
[0m22:56:06.580805 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m22:56:06.580358 [debug] [Thread-2 (]: Applying DROP to: "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup"
[0m22:56:06.582096 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m22:56:06.584494 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m22:56:06.585235 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: COMMIT
[0m22:56:06.592853 [debug] [Thread-2 (]: Using postgres connection "model.zap_imoveis.gold_flat_kit_studio_avg_prices"
[0m22:56:06.593784 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m22:56:06.594650 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m22:56:06.596204 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_flat_kit_studio_avg_prices"} */
drop view if exists "foo"."zap"."gold_flat_kit_studio_avg_prices__dbt_backup" cascade
[0m22:56:06.597221 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: COMMIT
[0m22:56:06.598500 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:56:06.599224 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:56:06.602765 [debug] [Thread-2 (]: On model.zap_imoveis.gold_flat_kit_studio_avg_prices: Close
[0m22:56:06.603639 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m22:56:06.604650 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m22:56:06.609360 [debug] [Thread-4 (]: Applying DROP to: "foo"."zap"."gold_house_avg_prices__dbt_backup"
[0m22:56:06.614415 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_apartment_avg_prices__dbt_backup"
[0m22:56:06.620686 [debug] [Thread-3 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m22:56:06.623643 [debug] [Thread-4 (]: Using postgres connection "model.zap_imoveis.gold_house_avg_prices"
[0m22:56:06.625669 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_apartment_avg_prices"
[0m22:56:06.626385 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9de98e-03a1-4516-8077-2a5608cc10ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf68ffa7010>]}
[0m22:56:06.627950 [debug] [Thread-3 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m22:56:06.629544 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_house_avg_prices"} */
drop view if exists "foo"."zap"."gold_house_avg_prices__dbt_backup" cascade
[0m22:56:06.630650 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_apartment_avg_prices"} */
drop view if exists "foo"."zap"."gold_apartment_avg_prices__dbt_backup" cascade
[0m22:56:06.631950 [info ] [Thread-2 (]: 2 of 4 OK created sql view model zap.gold_flat_kit_studio_avg_prices ........... [[32mCREATE VIEW[0m in 0.43s]
[0m22:56:06.632959 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m22:56:06.634227 [debug] [Thread-2 (]: Finished running node model.zap_imoveis.gold_flat_kit_studio_avg_prices
[0m22:56:06.634955 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:56:06.635561 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:56:06.637698 [debug] [Thread-4 (]: On model.zap_imoveis.gold_house_avg_prices: Close
[0m22:56:06.638729 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:56:06.641014 [debug] [Thread-1 (]: On model.zap_imoveis.gold_apartment_avg_prices: Close
[0m22:56:06.643872 [debug] [Thread-3 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m22:56:06.645403 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9de98e-03a1-4516-8077-2a5608cc10ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf68ff3e140>]}
[0m22:56:06.647445 [info ] [Thread-4 (]: 4 of 4 OK created sql view model zap.gold_house_avg_prices ..................... [[32mCREATE VIEW[0m in 0.46s]
[0m22:56:06.648949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9de98e-03a1-4516-8077-2a5608cc10ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf68fb97160>]}
[0m22:56:06.650085 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9de98e-03a1-4516-8077-2a5608cc10ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf68fbe20b0>]}
[0m22:56:06.651197 [debug] [Thread-4 (]: Finished running node model.zap_imoveis.gold_house_avg_prices
[0m22:56:06.652161 [info ] [Thread-1 (]: 1 of 4 OK created sql view model zap.gold_apartment_avg_prices ................. [[32mCREATE VIEW[0m in 0.46s]
[0m22:56:06.653371 [info ] [Thread-3 (]: 3 of 4 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.46s]
[0m22:56:06.654629 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_apartment_avg_prices
[0m22:56:06.655534 [debug] [Thread-3 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m22:56:06.657459 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:06.658081 [debug] [MainThread]: On master: BEGIN
[0m22:56:06.658574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:56:06.667756 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m22:56:06.668387 [debug] [MainThread]: On master: COMMIT
[0m22:56:06.668900 [debug] [MainThread]: Using postgres connection "master"
[0m22:56:06.669374 [debug] [MainThread]: On master: COMMIT
[0m22:56:06.670170 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:56:06.670738 [debug] [MainThread]: On master: Close
[0m22:56:06.671535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:56:06.672097 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_apartment_avg_prices' was properly closed.
[0m22:56:06.672617 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_flat_kit_studio_avg_prices' was properly closed.
[0m22:56:06.673088 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m22:56:06.673548 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_house_avg_prices' was properly closed.
[0m22:56:06.674216 [info ] [MainThread]: 
[0m22:56:06.674771 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m22:56:06.676293 [debug] [MainThread]: Command end result
[0m22:56:06.705035 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m22:56:06.707171 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m22:56:06.716644 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m22:56:06.717248 [info ] [MainThread]: 
[0m22:56:06.717868 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:56:06.718395 [info ] [MainThread]: 
[0m22:56:06.718990 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m22:56:06.720248 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6407112, "process_in_blocks": "35320", "process_kernel_time": 0.259429, "process_mem_max_rss": "112240", "process_out_blocks": "1840", "process_user_time": 3.1993}
[0m22:56:06.720978 [debug] [MainThread]: Command `dbt run` succeeded at 22:56:06.720859 after 1.64 seconds
[0m22:56:06.721545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf6922d50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf690789b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf69065f910>]}
[0m22:56:06.722115 [debug] [MainThread]: Flushing usage events
[0m22:56:07.809596 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:51:52.248602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75338e460e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75338f336320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75338f3362c0>]}


============================== 08:51:52.253764 | 78950394-e9a2-4a30-a574-67a26ac2dacc ==============================
[0m08:51:52.253764 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:51:52.254829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:51:52.496272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78950394-e9a2-4a30-a574-67a26ac2dacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75338f487880>]}
[0m08:51:52.572935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78950394-e9a2-4a30-a574-67a26ac2dacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75338f31e1a0>]}
[0m08:51:52.575301 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:51:52.719535 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:51:52.899881 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 1 files changed.
[0m08:51:52.900816 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/schema.yml
[0m08:51:52.901283 [debug] [MainThread]: Partial parsing: deleted file: zap_imoveis://models/mart/gold_flat_kit_studio_avg_prices.sql
[0m08:51:52.901736 [debug] [MainThread]: Partial parsing: deleted file: zap_imoveis://models/mart/gold_house_avg_prices.sql
[0m08:51:52.902160 [debug] [MainThread]: Partial parsing: deleted file: zap_imoveis://models/mart/gold_apartment_avg_prices.sql
[0m08:51:53.303152 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m08:51:53.325425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78950394-e9a2-4a30-a574-67a26ac2dacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75338c55e320>]}
[0m08:51:53.465431 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:51:53.469591 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:51:53.495248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78950394-e9a2-4a30-a574-67a26ac2dacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75338c55d3c0>]}
[0m08:51:53.495992 [info ] [MainThread]: Found 1 model, 6 data tests, 1 source, 431 macros
[0m08:51:53.496497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78950394-e9a2-4a30-a574-67a26ac2dacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75338c55e050>]}
[0m08:51:53.498527 [info ] [MainThread]: 
[0m08:51:53.499159 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:51:53.499659 [info ] [MainThread]: 
[0m08:51:53.500405 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:51:53.501763 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m08:51:53.557243 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m08:51:53.557880 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m08:51:53.558352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:51:53.574113 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m08:51:53.575842 [debug] [ThreadPool]: On list_foo: Close
[0m08:51:53.577784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m08:51:53.640285 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:51:53.640892 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m08:51:53.641326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:51:53.649624 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m08:51:53.650239 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:51:53.650714 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m08:51:53.659646 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m08:51:53.661568 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m08:51:53.662367 [debug] [ThreadPool]: On list_foo_zap: Close
[0m08:51:53.669680 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:53.670277 [debug] [MainThread]: On master: BEGIN
[0m08:51:53.670718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:51:53.679509 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:51:53.680894 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:53.683064 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:51:53.689828 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m08:51:53.693134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78950394-e9a2-4a30-a574-67a26ac2dacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75338c57f520>]}
[0m08:51:53.693796 [debug] [MainThread]: On master: ROLLBACK
[0m08:51:53.694574 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:53.695112 [debug] [MainThread]: On master: BEGIN
[0m08:51:53.695898 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:51:53.696424 [debug] [MainThread]: On master: COMMIT
[0m08:51:53.696896 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:53.697329 [debug] [MainThread]: On master: COMMIT
[0m08:51:53.698036 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:51:53.698558 [debug] [MainThread]: On master: Close
[0m08:51:53.701730 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m08:51:53.703328 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m08:51:53.704551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_floorsize_ranked_avg_prices)
[0m08:51:53.705173 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m08:51:53.716481 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m08:51:53.717688 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m08:51:53.772349 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m08:51:53.773348 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m08:51:53.773940 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m08:51:53.774454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:51:53.782928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m08:51:53.783997 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m08:51:53.784675 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size > 20 and sz.floor_size <= 50
		then 'C'
		when sz.floor_size > 50 and sz.floor_size <= 80
		then 'B'
		when sz.floor_size > 80 and sz.floor_size <= 110
		then 'A'
        WHEN sz.floor_size > 110
        THEN 'S'
	end as floor_size_rank
	from source sz 
)
select
*,
price_rent/floor_size as price_rent_per_m2
from rank_floorsize 
order by price_rent_per_m2
  );
[0m08:51:53.805214 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m08:51:53.814741 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m08:51:53.815404 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices" rename to "gold_floorsize_ranked_avg_prices__dbt_backup"
[0m08:51:53.816861 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:51:53.822237 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m08:51:53.822879 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m08:51:53.824302 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:51:53.847335 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m08:51:53.848024 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m08:51:53.848554 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m08:51:53.850660 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:51:53.860056 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m08:51:53.866313 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m08:51:53.866975 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m08:51:53.871731 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m08:51:53.876233 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m08:51:53.879090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78950394-e9a2-4a30-a574-67a26ac2dacc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75338c760040>]}
[0m08:51:53.880159 [info ] [Thread-1 (]: 1 of 1 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.17s]
[0m08:51:53.881190 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m08:51:53.882976 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:53.883543 [debug] [MainThread]: On master: BEGIN
[0m08:51:53.884005 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:51:53.893527 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:51:53.894233 [debug] [MainThread]: On master: COMMIT
[0m08:51:53.894966 [debug] [MainThread]: Using postgres connection "master"
[0m08:51:53.895931 [debug] [MainThread]: On master: COMMIT
[0m08:51:53.897119 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:51:53.897873 [debug] [MainThread]: On master: Close
[0m08:51:53.898628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:51:53.899179 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m08:51:53.899687 [info ] [MainThread]: 
[0m08:51:53.900272 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m08:51:53.901353 [debug] [MainThread]: Command end result
[0m08:51:53.936114 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:51:53.938494 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:51:53.947384 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m08:51:53.948116 [info ] [MainThread]: 
[0m08:51:53.948723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:51:53.949218 [info ] [MainThread]: 
[0m08:51:53.949718 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:51:53.951042 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7791646, "process_in_blocks": "53408", "process_kernel_time": 0.268498, "process_mem_max_rss": "113472", "process_out_blocks": "2640", "process_user_time": 3.013599}
[0m08:51:53.951789 [debug] [MainThread]: Command `dbt run` succeeded at 08:51:53.951650 after 1.78 seconds
[0m08:51:53.952351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75338c57eec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75338c57f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75338c57db40>]}
[0m08:51:53.952934 [debug] [MainThread]: Flushing usage events
[0m08:51:54.874520 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:52:22.863849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741fbf994f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741fc083e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741fc083e500>]}


============================== 08:52:22.867203 | f50ed35c-0e7c-4673-979b-b5e22d2913ec ==============================
[0m08:52:22.867203 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:52:22.868047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m08:52:23.088121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f50ed35c-0e7c-4673-979b-b5e22d2913ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741fc0813a60>]}
[0m08:52:23.164469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f50ed35c-0e7c-4673-979b-b5e22d2913ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741fbf176dd0>]}
[0m08:52:23.165618 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:52:23.306097 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:52:23.491139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:23.491722 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:23.499902 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m08:52:23.569519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f50ed35c-0e7c-4673-979b-b5e22d2913ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741fbdc817b0>]}
[0m08:52:23.705036 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:52:23.712323 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:52:23.747200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f50ed35c-0e7c-4673-979b-b5e22d2913ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741fbddfbb50>]}
[0m08:52:23.747954 [info ] [MainThread]: Found 1 model, 6 data tests, 1 source, 431 macros
[0m08:52:23.748468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f50ed35c-0e7c-4673-979b-b5e22d2913ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741fbddfba00>]}
[0m08:52:23.750886 [info ] [MainThread]: 
[0m08:52:23.751486 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:23.752029 [info ] [MainThread]: 
[0m08:52:23.752809 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:52:23.754345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo_zap'
[0m08:52:23.805203 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:52:23.806014 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m08:52:23.806497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:23.816615 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m08:52:23.817217 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m08:52:23.817710 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m08:52:23.821116 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m08:52:23.823834 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m08:52:23.824635 [debug] [ThreadPool]: On list_foo_zap: Close
[0m08:52:23.832512 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:23.833120 [debug] [MainThread]: On master: BEGIN
[0m08:52:23.833548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:23.842678 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:52:23.843277 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:23.843892 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:23.848757 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m08:52:23.851906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f50ed35c-0e7c-4673-979b-b5e22d2913ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741fbddfb970>]}
[0m08:52:23.852530 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:23.853312 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:23.853833 [debug] [MainThread]: On master: BEGIN
[0m08:52:23.854587 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:52:23.855121 [debug] [MainThread]: On master: COMMIT
[0m08:52:23.855572 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:23.856021 [debug] [MainThread]: On master: COMMIT
[0m08:52:23.856712 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:23.857298 [debug] [MainThread]: On master: Close
[0m08:52:23.860293 [debug] [Thread-1 (]: Began running node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b
[0m08:52:23.861124 [debug] [Thread-2 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m08:52:23.861813 [debug] [Thread-3 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m08:52:23.862919 [debug] [Thread-4 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m08:52:23.862424 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C  [RUN]
[0m08:52:23.864252 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_floorsize_ranked_avg_prices_floor_size ......... [RUN]
[0m08:52:23.865206 [info ] [Thread-3 (]: 3 of 6 START test not_null_gold_floorsize_ranked_avg_prices_id ................. [RUN]
[0m08:52:23.866628 [info ] [Thread-4 (]: 4 of 6 START test not_null_gold_floorsize_ranked_avg_prices_kind ............... [RUN]
[0m08:52:23.867644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b)
[0m08:52:23.869095 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373'
[0m08:52:23.870214 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3'
[0m08:52:23.871273 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657'
[0m08:52:23.872083 [debug] [Thread-1 (]: Began compiling node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b
[0m08:52:23.872810 [debug] [Thread-2 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m08:52:23.873658 [debug] [Thread-3 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m08:52:23.874942 [debug] [Thread-4 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m08:52:23.915259 [debug] [Thread-1 (]: Writing injected SQL for node "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b"
[0m08:52:23.918824 [debug] [Thread-2 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m08:52:23.931257 [debug] [Thread-3 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m08:52:23.933953 [debug] [Thread-4 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m08:52:23.936491 [debug] [Thread-2 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m08:52:23.937151 [debug] [Thread-1 (]: Began executing node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b
[0m08:52:23.960268 [debug] [Thread-3 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m08:52:23.987905 [debug] [Thread-1 (]: Writing runtime sql for node "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b"
[0m08:52:23.991468 [debug] [Thread-2 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m08:52:24.004884 [debug] [Thread-3 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m08:52:24.005801 [debug] [Thread-4 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m08:52:24.010003 [debug] [Thread-4 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m08:52:24.011366 [debug] [Thread-1 (]: Using postgres connection "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b"
[0m08:52:24.012067 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m08:52:24.012665 [debug] [Thread-4 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m08:52:24.013301 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b: BEGIN
[0m08:52:24.014128 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m08:52:24.015229 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: BEGIN
[0m08:52:24.015831 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: BEGIN
[0m08:52:24.016415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:24.017009 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: BEGIN
[0m08:52:24.017677 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:52:24.018239 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:52:24.019107 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:52:24.026502 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m08:52:24.027316 [debug] [Thread-1 (]: Using postgres connection "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b"
[0m08:52:24.028051 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m08:52:24.028762 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rank_floorsize as value_field,
        count(*) as n_records

    from "foo"."zap"."gold_floorsize_ranked_avg_prices"
    group by rank_floorsize

)

select *
from all_values
where value_field not in (
    'S','A','B','C'
)



      
    ) dbt_internal_test
[0m08:52:24.029563 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m08:52:24.030311 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m08:52:24.031183 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m08:52:24.032033 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "rank_floorsize" does not exist
LINE 14:         rank_floorsize as value_field,
                 ^

[0m08:52:24.032629 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select floor_size
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where floor_size is null



      
    ) dbt_internal_test
[0m08:52:24.033241 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m08:52:24.034172 [debug] [Thread-4 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m08:52:24.035265 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b: ROLLBACK
[0m08:52:24.035993 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where id is null



      
    ) dbt_internal_test
[0m08:52:24.036829 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select kind
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where kind is null



      
    ) dbt_internal_test
[0m08:52:24.038484 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b: Close
[0m08:52:24.041897 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m08:52:24.042732 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m08:52:24.048891 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m08:52:24.049933 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: ROLLBACK
[0m08:52:24.052314 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: ROLLBACK
[0m08:52:24.055310 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: ROLLBACK
[0m08:52:24.056771 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: Close
[0m08:52:24.057514 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: Close
[0m08:52:24.058209 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: Close
[0m08:52:24.059183 [info ] [Thread-3 (]: 3 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_id ....................... [[32mPASS[0m in 0.19s]
[0m08:52:24.061156 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_floor_size ............... [[32mPASS[0m in 0.19s]
[0m08:52:24.063597 [debug] [Thread-3 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m08:52:24.062572 [info ] [Thread-4 (]: 4 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_kind ..................... [[32mPASS[0m in 0.19s]
[0m08:52:24.064920 [debug] [Thread-2 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m08:52:24.065760 [debug] [Thread-3 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81
[0m08:52:24.067100 [debug] [Thread-4 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m08:52:24.068181 [debug] [Thread-2 (]: Began running node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m08:52:24.069384 [debug] [Thread-1 (]: Database Error in test accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 14:         rank_floorsize as value_field,
                   ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/accepted_values_gold_floorsize_02e8a7b329610308119f5635a546c818.sql
[0m08:52:24.070717 [info ] [Thread-3 (]: 5 of 6 START test not_null_gold_floorsize_ranked_avg_prices_rank_floorsize ..... [RUN]
[0m08:52:24.072167 [info ] [Thread-2 (]: 6 of 6 START test unique_gold_floorsize_ranked_avg_prices_id ................... [RUN]
[0m08:52:24.073678 [error] [Thread-1 (]: 1 of 6 ERROR accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C  [[31mERROR[0m in 0.21s]
[0m08:52:24.074899 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3, now test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81)
[0m08:52:24.076014 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373, now test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844)
[0m08:52:24.077142 [debug] [Thread-1 (]: Finished running node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b
[0m08:52:24.077989 [debug] [Thread-3 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81
[0m08:52:24.079013 [debug] [Thread-2 (]: Began compiling node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m08:52:24.080314 [debug] [Thread-7 (]: Marking all children of 'test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 14:         rank_floorsize as value_field,
                   ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/accepted_values_gold_floorsize_02e8a7b329610308119f5635a546c818.sql.
[0m08:52:24.089643 [debug] [Thread-3 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"
[0m08:52:24.101478 [debug] [Thread-2 (]: Writing injected SQL for node "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m08:52:24.102793 [debug] [Thread-3 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81
[0m08:52:24.160017 [debug] [Thread-2 (]: Began executing node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m08:52:24.160844 [debug] [Thread-3 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"
[0m08:52:24.164360 [debug] [Thread-2 (]: Writing runtime sql for node "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m08:52:24.165410 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"
[0m08:52:24.166031 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81: BEGIN
[0m08:52:24.166615 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m08:52:24.167151 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:52:24.167718 [debug] [Thread-2 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: BEGIN
[0m08:52:24.168575 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:52:24.176748 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m08:52:24.177484 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"
[0m08:52:24.178151 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m08:52:24.178726 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rank_floorsize
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where rank_floorsize is null



      
    ) dbt_internal_test
[0m08:52:24.179320 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m08:52:24.180032 [debug] [Thread-2 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:52:24.181104 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "rank_floorsize" does not exist
LINE 13: select rank_floorsize
                ^

[0m08:52:24.181983 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81: ROLLBACK
[0m08:52:24.183041 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81: Close
[0m08:52:24.184508 [debug] [Thread-3 (]: Database Error in test not_null_gold_floorsize_ranked_avg_prices_rank_floorsize (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 13: select rank_floorsize
                  ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.sql
[0m08:52:24.185411 [error] [Thread-3 (]: 5 of 6 ERROR not_null_gold_floorsize_ranked_avg_prices_rank_floorsize .......... [[31mERROR[0m in 0.11s]
[0m08:52:24.186384 [debug] [Thread-3 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81
[0m08:52:24.187240 [debug] [Thread-7 (]: Marking all children of 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81' to be skipped because of status 'error'.  Reason: Database Error in test not_null_gold_floorsize_ranked_avg_prices_rank_floorsize (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 13: select rank_floorsize
                  ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.sql.
[0m08:52:24.214359 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.034 seconds
[0m08:52:24.216933 [debug] [Thread-2 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: ROLLBACK
[0m08:52:24.217965 [debug] [Thread-2 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: Close
[0m08:52:24.219075 [info ] [Thread-2 (]: 6 of 6 PASS unique_gold_floorsize_ranked_avg_prices_id ......................... [[32mPASS[0m in 0.14s]
[0m08:52:24.220073 [debug] [Thread-2 (]: Finished running node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m08:52:24.221763 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:24.222353 [debug] [MainThread]: On master: BEGIN
[0m08:52:24.222799 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:24.231812 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:52:24.232681 [debug] [MainThread]: On master: COMMIT
[0m08:52:24.233468 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:24.234327 [debug] [MainThread]: On master: COMMIT
[0m08:52:24.235633 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:52:24.236836 [debug] [MainThread]: On master: Close
[0m08:52:24.238430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:24.239560 [debug] [MainThread]: Connection 'test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b' was properly closed.
[0m08:52:24.240639 [debug] [MainThread]: Connection 'test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844' was properly closed.
[0m08:52:24.241759 [debug] [MainThread]: Connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81' was properly closed.
[0m08:52:24.242838 [debug] [MainThread]: Connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657' was properly closed.
[0m08:52:24.243948 [info ] [MainThread]: 
[0m08:52:24.245064 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m08:52:24.249007 [debug] [MainThread]: Command end result
[0m08:52:24.290032 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m08:52:24.294887 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m08:52:24.308113 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m08:52:24.308686 [info ] [MainThread]: 
[0m08:52:24.309237 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m08:52:24.309769 [info ] [MainThread]: 
[0m08:52:24.310341 [error] [MainThread]:   Database Error in test accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 14:         rank_floorsize as value_field,
                   ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/accepted_values_gold_floorsize_02e8a7b329610308119f5635a546c818.sql
[0m08:52:24.310868 [info ] [MainThread]: 
[0m08:52:24.311480 [error] [MainThread]:   Database Error in test not_null_gold_floorsize_ranked_avg_prices_rank_floorsize (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 13: select rank_floorsize
                  ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.sql
[0m08:52:24.312078 [info ] [MainThread]: 
[0m08:52:24.312618 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m08:52:24.313855 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.522409, "process_in_blocks": "1784", "process_kernel_time": 0.197258, "process_mem_max_rss": "114216", "process_out_blocks": "1920", "process_user_time": 2.849741}
[0m08:52:24.314649 [debug] [MainThread]: Command `dbt test` failed at 08:52:24.314452 after 1.52 seconds
[0m08:52:24.315428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741fbf994f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741fbcff4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741fbcff4280>]}
[0m08:52:24.316489 [debug] [MainThread]: Flushing usage events
[0m08:52:24.907211 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:24:52.456648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ecdb967ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ecdba4f6590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ecdba4f6530>]}


============================== 10:24:52.460659 | 4aa2adac-434f-41f4-be02-73f8d6afa92b ==============================
[0m10:24:52.460659 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:24:52.461441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:24:52.675725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4aa2adac-434f-41f4-be02-73f8d6afa92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ecdba4cfdc0>]}
[0m10:24:52.753509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4aa2adac-434f-41f4-be02-73f8d6afa92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ecdba50a320>]}
[0m10:24:52.754679 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:24:52.886953 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:24:53.071913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:24:53.072850 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/gold_floorsize_ranked_avg_prices.sql
[0m10:24:53.654475 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m10:24:53.676482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4aa2adac-434f-41f4-be02-73f8d6afa92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ecdb7368130>]}
[0m10:24:53.807560 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:24:53.811623 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:24:53.893595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4aa2adac-434f-41f4-be02-73f8d6afa92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ecdb78c8880>]}
[0m10:24:53.894402 [info ] [MainThread]: Found 1 model, 6 data tests, 1 source, 431 macros
[0m10:24:53.894936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4aa2adac-434f-41f4-be02-73f8d6afa92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ecdb78c9540>]}
[0m10:24:53.897337 [info ] [MainThread]: 
[0m10:24:53.897980 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:24:53.898467 [info ] [MainThread]: 
[0m10:24:53.899263 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:24:53.900692 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo_zap'
[0m10:24:53.948688 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:24:53.949332 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m10:24:53.949916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:53.959871 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m10:24:53.960595 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:24:53.961068 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m10:24:53.964997 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m10:24:53.967044 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m10:24:53.967852 [debug] [ThreadPool]: On list_foo_zap: Close
[0m10:24:53.975608 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:53.976231 [debug] [MainThread]: On master: BEGIN
[0m10:24:53.976678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:24:53.985592 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:24:53.986223 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:53.986771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:24:53.991877 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m10:24:53.995131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4aa2adac-434f-41f4-be02-73f8d6afa92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ecdb78cb2b0>]}
[0m10:24:53.995800 [debug] [MainThread]: On master: ROLLBACK
[0m10:24:53.996541 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:53.997059 [debug] [MainThread]: On master: BEGIN
[0m10:24:53.997945 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:24:53.998466 [debug] [MainThread]: On master: COMMIT
[0m10:24:53.998954 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:53.999390 [debug] [MainThread]: On master: COMMIT
[0m10:24:54.000038 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:24:54.000660 [debug] [MainThread]: On master: Close
[0m10:24:54.003527 [debug] [Thread-1 (]: Began running node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b
[0m10:24:54.004259 [debug] [Thread-2 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:24:54.005209 [debug] [Thread-3 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:24:54.005935 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C  [RUN]
[0m10:24:54.006642 [debug] [Thread-4 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:24:54.007273 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_floorsize_ranked_avg_prices_floor_size ......... [RUN]
[0m10:24:54.007980 [info ] [Thread-3 (]: 3 of 6 START test not_null_gold_floorsize_ranked_avg_prices_id ................. [RUN]
[0m10:24:54.009084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b)
[0m10:24:54.010119 [info ] [Thread-4 (]: 4 of 6 START test not_null_gold_floorsize_ranked_avg_prices_kind ............... [RUN]
[0m10:24:54.011274 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373'
[0m10:24:54.012189 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3'
[0m10:24:54.013137 [debug] [Thread-1 (]: Began compiling node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b
[0m10:24:54.014378 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657'
[0m10:24:54.015183 [debug] [Thread-2 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:24:54.016043 [debug] [Thread-3 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:24:54.027290 [debug] [Thread-4 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:24:54.031242 [debug] [Thread-1 (]: Writing injected SQL for node "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b"
[0m10:24:54.051713 [debug] [Thread-2 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:24:54.053815 [debug] [Thread-3 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:24:54.060238 [debug] [Thread-4 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:24:54.061879 [debug] [Thread-2 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:24:54.068146 [debug] [Thread-4 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:24:54.079298 [debug] [Thread-1 (]: Began executing node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b
[0m10:24:54.085422 [debug] [Thread-3 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:24:54.108216 [debug] [Thread-2 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:24:54.115872 [debug] [Thread-4 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:24:54.119721 [debug] [Thread-3 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:24:54.131130 [debug] [Thread-1 (]: Writing runtime sql for node "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b"
[0m10:24:54.132346 [debug] [Thread-4 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:24:54.133046 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:24:54.133727 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: BEGIN
[0m10:24:54.134430 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: BEGIN
[0m10:24:54.135288 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:24:54.135917 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:24:54.136551 [debug] [Thread-1 (]: Using postgres connection "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b"
[0m10:24:54.137168 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:24:54.138007 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: BEGIN
[0m10:24:54.139113 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b: BEGIN
[0m10:24:54.140453 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:24:54.141303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:54.147689 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m10:24:54.148685 [debug] [Thread-4 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:24:54.149428 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m10:24:54.150191 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select kind
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where kind is null



      
    ) dbt_internal_test
[0m10:24:54.151059 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:24:54.151751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m10:24:54.152309 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m10:24:54.152989 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select floor_size
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where floor_size is null



      
    ) dbt_internal_test
[0m10:24:54.153734 [debug] [Thread-1 (]: Using postgres connection "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b"
[0m10:24:54.154408 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:24:54.155519 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rank_floorsize as value_field,
        count(*) as n_records

    from "foo"."zap"."gold_floorsize_ranked_avg_prices"
    group by rank_floorsize

)

select *
from all_values
where value_field not in (
    'S','A','B','C'
)



      
    ) dbt_internal_test
[0m10:24:54.156316 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where id is null



      
    ) dbt_internal_test
[0m10:24:54.158082 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "rank_floorsize" does not exist
LINE 14:         rank_floorsize as value_field,
                 ^

[0m10:24:54.158904 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:24:54.159543 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b: ROLLBACK
[0m10:24:54.165354 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: ROLLBACK
[0m10:24:54.166056 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m10:24:54.166799 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.011 seconds
[0m10:24:54.168024 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b: Close
[0m10:24:54.170571 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: ROLLBACK
[0m10:24:54.171257 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: Close
[0m10:24:54.173589 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: ROLLBACK
[0m10:24:54.174931 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: Close
[0m10:24:54.176408 [info ] [Thread-3 (]: 3 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_id ....................... [[32mPASS[0m in 0.16s]
[0m10:24:54.177653 [info ] [Thread-4 (]: 4 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_kind ..................... [[32mPASS[0m in 0.16s]
[0m10:24:54.178408 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: Close
[0m10:24:54.179298 [debug] [Thread-3 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:24:54.180349 [debug] [Thread-4 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:24:54.181228 [debug] [Thread-3 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81
[0m10:24:54.182482 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_floor_size ............... [[32mPASS[0m in 0.17s]
[0m10:24:54.184232 [debug] [Thread-4 (]: Began running node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:24:54.185464 [info ] [Thread-3 (]: 5 of 6 START test not_null_gold_floorsize_ranked_avg_prices_rank_floorsize ..... [RUN]
[0m10:24:54.186869 [debug] [Thread-2 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:24:54.188107 [info ] [Thread-4 (]: 6 of 6 START test unique_gold_floorsize_ranked_avg_prices_id ................... [RUN]
[0m10:24:54.190398 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3, now test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81)
[0m10:24:54.192065 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657, now test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844)
[0m10:24:54.193122 [debug] [Thread-1 (]: Database Error in test accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 14:         rank_floorsize as value_field,
                   ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/accepted_values_gold_floorsize_02e8a7b329610308119f5635a546c818.sql
[0m10:24:54.193995 [debug] [Thread-3 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81
[0m10:24:54.195109 [debug] [Thread-4 (]: Began compiling node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:24:54.196142 [error] [Thread-1 (]: 1 of 6 ERROR accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C  [[31mERROR[0m in 0.19s]
[0m10:24:54.205058 [debug] [Thread-3 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"
[0m10:24:54.214640 [debug] [Thread-4 (]: Writing injected SQL for node "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:24:54.215574 [debug] [Thread-1 (]: Finished running node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b
[0m10:24:54.217567 [debug] [Thread-7 (]: Marking all children of 'test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 14:         rank_floorsize as value_field,
                   ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/accepted_values_gold_floorsize_02e8a7b329610308119f5635a546c818.sql.
[0m10:24:54.219612 [debug] [Thread-4 (]: Began executing node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:24:54.220574 [debug] [Thread-3 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81
[0m10:24:54.224544 [debug] [Thread-4 (]: Writing runtime sql for node "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:24:54.228821 [debug] [Thread-3 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"
[0m10:24:54.230268 [debug] [Thread-4 (]: Using postgres connection "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:24:54.231300 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"
[0m10:24:54.231913 [debug] [Thread-4 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: BEGIN
[0m10:24:54.232718 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81: BEGIN
[0m10:24:54.233625 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:24:54.234565 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:24:54.242740 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m10:24:54.243579 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m10:24:54.244196 [debug] [Thread-4 (]: Using postgres connection "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:24:54.244900 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"
[0m10:24:54.245922 [debug] [Thread-4 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:24:54.246518 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rank_floorsize
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where rank_floorsize is null



      
    ) dbt_internal_test
[0m10:24:54.248266 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "rank_floorsize" does not exist
LINE 13: select rank_floorsize
                ^

[0m10:24:54.249058 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81: ROLLBACK
[0m10:24:54.250428 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81: Close
[0m10:24:54.251917 [debug] [Thread-3 (]: Database Error in test not_null_gold_floorsize_ranked_avg_prices_rank_floorsize (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 13: select rank_floorsize
                  ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.sql
[0m10:24:54.252813 [error] [Thread-3 (]: 5 of 6 ERROR not_null_gold_floorsize_ranked_avg_prices_rank_floorsize .......... [[31mERROR[0m in 0.06s]
[0m10:24:54.254007 [debug] [Thread-3 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81
[0m10:24:54.254953 [debug] [Thread-7 (]: Marking all children of 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81' to be skipped because of status 'error'.  Reason: Database Error in test not_null_gold_floorsize_ranked_avg_prices_rank_floorsize (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 13: select rank_floorsize
                  ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.sql.
[0m10:24:54.278528 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.031 seconds
[0m10:24:54.280568 [debug] [Thread-4 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: ROLLBACK
[0m10:24:54.281491 [debug] [Thread-4 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: Close
[0m10:24:54.282632 [info ] [Thread-4 (]: 6 of 6 PASS unique_gold_floorsize_ranked_avg_prices_id ......................... [[32mPASS[0m in 0.09s]
[0m10:24:54.284024 [debug] [Thread-4 (]: Finished running node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:24:54.285911 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:54.286497 [debug] [MainThread]: On master: BEGIN
[0m10:24:54.286956 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:24:54.295930 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:24:54.296521 [debug] [MainThread]: On master: COMMIT
[0m10:24:54.296991 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:54.297425 [debug] [MainThread]: On master: COMMIT
[0m10:24:54.298064 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:24:54.298573 [debug] [MainThread]: On master: Close
[0m10:24:54.299584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:54.300351 [debug] [MainThread]: Connection 'test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b' was properly closed.
[0m10:24:54.301165 [debug] [MainThread]: Connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373' was properly closed.
[0m10:24:54.301854 [debug] [MainThread]: Connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81' was properly closed.
[0m10:24:54.302439 [debug] [MainThread]: Connection 'test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844' was properly closed.
[0m10:24:54.303004 [info ] [MainThread]: 
[0m10:24:54.303514 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m10:24:54.305494 [debug] [MainThread]: Command end result
[0m10:24:54.335924 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:24:54.338106 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:24:54.348596 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m10:24:54.349379 [info ] [MainThread]: 
[0m10:24:54.350139 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m10:24:54.350685 [info ] [MainThread]: 
[0m10:24:54.351270 [error] [MainThread]:   Database Error in test accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 14:         rank_floorsize as value_field,
                   ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/accepted_values_gold_floorsize_02e8a7b329610308119f5635a546c818.sql
[0m10:24:54.351772 [info ] [MainThread]: 
[0m10:24:54.352340 [error] [MainThread]:   Database Error in test not_null_gold_floorsize_ranked_avg_prices_rank_floorsize (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 13: select rank_floorsize
                  ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.sql
[0m10:24:54.352849 [info ] [MainThread]: 
[0m10:24:54.353359 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m10:24:54.354587 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.9714973, "process_in_blocks": "480", "process_kernel_time": 0.214009, "process_mem_max_rss": "119740", "process_out_blocks": "2776", "process_user_time": 3.259143}
[0m10:24:54.355340 [debug] [MainThread]: Command `dbt test` failed at 10:24:54.355177 after 1.97 seconds
[0m10:24:54.356045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ecdb967ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ecdb953e5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ecdb67635e0>]}
[0m10:24:54.357015 [debug] [MainThread]: Flushing usage events
[0m10:24:56.103742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:25:09.866934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75895c944eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75895d81e380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75895d81e320>]}


============================== 10:25:09.870330 | a202d009-bb29-43f2-b2f8-d33aa2b82fec ==============================
[0m10:25:09.870330 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:25:09.871106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:25:10.084630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a202d009-bb29-43f2-b2f8-d33aa2b82fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75895d97f8b0>]}
[0m10:25:10.162967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a202d009-bb29-43f2-b2f8-d33aa2b82fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75895c6cc7f0>]}
[0m10:25:10.163998 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:25:10.296353 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:25:10.476619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:25:10.477201 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:25:10.485334 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m10:25:10.553252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a202d009-bb29-43f2-b2f8-d33aa2b82fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75895ac755d0>]}
[0m10:25:10.686239 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:25:10.690353 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:25:10.703332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a202d009-bb29-43f2-b2f8-d33aa2b82fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75895ac575e0>]}
[0m10:25:10.704072 [info ] [MainThread]: Found 1 model, 6 data tests, 1 source, 431 macros
[0m10:25:10.704578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a202d009-bb29-43f2-b2f8-d33aa2b82fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75895ac56470>]}
[0m10:25:10.706612 [info ] [MainThread]: 
[0m10:25:10.707204 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:25:10.707681 [info ] [MainThread]: 
[0m10:25:10.708405 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:25:10.710009 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m10:25:10.759048 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m10:25:10.759689 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m10:25:10.760247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:10.771185 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m10:25:10.773022 [debug] [ThreadPool]: On list_foo: Close
[0m10:25:10.775369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m10:25:10.784171 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:25:10.784793 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m10:25:10.785235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:25:10.793679 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:25:10.794281 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:25:10.794741 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m10:25:10.798669 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m10:25:10.800962 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m10:25:10.801833 [debug] [ThreadPool]: On list_foo_zap: Close
[0m10:25:10.809483 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:10.810080 [debug] [MainThread]: On master: BEGIN
[0m10:25:10.810514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:25:10.819036 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:25:10.819626 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:10.820156 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:25:10.825127 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m10:25:10.828455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a202d009-bb29-43f2-b2f8-d33aa2b82fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75895ac764a0>]}
[0m10:25:10.829121 [debug] [MainThread]: On master: ROLLBACK
[0m10:25:10.829913 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:10.830451 [debug] [MainThread]: On master: BEGIN
[0m10:25:10.831307 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:25:10.831864 [debug] [MainThread]: On master: COMMIT
[0m10:25:10.832330 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:10.832767 [debug] [MainThread]: On master: COMMIT
[0m10:25:10.833476 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:25:10.834008 [debug] [MainThread]: On master: Close
[0m10:25:10.837712 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m10:25:10.838586 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m10:25:10.839327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_floorsize_ranked_avg_prices)
[0m10:25:10.839954 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m10:25:10.851796 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:25:10.852821 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m10:25:10.906405 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:25:10.907396 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:25:10.907974 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m10:25:10.908464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:25:10.917479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m10:25:10.918176 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:25:10.918760 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size <= 30
		then 'E'
		when sz.floor_size <= 60
		then 'D'
		when sz.floor_size <= 90
		then 'C'
		when sz.floor_size <= 120
		then 'B'
        WHEN sz.floor_size > 120
        THEN 'A'
	end as floor_size_rank
	from source sz 
)
select
*,
price_rent/floor_size as price_rent_per_m2
from rank_floorsize 
order by price_rent_per_m2
  );
[0m10:25:10.924011 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m10:25:10.933763 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:25:10.934429 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices" rename to "gold_floorsize_ranked_avg_prices__dbt_backup"
[0m10:25:10.935922 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:25:10.940403 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:25:10.941037 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m10:25:10.942450 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:25:10.965138 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m10:25:10.965828 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:25:10.966365 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m10:25:10.969401 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:25:10.979008 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m10:25:10.985587 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m10:25:10.986248 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m10:25:10.990364 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m10:25:10.994031 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m10:25:10.996563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a202d009-bb29-43f2-b2f8-d33aa2b82fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75895d97eb90>]}
[0m10:25:10.997602 [info ] [Thread-1 (]: 1 of 1 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.16s]
[0m10:25:10.998540 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m10:25:11.000145 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:11.000799 [debug] [MainThread]: On master: BEGIN
[0m10:25:11.001310 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:25:11.010595 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:25:11.011623 [debug] [MainThread]: On master: COMMIT
[0m10:25:11.012482 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:11.013007 [debug] [MainThread]: On master: COMMIT
[0m10:25:11.013684 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:25:11.014208 [debug] [MainThread]: On master: Close
[0m10:25:11.014935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:11.015463 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m10:25:11.016089 [info ] [MainThread]: 
[0m10:25:11.017046 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m10:25:11.018597 [debug] [MainThread]: Command end result
[0m10:25:11.046087 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:25:11.048254 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:25:11.057671 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m10:25:11.058251 [info ] [MainThread]: 
[0m10:25:11.058842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:25:11.059404 [info ] [MainThread]: 
[0m10:25:11.060014 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:25:11.061309 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2669104, "process_in_blocks": "0", "process_kernel_time": 0.199082, "process_mem_max_rss": "110796", "process_out_blocks": "1792", "process_user_time": 2.519037}
[0m10:25:11.061986 [debug] [MainThread]: Command `dbt run` succeeded at 10:25:11.061880 after 1.27 seconds
[0m10:25:11.062503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75895c944eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75895c80abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75895a1b79a0>]}
[0m10:25:11.063057 [debug] [MainThread]: Flushing usage events
[0m10:25:13.001265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:25:39.391300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5328594e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a532943e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a532943e530>]}


============================== 10:25:39.394606 | 8e4e7e5a-6a98-4997-a230-ee0194195580 ==============================
[0m10:25:39.394606 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:25:39.395423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:25:39.611001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e4e7e5a-6a98-4997-a230-ee0194195580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5329416d40>]}
[0m10:25:39.688485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e4e7e5a-6a98-4997-a230-ee0194195580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a53275e8c70>]}
[0m10:25:39.689557 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:25:39.822267 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:25:40.007877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:25:40.008494 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:25:40.017203 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m10:25:40.090008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e4e7e5a-6a98-4997-a230-ee0194195580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a53268816f0>]}
[0m10:25:40.225149 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:25:40.229189 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:25:40.253368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e4e7e5a-6a98-4997-a230-ee0194195580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a53269fa590>]}
[0m10:25:40.254111 [info ] [MainThread]: Found 1 model, 6 data tests, 1 source, 431 macros
[0m10:25:40.254612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e4e7e5a-6a98-4997-a230-ee0194195580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a53269fb820>]}
[0m10:25:40.257203 [info ] [MainThread]: 
[0m10:25:40.257840 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:25:40.258344 [info ] [MainThread]: 
[0m10:25:40.259346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:25:40.260941 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo_zap'
[0m10:25:40.308807 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:25:40.309429 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m10:25:40.309884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:40.318581 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m10:25:40.319213 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:25:40.319686 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m10:25:40.323227 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m10:25:40.325564 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m10:25:40.326531 [debug] [ThreadPool]: On list_foo_zap: Close
[0m10:25:40.333729 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:40.334322 [debug] [MainThread]: On master: BEGIN
[0m10:25:40.334776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:25:40.342984 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:25:40.343605 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:40.344170 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:25:40.349236 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m10:25:40.352439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e4e7e5a-6a98-4997-a230-ee0194195580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a53269fb610>]}
[0m10:25:40.353141 [debug] [MainThread]: On master: ROLLBACK
[0m10:25:40.353953 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:40.354449 [debug] [MainThread]: On master: BEGIN
[0m10:25:40.355349 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:25:40.355889 [debug] [MainThread]: On master: COMMIT
[0m10:25:40.356353 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:40.356823 [debug] [MainThread]: On master: COMMIT
[0m10:25:40.357502 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:25:40.358031 [debug] [MainThread]: On master: Close
[0m10:25:40.361093 [debug] [Thread-1 (]: Began running node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b
[0m10:25:40.361836 [debug] [Thread-2 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:25:40.362437 [debug] [Thread-3 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:25:40.363030 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C  [RUN]
[0m10:25:40.363813 [debug] [Thread-4 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:25:40.364424 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_floorsize_ranked_avg_prices_floor_size ......... [RUN]
[0m10:25:40.365128 [info ] [Thread-3 (]: 3 of 6 START test not_null_gold_floorsize_ranked_avg_prices_id ................. [RUN]
[0m10:25:40.365929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b)
[0m10:25:40.366572 [info ] [Thread-4 (]: 4 of 6 START test not_null_gold_floorsize_ranked_avg_prices_kind ............... [RUN]
[0m10:25:40.367575 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373'
[0m10:25:40.368461 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3'
[0m10:25:40.369369 [debug] [Thread-1 (]: Began compiling node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b
[0m10:25:40.370444 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657'
[0m10:25:40.371383 [debug] [Thread-2 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:25:40.372289 [debug] [Thread-3 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:25:40.383743 [debug] [Thread-4 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:25:40.405344 [debug] [Thread-1 (]: Writing injected SQL for node "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b"
[0m10:25:40.413718 [debug] [Thread-2 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:25:40.421449 [debug] [Thread-3 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:25:40.429583 [debug] [Thread-4 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:25:40.430656 [debug] [Thread-1 (]: Began executing node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b
[0m10:25:40.442028 [debug] [Thread-2 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:25:40.453250 [debug] [Thread-3 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:25:40.464041 [debug] [Thread-1 (]: Writing runtime sql for node "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b"
[0m10:25:40.474256 [debug] [Thread-3 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:25:40.475984 [debug] [Thread-2 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:25:40.476814 [debug] [Thread-4 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:25:40.481547 [debug] [Thread-4 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:25:40.482738 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:25:40.483815 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: BEGIN
[0m10:25:40.484333 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:25:40.485316 [debug] [Thread-1 (]: Using postgres connection "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b"
[0m10:25:40.486136 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:25:40.486948 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b: BEGIN
[0m10:25:40.487692 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: BEGIN
[0m10:25:40.488434 [debug] [Thread-4 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:25:40.489048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:25:40.489760 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:25:40.490583 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: BEGIN
[0m10:25:40.491557 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:25:40.493153 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m10:25:40.493973 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:25:40.494729 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where id is null



      
    ) dbt_internal_test
[0m10:25:40.499368 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m10:25:40.500248 [debug] [Thread-1 (]: Using postgres connection "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b"
[0m10:25:40.501043 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rank_floorsize as value_field,
        count(*) as n_records

    from "foo"."zap"."gold_floorsize_ranked_avg_prices"
    group by rank_floorsize

)

select *
from all_values
where value_field not in (
    'S','A','B','C'
)



      
    ) dbt_internal_test
[0m10:25:40.501763 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m10:25:40.502607 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m10:25:40.503218 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m10:25:40.504079 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:25:40.505122 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "rank_floorsize" does not exist
LINE 14:         rank_floorsize as value_field,
                 ^

[0m10:25:40.511779 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: ROLLBACK
[0m10:25:40.512609 [debug] [Thread-4 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:25:40.513670 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select floor_size
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where floor_size is null



      
    ) dbt_internal_test
[0m10:25:40.514327 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b: ROLLBACK
[0m10:25:40.515014 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select kind
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where kind is null



      
    ) dbt_internal_test
[0m10:25:40.515649 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: Close
[0m10:25:40.517441 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b: Close
[0m10:25:40.519120 [info ] [Thread-3 (]: 3 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_id ....................... [[32mPASS[0m in 0.15s]
[0m10:25:40.521206 [debug] [Thread-3 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:25:40.522022 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:25:40.522741 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:25:40.523960 [debug] [Thread-3 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81
[0m10:25:40.527261 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: ROLLBACK
[0m10:25:40.530106 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: ROLLBACK
[0m10:25:40.531302 [info ] [Thread-3 (]: 5 of 6 START test not_null_gold_floorsize_ranked_avg_prices_rank_floorsize ..... [RUN]
[0m10:25:40.533254 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: Close
[0m10:25:40.534155 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3, now test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81)
[0m10:25:40.534958 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: Close
[0m10:25:40.536195 [debug] [Thread-3 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81
[0m10:25:40.537800 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_floor_size ............... [[32mPASS[0m in 0.17s]
[0m10:25:40.546091 [debug] [Thread-3 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"
[0m10:25:40.539265 [info ] [Thread-4 (]: 4 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_kind ..................... [[32mPASS[0m in 0.17s]
[0m10:25:40.547304 [debug] [Thread-2 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:25:40.548449 [debug] [Thread-4 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:25:40.549671 [debug] [Thread-2 (]: Began running node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:25:40.550994 [debug] [Thread-3 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81
[0m10:25:40.552571 [debug] [Thread-1 (]: Database Error in test accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 14:         rank_floorsize as value_field,
                   ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/accepted_values_gold_floorsize_02e8a7b329610308119f5635a546c818.sql
[0m10:25:40.553426 [info ] [Thread-2 (]: 6 of 6 START test unique_gold_floorsize_ranked_avg_prices_id ................... [RUN]
[0m10:25:40.557612 [debug] [Thread-3 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"
[0m10:25:40.558491 [error] [Thread-1 (]: 1 of 6 ERROR accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C  [[31mERROR[0m in 0.19s]
[0m10:25:40.559873 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373, now test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844)
[0m10:25:40.561158 [debug] [Thread-1 (]: Finished running node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b
[0m10:25:40.561865 [debug] [Thread-2 (]: Began compiling node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:25:40.562708 [debug] [Thread-7 (]: Marking all children of 'test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 14:         rank_floorsize as value_field,
                   ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/accepted_values_gold_floorsize_02e8a7b329610308119f5635a546c818.sql.
[0m10:25:40.563423 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"
[0m10:25:40.630461 [debug] [Thread-2 (]: Writing injected SQL for node "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:25:40.631475 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81: BEGIN
[0m10:25:40.632570 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:25:40.633464 [debug] [Thread-2 (]: Began executing node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:25:40.637269 [debug] [Thread-2 (]: Writing runtime sql for node "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:25:40.638304 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:25:40.638990 [debug] [Thread-2 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: BEGIN
[0m10:25:40.639495 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:25:40.641448 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m10:25:40.642214 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"
[0m10:25:40.642865 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rank_floorsize
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where rank_floorsize is null



      
    ) dbt_internal_test
[0m10:25:40.644811 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "rank_floorsize" does not exist
LINE 13: select rank_floorsize
                ^

[0m10:25:40.645541 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81: ROLLBACK
[0m10:25:40.646481 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81: Close
[0m10:25:40.648022 [debug] [Thread-3 (]: Database Error in test not_null_gold_floorsize_ranked_avg_prices_rank_floorsize (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 13: select rank_floorsize
                  ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.sql
[0m10:25:40.649207 [error] [Thread-3 (]: 5 of 6 ERROR not_null_gold_floorsize_ranked_avg_prices_rank_floorsize .......... [[31mERROR[0m in 0.11s]
[0m10:25:40.650075 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m10:25:40.650989 [debug] [Thread-3 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81
[0m10:25:40.651620 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:25:40.652473 [debug] [Thread-7 (]: Marking all children of 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81' to be skipped because of status 'error'.  Reason: Database Error in test not_null_gold_floorsize_ranked_avg_prices_rank_floorsize (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 13: select rank_floorsize
                  ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.sql.
[0m10:25:40.653118 [debug] [Thread-2 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:25:40.684340 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.030 seconds
[0m10:25:40.686360 [debug] [Thread-2 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: ROLLBACK
[0m10:25:40.687220 [debug] [Thread-2 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: Close
[0m10:25:40.688208 [info ] [Thread-2 (]: 6 of 6 PASS unique_gold_floorsize_ranked_avg_prices_id ......................... [[32mPASS[0m in 0.13s]
[0m10:25:40.689128 [debug] [Thread-2 (]: Finished running node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:25:40.690758 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:40.691372 [debug] [MainThread]: On master: BEGIN
[0m10:25:40.691912 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:25:40.701383 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:25:40.702220 [debug] [MainThread]: On master: COMMIT
[0m10:25:40.702714 [debug] [MainThread]: Using postgres connection "master"
[0m10:25:40.703161 [debug] [MainThread]: On master: COMMIT
[0m10:25:40.703807 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:25:40.704282 [debug] [MainThread]: On master: Close
[0m10:25:40.705018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:40.705551 [debug] [MainThread]: Connection 'test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C.0eab5dbc8b' was properly closed.
[0m10:25:40.706037 [debug] [MainThread]: Connection 'test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844' was properly closed.
[0m10:25:40.706496 [debug] [MainThread]: Connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81' was properly closed.
[0m10:25:40.706933 [debug] [MainThread]: Connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657' was properly closed.
[0m10:25:40.707435 [info ] [MainThread]: 
[0m10:25:40.707964 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m10:25:40.709985 [debug] [MainThread]: Command end result
[0m10:25:40.738218 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:25:40.740444 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:25:40.751001 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m10:25:40.751578 [info ] [MainThread]: 
[0m10:25:40.752151 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m10:25:40.752683 [info ] [MainThread]: 
[0m10:25:40.753257 [error] [MainThread]:   Database Error in test accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__S__A__B__C (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 14:         rank_floorsize as value_field,
                   ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/accepted_values_gold_floorsize_02e8a7b329610308119f5635a546c818.sql
[0m10:25:40.753753 [info ] [MainThread]: 
[0m10:25:40.754291 [error] [MainThread]:   Database Error in test not_null_gold_floorsize_ranked_avg_prices_rank_floorsize (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 13: select rank_floorsize
                  ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.sql
[0m10:25:40.754767 [info ] [MainThread]: 
[0m10:25:40.755264 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m10:25:40.756444 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.438283, "process_in_blocks": "0", "process_kernel_time": 0.192908, "process_mem_max_rss": "113676", "process_out_blocks": "1920", "process_user_time": 2.706711}
[0m10:25:40.757114 [debug] [MainThread]: Command `dbt test` failed at 10:25:40.757008 after 1.44 seconds
[0m10:25:40.757685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5328594e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a53268c48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a53268c4cd0>]}
[0m10:25:40.758392 [debug] [MainThread]: Flushing usage events
[0m10:25:43.663831 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:28:02.305165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdb0098eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdb0f424d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdb0f42470>]}


============================== 10:28:02.308567 | 4052cfc1-77a0-4a09-b296-4a636162a2c9 ==============================
[0m10:28:02.308567 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:28:02.309462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:28:02.521737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4052cfc1-77a0-4a09-b296-4a636162a2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdb10bf8b0>]}
[0m10:28:02.601410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4052cfc1-77a0-4a09-b296-4a636162a2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdaf3cccd0>]}
[0m10:28:02.602453 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:28:02.741509 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:28:02.922252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:28:02.923335 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/schema.yml
[0m10:28:03.503125 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m10:28:03.525596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4052cfc1-77a0-4a09-b296-4a636162a2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdade8d840>]}
[0m10:28:03.659021 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:28:03.663100 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:28:03.745061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4052cfc1-77a0-4a09-b296-4a636162a2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdae3ec370>]}
[0m10:28:03.745803 [info ] [MainThread]: Found 1 model, 6 data tests, 1 source, 431 macros
[0m10:28:03.746347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4052cfc1-77a0-4a09-b296-4a636162a2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdae3ef880>]}
[0m10:28:03.748644 [info ] [MainThread]: 
[0m10:28:03.749244 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:28:03.749743 [info ] [MainThread]: 
[0m10:28:03.750579 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:28:03.752168 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo_zap'
[0m10:28:03.798119 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:28:03.798752 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m10:28:03.799241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:03.809260 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m10:28:03.809870 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:28:03.810368 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m10:28:03.814047 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m10:28:03.816497 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m10:28:03.817263 [debug] [ThreadPool]: On list_foo_zap: Close
[0m10:28:03.824413 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:03.825006 [debug] [MainThread]: On master: BEGIN
[0m10:28:03.825438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:28:03.833762 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:28:03.834460 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:03.835344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:28:03.840783 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m10:28:03.843621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4052cfc1-77a0-4a09-b296-4a636162a2c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdae3d3190>]}
[0m10:28:03.844284 [debug] [MainThread]: On master: ROLLBACK
[0m10:28:03.845069 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:03.845572 [debug] [MainThread]: On master: BEGIN
[0m10:28:03.846458 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:28:03.846978 [debug] [MainThread]: On master: COMMIT
[0m10:28:03.847477 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:03.847988 [debug] [MainThread]: On master: COMMIT
[0m10:28:03.848794 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:28:03.849345 [debug] [MainThread]: On master: Close
[0m10:28:03.852516 [debug] [Thread-1 (]: Began running node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E.f434ac339e
[0m10:28:03.853243 [debug] [Thread-2 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:28:03.854240 [debug] [Thread-3 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:28:03.854863 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E  [RUN]
[0m10:28:03.855935 [debug] [Thread-4 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:28:03.856863 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_floorsize_ranked_avg_prices_floor_size ......... [RUN]
[0m10:28:03.857550 [info ] [Thread-3 (]: 3 of 6 START test not_null_gold_floorsize_ranked_avg_prices_id ................. [RUN]
[0m10:28:03.858370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E.f434ac339e)
[0m10:28:03.859644 [info ] [Thread-4 (]: 4 of 6 START test not_null_gold_floorsize_ranked_avg_prices_kind ............... [RUN]
[0m10:28:03.862048 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373'
[0m10:28:03.863258 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3'
[0m10:28:03.864158 [debug] [Thread-1 (]: Began compiling node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E.f434ac339e
[0m10:28:03.865290 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657'
[0m10:28:03.866072 [debug] [Thread-2 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:28:03.866842 [debug] [Thread-3 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:28:03.880646 [debug] [Thread-1 (]: Writing injected SQL for node "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E.f434ac339e"
[0m10:28:03.881290 [debug] [Thread-4 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:28:03.901782 [debug] [Thread-2 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:28:03.904124 [debug] [Thread-3 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:28:03.911080 [debug] [Thread-4 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:28:03.911860 [debug] [Thread-1 (]: Began executing node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E.f434ac339e
[0m10:28:03.912912 [debug] [Thread-2 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:28:03.914019 [debug] [Thread-3 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:28:03.925303 [debug] [Thread-4 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:28:03.973065 [debug] [Thread-2 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:28:03.975212 [debug] [Thread-3 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:28:03.976990 [debug] [Thread-1 (]: Writing runtime sql for node "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E.f434ac339e"
[0m10:28:03.980561 [debug] [Thread-4 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:28:03.982351 [debug] [Thread-1 (]: Using postgres connection "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E.f434ac339e"
[0m10:28:03.983082 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:28:03.983825 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E.f434ac339e: BEGIN
[0m10:28:03.984461 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: BEGIN
[0m10:28:03.985113 [debug] [Thread-4 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:28:03.985731 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:28:03.986285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:03.987295 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:28:03.988191 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: BEGIN
[0m10:28:03.988966 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: BEGIN
[0m10:28:03.990614 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:28:03.991541 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:28:03.997758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m10:28:03.998638 [debug] [Thread-1 (]: Using postgres connection "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E.f434ac339e"
[0m10:28:03.999484 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m10:28:04.000240 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E.f434ac339e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E.f434ac339e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rank_floorsize as value_field,
        count(*) as n_records

    from "foo"."zap"."gold_floorsize_ranked_avg_prices"
    group by rank_floorsize

)

select *
from all_values
where value_field not in (
    'A','B','C','D','E'
)



      
    ) dbt_internal_test
[0m10:28:04.001249 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:28:04.002217 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m10:28:04.002911 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m10:28:04.003594 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select floor_size
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where floor_size is null



      
    ) dbt_internal_test
[0m10:28:04.004344 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "rank_floorsize" does not exist
LINE 14:         rank_floorsize as value_field,
                 ^

[0m10:28:04.005019 [debug] [Thread-4 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:28:04.005587 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:28:04.006255 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E.f434ac339e: ROLLBACK
[0m10:28:04.006878 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select kind
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where kind is null



      
    ) dbt_internal_test
[0m10:28:04.007505 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where id is null



      
    ) dbt_internal_test
[0m10:28:04.008814 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E.f434ac339e: Close
[0m10:28:04.012013 [debug] [Thread-1 (]: Database Error in test accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 14:         rank_floorsize as value_field,
                   ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/accepted_values_gold_floorsize_3ddda45f4e72ccd914c4c043e501a7bd.sql
[0m10:28:04.012789 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m10:28:04.013646 [error] [Thread-1 (]: 1 of 6 ERROR accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E  [[31mERROR[0m in 0.16s]
[0m10:28:04.014365 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:28:04.015014 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m10:28:04.021632 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: ROLLBACK
[0m10:28:04.022627 [debug] [Thread-1 (]: Finished running node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E.f434ac339e
[0m10:28:04.025240 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: ROLLBACK
[0m10:28:04.027446 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: ROLLBACK
[0m10:28:04.028312 [debug] [Thread-1 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81
[0m10:28:04.029205 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: Close
[0m10:28:04.030598 [debug] [Thread-7 (]: Marking all children of 'test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E.f434ac339e' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 14:         rank_floorsize as value_field,
                   ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/accepted_values_gold_floorsize_3ddda45f4e72ccd914c4c043e501a7bd.sql.
[0m10:28:04.031726 [info ] [Thread-1 (]: 5 of 6 START test not_null_gold_floorsize_ranked_avg_prices_rank_floorsize ..... [RUN]
[0m10:28:04.032373 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: Close
[0m10:28:04.033000 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: Close
[0m10:28:04.036449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E.f434ac339e, now test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81)
[0m10:28:04.035510 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_floor_size ............... [[32mPASS[0m in 0.17s]
[0m10:28:04.037777 [debug] [Thread-1 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81
[0m10:28:04.039472 [info ] [Thread-3 (]: 3 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_id ....................... [[32mPASS[0m in 0.18s]
[0m10:28:04.040468 [info ] [Thread-4 (]: 4 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_kind ..................... [[32mPASS[0m in 0.18s]
[0m10:28:04.041998 [debug] [Thread-2 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:28:04.049034 [debug] [Thread-1 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"
[0m10:28:04.050414 [debug] [Thread-3 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:28:04.052145 [debug] [Thread-4 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:28:04.053067 [debug] [Thread-2 (]: Began running node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:28:04.055478 [debug] [Thread-1 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81
[0m10:28:04.054772 [info ] [Thread-2 (]: 6 of 6 START test unique_gold_floorsize_ranked_avg_prices_id ................... [RUN]
[0m10:28:04.059861 [debug] [Thread-1 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"
[0m10:28:04.060812 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373, now test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844)
[0m10:28:04.061862 [debug] [Thread-2 (]: Began compiling node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:28:04.071730 [debug] [Thread-2 (]: Writing injected SQL for node "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:28:04.073007 [debug] [Thread-1 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"
[0m10:28:04.073667 [debug] [Thread-1 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81: BEGIN
[0m10:28:04.074302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:04.075299 [debug] [Thread-2 (]: Began executing node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:28:04.079290 [debug] [Thread-2 (]: Writing runtime sql for node "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:28:04.080346 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:28:04.080981 [debug] [Thread-2 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: BEGIN
[0m10:28:04.081476 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:28:04.082845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m10:28:04.083511 [debug] [Thread-1 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"
[0m10:28:04.084281 [debug] [Thread-1 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rank_floorsize
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where rank_floorsize is null



      
    ) dbt_internal_test
[0m10:28:04.086196 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "rank_floorsize" does not exist
LINE 13: select rank_floorsize
                ^

[0m10:28:04.087097 [debug] [Thread-1 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81: ROLLBACK
[0m10:28:04.088461 [debug] [Thread-1 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81: Close
[0m10:28:04.090326 [debug] [Thread-1 (]: Database Error in test not_null_gold_floorsize_ranked_avg_prices_rank_floorsize (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 13: select rank_floorsize
                  ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.sql
[0m10:28:04.092335 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m10:28:04.091521 [error] [Thread-1 (]: 5 of 6 ERROR not_null_gold_floorsize_ranked_avg_prices_rank_floorsize .......... [[31mERROR[0m in 0.06s]
[0m10:28:04.093257 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:28:04.094064 [debug] [Thread-1 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81
[0m10:28:04.094633 [debug] [Thread-2 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:28:04.095795 [debug] [Thread-7 (]: Marking all children of 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81' to be skipped because of status 'error'.  Reason: Database Error in test not_null_gold_floorsize_ranked_avg_prices_rank_floorsize (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 13: select rank_floorsize
                  ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.sql.
[0m10:28:04.129496 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.032 seconds
[0m10:28:04.132155 [debug] [Thread-2 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: ROLLBACK
[0m10:28:04.133056 [debug] [Thread-2 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: Close
[0m10:28:04.134217 [info ] [Thread-2 (]: 6 of 6 PASS unique_gold_floorsize_ranked_avg_prices_id ......................... [[32mPASS[0m in 0.07s]
[0m10:28:04.135554 [debug] [Thread-2 (]: Finished running node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:28:04.137231 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:04.137847 [debug] [MainThread]: On master: BEGIN
[0m10:28:04.138340 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:28:04.147054 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:28:04.147681 [debug] [MainThread]: On master: COMMIT
[0m10:28:04.148187 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:04.148621 [debug] [MainThread]: On master: COMMIT
[0m10:28:04.149253 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:28:04.149737 [debug] [MainThread]: On master: Close
[0m10:28:04.150647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:04.151623 [debug] [MainThread]: Connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.1f137b1d81' was properly closed.
[0m10:28:04.152484 [debug] [MainThread]: Connection 'test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844' was properly closed.
[0m10:28:04.153320 [debug] [MainThread]: Connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3' was properly closed.
[0m10:28:04.154125 [debug] [MainThread]: Connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657' was properly closed.
[0m10:28:04.154718 [info ] [MainThread]: 
[0m10:28:04.155228 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m10:28:04.157065 [debug] [MainThread]: Command end result
[0m10:28:04.187134 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:28:04.189479 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:28:04.199604 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m10:28:04.200202 [info ] [MainThread]: 
[0m10:28:04.200985 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m10:28:04.201828 [info ] [MainThread]: 
[0m10:28:04.202412 [error] [MainThread]:   Database Error in test accepted_values_gold_floorsize_ranked_avg_prices_rank_floorsize__A__B__C__D__E (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 14:         rank_floorsize as value_field,
                   ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/accepted_values_gold_floorsize_3ddda45f4e72ccd914c4c043e501a7bd.sql
[0m10:28:04.202977 [info ] [MainThread]: 
[0m10:28:04.203541 [error] [MainThread]:   Database Error in test not_null_gold_floorsize_ranked_avg_prices_rank_floorsize (models/mart/schema.yml)
  column "rank_floorsize" does not exist
  LINE 13: select rank_floorsize
                  ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/not_null_gold_floorsize_ranked_avg_prices_rank_floorsize.sql
[0m10:28:04.204038 [info ] [MainThread]: 
[0m10:28:04.204608 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m10:28:04.205858 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.9735116, "process_in_blocks": "0", "process_kernel_time": 0.188746, "process_mem_max_rss": "119532", "process_out_blocks": "2768", "process_user_time": 3.258616}
[0m10:28:04.206657 [debug] [MainThread]: Command `dbt test` failed at 10:28:04.206454 after 1.97 seconds
[0m10:28:04.207444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdb0098eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdb033c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cbdae9335b0>]}
[0m10:28:04.208347 [debug] [MainThread]: Flushing usage events
[0m10:28:06.573125 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:28:29.187863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1167a7cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a11688f6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a11688f6500>]}


============================== 10:28:29.191169 | 3892f7e6-0d49-41ce-ba6c-05f26b677e5b ==============================
[0m10:28:29.191169 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:28:29.192005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:28:29.409650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3892f7e6-0d49-41ce-ba6c-05f26b677e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a11688cfa60>]}
[0m10:28:29.487361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3892f7e6-0d49-41ce-ba6c-05f26b677e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a116723add0>]}
[0m10:28:29.488411 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:28:29.625014 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:28:29.809120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:28:29.810186 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/schema.yml
[0m10:28:30.387362 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m10:28:30.409373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3892f7e6-0d49-41ce-ba6c-05f26b677e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a116576d8a0>]}
[0m10:28:30.540204 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:28:30.544344 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:28:30.625935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3892f7e6-0d49-41ce-ba6c-05f26b677e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1165cce8f0>]}
[0m10:28:30.626672 [info ] [MainThread]: Found 1 model, 6 data tests, 1 source, 431 macros
[0m10:28:30.627186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3892f7e6-0d49-41ce-ba6c-05f26b677e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1165ccded0>]}
[0m10:28:30.629534 [info ] [MainThread]: 
[0m10:28:30.630154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:28:30.630649 [info ] [MainThread]: 
[0m10:28:30.631416 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:28:30.633024 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo_zap'
[0m10:28:30.678731 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:28:30.679331 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m10:28:30.679774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:30.689811 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m10:28:30.690411 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:28:30.690902 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m10:28:30.694646 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m10:28:30.696933 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m10:28:30.697812 [debug] [ThreadPool]: On list_foo_zap: Close
[0m10:28:30.705825 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:30.706462 [debug] [MainThread]: On master: BEGIN
[0m10:28:30.706940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:28:30.715914 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:28:30.716563 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:30.717174 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:28:30.722225 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m10:28:30.725763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3892f7e6-0d49-41ce-ba6c-05f26b677e5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1165cb1f30>]}
[0m10:28:30.726425 [debug] [MainThread]: On master: ROLLBACK
[0m10:28:30.727217 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:30.727718 [debug] [MainThread]: On master: BEGIN
[0m10:28:30.728516 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:28:30.729047 [debug] [MainThread]: On master: COMMIT
[0m10:28:30.729560 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:30.730015 [debug] [MainThread]: On master: COMMIT
[0m10:28:30.730715 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:28:30.731250 [debug] [MainThread]: On master: Close
[0m10:28:30.734038 [debug] [Thread-1 (]: Began running node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E.4043bc552b
[0m10:28:30.734729 [debug] [Thread-2 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:28:30.735376 [debug] [Thread-3 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:28:30.735999 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E  [RUN]
[0m10:28:30.736699 [debug] [Thread-4 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:28:30.737316 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_floorsize_ranked_avg_prices_floor_size ......... [RUN]
[0m10:28:30.738073 [info ] [Thread-3 (]: 3 of 6 START test not_null_gold_floorsize_ranked_avg_prices_id ................. [RUN]
[0m10:28:30.739161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E.4043bc552b)
[0m10:28:30.739828 [info ] [Thread-4 (]: 4 of 6 START test not_null_gold_floorsize_ranked_avg_prices_kind ............... [RUN]
[0m10:28:30.741942 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373'
[0m10:28:30.743235 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3'
[0m10:28:30.744195 [debug] [Thread-1 (]: Began compiling node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E.4043bc552b
[0m10:28:30.745306 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657'
[0m10:28:30.746193 [debug] [Thread-2 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:28:30.747037 [debug] [Thread-3 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:28:30.760813 [debug] [Thread-1 (]: Writing injected SQL for node "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E.4043bc552b"
[0m10:28:30.761667 [debug] [Thread-4 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:28:30.781183 [debug] [Thread-2 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:28:30.782518 [debug] [Thread-3 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:28:30.788806 [debug] [Thread-4 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:28:30.790044 [debug] [Thread-1 (]: Began executing node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E.4043bc552b
[0m10:28:30.801400 [debug] [Thread-4 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:28:30.807516 [debug] [Thread-2 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:28:30.836584 [debug] [Thread-1 (]: Writing runtime sql for node "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E.4043bc552b"
[0m10:28:30.837412 [debug] [Thread-3 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:28:30.841887 [debug] [Thread-2 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:28:30.852605 [debug] [Thread-3 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:28:30.860269 [debug] [Thread-4 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:28:30.861434 [debug] [Thread-1 (]: Using postgres connection "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E.4043bc552b"
[0m10:28:30.862108 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E.4043bc552b: BEGIN
[0m10:28:30.862656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:30.863278 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:28:30.864627 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:28:30.865978 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: BEGIN
[0m10:28:30.866704 [debug] [Thread-4 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:28:30.867460 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: BEGIN
[0m10:28:30.868112 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:28:30.868832 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: BEGIN
[0m10:28:30.869493 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:28:30.870374 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:28:30.873149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m10:28:30.874142 [debug] [Thread-1 (]: Using postgres connection "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E.4043bc552b"
[0m10:28:30.875027 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E.4043bc552b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E.4043bc552b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rank_floor_size as value_field,
        count(*) as n_records

    from "foo"."zap"."gold_floorsize_ranked_avg_prices"
    group by rank_floor_size

)

select *
from all_values
where value_field not in (
    'A','B','C','D','E'
)



      
    ) dbt_internal_test
[0m10:28:30.876731 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "rank_floor_size" does not exist
LINE 14:         rank_floor_size as value_field,
                 ^

[0m10:28:30.877450 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E.4043bc552b: ROLLBACK
[0m10:28:30.878639 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E.4043bc552b: Close
[0m10:28:30.879454 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m10:28:30.880217 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m10:28:30.881343 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m10:28:30.882033 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:28:30.882725 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:28:30.883821 [debug] [Thread-4 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:28:30.884852 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select floor_size
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where floor_size is null



      
    ) dbt_internal_test
[0m10:28:30.885714 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where id is null



      
    ) dbt_internal_test
[0m10:28:30.886817 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select kind
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where kind is null



      
    ) dbt_internal_test
[0m10:28:30.889032 [debug] [Thread-1 (]: Database Error in test accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E (models/mart/schema.yml)
  column "rank_floor_size" does not exist
  LINE 14:         rank_floor_size as value_field,
                   ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/accepted_values_gold_floorsize_abf9e25af045af9933939922b9292979.sql
[0m10:28:30.890251 [error] [Thread-1 (]: 1 of 6 ERROR accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E  [[31mERROR[0m in 0.15s]
[0m10:28:30.891670 [debug] [Thread-1 (]: Finished running node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E.4043bc552b
[0m10:28:30.892494 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:28:30.893116 [debug] [Thread-1 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.8035a3f934
[0m10:28:30.893667 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:28:30.894209 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m10:28:30.894945 [debug] [Thread-7 (]: Marking all children of 'test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E.4043bc552b' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E (models/mart/schema.yml)
  column "rank_floor_size" does not exist
  LINE 14:         rank_floor_size as value_field,
                   ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/accepted_values_gold_floorsize_abf9e25af045af9933939922b9292979.sql.
[0m10:28:30.902252 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: ROLLBACK
[0m10:28:30.903221 [info ] [Thread-1 (]: 5 of 6 START test not_null_gold_floorsize_ranked_avg_prices_rank_floor_size .... [RUN]
[0m10:28:30.905602 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: ROLLBACK
[0m10:28:30.908984 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: ROLLBACK
[0m10:28:30.911504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E.4043bc552b, now test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.8035a3f934)
[0m10:28:30.912179 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: Close
[0m10:28:30.912938 [debug] [Thread-1 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.8035a3f934
[0m10:28:30.913576 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: Close
[0m10:28:30.914269 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: Close
[0m10:28:30.922985 [debug] [Thread-1 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.8035a3f934"
[0m10:28:30.920547 [info ] [Thread-4 (]: 4 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_kind ..................... [[32mPASS[0m in 0.18s]
[0m10:28:30.924677 [info ] [Thread-3 (]: 3 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_id ....................... [[32mPASS[0m in 0.18s]
[0m10:28:30.927368 [debug] [Thread-4 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:28:30.926216 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_floor_size ............... [[32mPASS[0m in 0.19s]
[0m10:28:30.928616 [debug] [Thread-3 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:28:30.929291 [debug] [Thread-4 (]: Began running node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:28:30.929856 [debug] [Thread-1 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.8035a3f934
[0m10:28:30.930699 [debug] [Thread-2 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:28:30.931807 [info ] [Thread-4 (]: 6 of 6 START test unique_gold_floorsize_ranked_avg_prices_id ................... [RUN]
[0m10:28:30.936617 [debug] [Thread-1 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.8035a3f934"
[0m10:28:30.938118 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657, now test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844)
[0m10:28:30.939348 [debug] [Thread-4 (]: Began compiling node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:28:30.948866 [debug] [Thread-4 (]: Writing injected SQL for node "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:28:30.949887 [debug] [Thread-1 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.8035a3f934"
[0m10:28:30.951534 [debug] [Thread-1 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.8035a3f934: BEGIN
[0m10:28:30.952402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:30.953684 [debug] [Thread-4 (]: Began executing node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:28:30.958332 [debug] [Thread-4 (]: Writing runtime sql for node "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:28:30.959453 [debug] [Thread-4 (]: Using postgres connection "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:28:30.960068 [debug] [Thread-4 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: BEGIN
[0m10:28:30.960568 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:28:30.962442 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m10:28:30.963247 [debug] [Thread-1 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.8035a3f934"
[0m10:28:30.963872 [debug] [Thread-1 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.8035a3f934: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.8035a3f934"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rank_floor_size
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where rank_floor_size is null



      
    ) dbt_internal_test
[0m10:28:30.965706 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "rank_floor_size" does not exist
LINE 13: select rank_floor_size
                ^

[0m10:28:30.966372 [debug] [Thread-1 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.8035a3f934: ROLLBACK
[0m10:28:30.967455 [debug] [Thread-1 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.8035a3f934: Close
[0m10:28:30.969209 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m10:28:30.970149 [debug] [Thread-4 (]: Using postgres connection "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:28:30.971006 [debug] [Thread-4 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:28:30.972152 [debug] [Thread-1 (]: Database Error in test not_null_gold_floorsize_ranked_avg_prices_rank_floor_size (models/mart/schema.yml)
  column "rank_floor_size" does not exist
  LINE 13: select rank_floor_size
                  ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.sql
[0m10:28:30.973110 [error] [Thread-1 (]: 5 of 6 ERROR not_null_gold_floorsize_ranked_avg_prices_rank_floor_size ......... [[31mERROR[0m in 0.06s]
[0m10:28:30.974155 [debug] [Thread-1 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.8035a3f934
[0m10:28:30.975032 [debug] [Thread-7 (]: Marking all children of 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.8035a3f934' to be skipped because of status 'error'.  Reason: Database Error in test not_null_gold_floorsize_ranked_avg_prices_rank_floor_size (models/mart/schema.yml)
  column "rank_floor_size" does not exist
  LINE 13: select rank_floor_size
                  ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.sql.
[0m10:28:31.001521 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.030 seconds
[0m10:28:31.004264 [debug] [Thread-4 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: ROLLBACK
[0m10:28:31.005307 [debug] [Thread-4 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: Close
[0m10:28:31.006571 [info ] [Thread-4 (]: 6 of 6 PASS unique_gold_floorsize_ranked_avg_prices_id ......................... [[32mPASS[0m in 0.07s]
[0m10:28:31.007946 [debug] [Thread-4 (]: Finished running node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:28:31.010017 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:31.010777 [debug] [MainThread]: On master: BEGIN
[0m10:28:31.011285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:28:31.021523 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m10:28:31.022386 [debug] [MainThread]: On master: COMMIT
[0m10:28:31.023187 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:31.023743 [debug] [MainThread]: On master: COMMIT
[0m10:28:31.024696 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:28:31.025440 [debug] [MainThread]: On master: Close
[0m10:28:31.026554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:31.027269 [debug] [MainThread]: Connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.8035a3f934' was properly closed.
[0m10:28:31.027850 [debug] [MainThread]: Connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373' was properly closed.
[0m10:28:31.028387 [debug] [MainThread]: Connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3' was properly closed.
[0m10:28:31.028905 [debug] [MainThread]: Connection 'test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844' was properly closed.
[0m10:28:31.029672 [info ] [MainThread]: 
[0m10:28:31.030412 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m10:28:31.032501 [debug] [MainThread]: Command end result
[0m10:28:31.063096 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:28:31.065251 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:28:31.075996 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m10:28:31.076598 [info ] [MainThread]: 
[0m10:28:31.077171 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m10:28:31.077669 [info ] [MainThread]: 
[0m10:28:31.078230 [error] [MainThread]:   Database Error in test accepted_values_gold_floorsize_ranked_avg_prices_rank_floor_size__A__B__C__D__E (models/mart/schema.yml)
  column "rank_floor_size" does not exist
  LINE 14:         rank_floor_size as value_field,
                   ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/accepted_values_gold_floorsize_abf9e25af045af9933939922b9292979.sql
[0m10:28:31.078711 [info ] [MainThread]: 
[0m10:28:31.079253 [error] [MainThread]:   Database Error in test not_null_gold_floorsize_ranked_avg_prices_rank_floor_size (models/mart/schema.yml)
  column "rank_floor_size" does not exist
  LINE 13: select rank_floor_size
                  ^
  compiled code at target/run/zap_imoveis/models/mart/schema.yml/not_null_gold_floorsize_ranked_avg_prices_rank_floor_size.sql
[0m10:28:31.079724 [info ] [MainThread]: 
[0m10:28:31.080221 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m10:28:31.081363 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.9659271, "process_in_blocks": "0", "process_kernel_time": 0.225892, "process_mem_max_rss": "120000", "process_out_blocks": "2768", "process_user_time": 3.220471}
[0m10:28:31.082000 [debug] [MainThread]: Command `dbt test` failed at 10:28:31.081899 after 1.97 seconds
[0m10:28:31.082522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1167a7cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1165cb20e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1165cb22f0>]}
[0m10:28:31.083171 [debug] [MainThread]: Flushing usage events
[0m10:28:32.377911 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:28:55.163846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cc6b94ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cc7a3e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cc7a3e4d0>]}


============================== 10:28:55.167092 | badfcb7c-5528-4a8d-bd86-93babb078b47 ==============================
[0m10:28:55.167092 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:28:55.167943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:28:55.380386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'badfcb7c-5528-4a8d-bd86-93babb078b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cc7a107f0>]}
[0m10:28:55.460957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'badfcb7c-5528-4a8d-bd86-93babb078b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cc637af80>]}
[0m10:28:55.462064 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:28:55.595804 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:28:55.778382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:28:55.779472 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/schema.yml
[0m10:28:56.356473 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_apartment_avg_prices
- models.mart.gold_flats_avg_prices
[0m10:28:56.377396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'badfcb7c-5528-4a8d-bd86-93babb078b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cc4889870>]}
[0m10:28:56.508719 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:28:56.512967 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:28:56.594775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'badfcb7c-5528-4a8d-bd86-93babb078b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cc4de6440>]}
[0m10:28:56.595585 [info ] [MainThread]: Found 1 model, 6 data tests, 1 source, 431 macros
[0m10:28:56.596124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'badfcb7c-5528-4a8d-bd86-93babb078b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cc4de5d20>]}
[0m10:28:56.598597 [info ] [MainThread]: 
[0m10:28:56.599241 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:28:56.599728 [info ] [MainThread]: 
[0m10:28:56.600508 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:28:56.602283 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo_zap'
[0m10:28:56.648770 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:28:56.649433 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m10:28:56.649915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:56.661161 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m10:28:56.661794 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m10:28:56.662720 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m10:28:56.666612 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m10:28:56.668649 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m10:28:56.669484 [debug] [ThreadPool]: On list_foo_zap: Close
[0m10:28:56.676795 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:56.677390 [debug] [MainThread]: On master: BEGIN
[0m10:28:56.677835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:28:56.686293 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:28:56.686898 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:56.687428 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:28:56.692534 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m10:28:56.695508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'badfcb7c-5528-4a8d-bd86-93babb078b47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cc4dcb2e0>]}
[0m10:28:56.696180 [debug] [MainThread]: On master: ROLLBACK
[0m10:28:56.696957 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:56.697466 [debug] [MainThread]: On master: BEGIN
[0m10:28:56.698359 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:28:56.698929 [debug] [MainThread]: On master: COMMIT
[0m10:28:56.699486 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:56.699947 [debug] [MainThread]: On master: COMMIT
[0m10:28:56.700629 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:28:56.701226 [debug] [MainThread]: On master: Close
[0m10:28:56.704633 [debug] [Thread-1 (]: Began running node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E.ccbcdeb990
[0m10:28:56.705592 [debug] [Thread-2 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:28:56.706270 [debug] [Thread-3 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size_rank.feee96cde9
[0m10:28:56.706943 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E  [RUN]
[0m10:28:56.707999 [debug] [Thread-4 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:28:56.708685 [info ] [Thread-2 (]: 2 of 6 START test not_null_gold_floorsize_ranked_avg_prices_floor_size ......... [RUN]
[0m10:28:56.709483 [info ] [Thread-3 (]: 3 of 6 START test not_null_gold_floorsize_ranked_avg_prices_floor_size_rank .... [RUN]
[0m10:28:56.710624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E.ccbcdeb990)
[0m10:28:56.711579 [info ] [Thread-4 (]: 4 of 6 START test not_null_gold_floorsize_ranked_avg_prices_id ................. [RUN]
[0m10:28:56.713956 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373'
[0m10:28:56.715157 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size_rank.feee96cde9'
[0m10:28:56.716183 [debug] [Thread-1 (]: Began compiling node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E.ccbcdeb990
[0m10:28:56.717524 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3'
[0m10:28:56.718538 [debug] [Thread-2 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:28:56.719482 [debug] [Thread-3 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size_rank.feee96cde9
[0m10:28:56.730631 [debug] [Thread-4 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:28:56.734173 [debug] [Thread-1 (]: Writing injected SQL for node "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E.ccbcdeb990"
[0m10:28:56.752864 [debug] [Thread-2 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:28:56.755348 [debug] [Thread-3 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size_rank.feee96cde9"
[0m10:28:56.762809 [debug] [Thread-4 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:28:56.764531 [debug] [Thread-1 (]: Began executing node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E.ccbcdeb990
[0m10:28:56.765696 [debug] [Thread-2 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:28:56.766381 [debug] [Thread-3 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size_rank.feee96cde9
[0m10:28:56.794815 [debug] [Thread-4 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:28:56.810862 [debug] [Thread-1 (]: Writing runtime sql for node "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E.ccbcdeb990"
[0m10:28:56.814999 [debug] [Thread-3 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size_rank.feee96cde9"
[0m10:28:56.816693 [debug] [Thread-2 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:28:56.820873 [debug] [Thread-4 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:28:56.822672 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:28:56.823366 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size_rank.feee96cde9"
[0m10:28:56.823953 [debug] [Thread-1 (]: Using postgres connection "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E.ccbcdeb990"
[0m10:28:56.824606 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: BEGIN
[0m10:28:56.825203 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size_rank.feee96cde9: BEGIN
[0m10:28:56.825874 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E.ccbcdeb990: BEGIN
[0m10:28:56.826555 [debug] [Thread-4 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:28:56.827123 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:28:56.828225 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:28:56.828822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:28:56.829597 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: BEGIN
[0m10:28:56.831585 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:28:56.839077 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m10:28:56.840040 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"
[0m10:28:56.840878 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select floor_size
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where floor_size is null



      
    ) dbt_internal_test
[0m10:28:56.841676 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m10:28:56.842580 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m10:28:56.843230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m10:28:56.844313 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size_rank.feee96cde9"
[0m10:28:56.845149 [debug] [Thread-4 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"
[0m10:28:56.846140 [debug] [Thread-1 (]: Using postgres connection "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E.ccbcdeb990"
[0m10:28:56.847338 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:28:56.847933 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size_rank.feee96cde9: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size_rank.feee96cde9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select floor_size_rank
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where floor_size_rank is null



      
    ) dbt_internal_test
[0m10:28:56.848911 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where id is null



      
    ) dbt_internal_test
[0m10:28:56.850022 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E.ccbcdeb990: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E.ccbcdeb990"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        floor_size_rank as value_field,
        count(*) as n_records

    from "foo"."zap"."gold_floorsize_ranked_avg_prices"
    group by floor_size_rank

)

select *
from all_values
where value_field not in (
    'A','B','C','D','E'
)



      
    ) dbt_internal_test
[0m10:28:56.855972 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: ROLLBACK
[0m10:28:56.857349 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373: Close
[0m10:28:56.858914 [info ] [Thread-2 (]: 2 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_floor_size ............... [[32mPASS[0m in 0.15s]
[0m10:28:56.860312 [debug] [Thread-2 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373
[0m10:28:56.861246 [debug] [Thread-2 (]: Began running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:28:56.862164 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:28:56.862884 [info ] [Thread-2 (]: 5 of 6 START test not_null_gold_floorsize_ranked_avg_prices_kind ............... [RUN]
[0m10:28:56.863558 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m10:28:56.864189 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m10:28:56.866904 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size_rank.feee96cde9: ROLLBACK
[0m10:28:56.868275 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size.be20089373, now test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657)
[0m10:28:56.871239 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: ROLLBACK
[0m10:28:56.873290 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E.ccbcdeb990: ROLLBACK
[0m10:28:56.874367 [debug] [Thread-2 (]: Began compiling node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:28:56.875189 [debug] [Thread-3 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size_rank.feee96cde9: Close
[0m10:28:56.881567 [debug] [Thread-4 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3: Close
[0m10:28:56.883575 [debug] [Thread-2 (]: Writing injected SQL for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:28:56.884172 [debug] [Thread-1 (]: On test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E.ccbcdeb990: Close
[0m10:28:56.886358 [info ] [Thread-3 (]: 3 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_floor_size_rank .......... [[32mPASS[0m in 0.17s]
[0m10:28:56.887785 [info ] [Thread-4 (]: 4 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_id ....................... [[32mPASS[0m in 0.17s]
[0m10:28:56.889696 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E  [[32mPASS[0m in 0.18s]
[0m10:28:56.890689 [debug] [Thread-2 (]: Began executing node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:28:56.891640 [debug] [Thread-3 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size_rank.feee96cde9
[0m10:28:56.892740 [debug] [Thread-4 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3
[0m10:28:56.894013 [debug] [Thread-1 (]: Finished running node test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E.ccbcdeb990
[0m10:28:56.897892 [debug] [Thread-2 (]: Writing runtime sql for node "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:28:56.898681 [debug] [Thread-3 (]: Began running node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:28:56.900440 [info ] [Thread-3 (]: 6 of 6 START test unique_gold_floorsize_ranked_avg_prices_id ................... [RUN]
[0m10:28:56.901567 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_floor_size_rank.feee96cde9, now test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844)
[0m10:28:56.902515 [debug] [Thread-3 (]: Began compiling node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:28:56.903361 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:28:56.913313 [debug] [Thread-3 (]: Writing injected SQL for node "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:28:56.913996 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: BEGIN
[0m10:28:56.914726 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:28:56.915707 [debug] [Thread-3 (]: Began executing node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:28:56.920593 [debug] [Thread-3 (]: Writing runtime sql for node "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:28:56.922143 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:28:56.922998 [debug] [Thread-3 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: BEGIN
[0m10:28:56.923756 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:28:56.924593 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m10:28:56.925493 [debug] [Thread-2 (]: Using postgres connection "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"
[0m10:28:56.926221 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select kind
from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where kind is null



      
    ) dbt_internal_test
[0m10:28:56.931446 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m10:28:56.933613 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: ROLLBACK
[0m10:28:56.934862 [debug] [Thread-2 (]: On test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657: Close
[0m10:28:56.935849 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m10:28:56.936940 [debug] [Thread-3 (]: Using postgres connection "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"
[0m10:28:56.938105 [info ] [Thread-2 (]: 5 of 6 PASS not_null_gold_floorsize_ranked_avg_prices_kind ..................... [[32mPASS[0m in 0.07s]
[0m10:28:56.938878 [debug] [Thread-3 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "foo"."zap"."gold_floorsize_ranked_avg_prices"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:28:56.939783 [debug] [Thread-2 (]: Finished running node test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657
[0m10:28:56.971799 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.031 seconds
[0m10:28:56.973829 [debug] [Thread-3 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: ROLLBACK
[0m10:28:56.974804 [debug] [Thread-3 (]: On test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844: Close
[0m10:28:56.976126 [info ] [Thread-3 (]: 6 of 6 PASS unique_gold_floorsize_ranked_avg_prices_id ......................... [[32mPASS[0m in 0.07s]
[0m10:28:56.977186 [debug] [Thread-3 (]: Finished running node test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844
[0m10:28:56.978798 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:56.979415 [debug] [MainThread]: On master: BEGIN
[0m10:28:56.979911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:28:56.989693 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m10:28:56.990534 [debug] [MainThread]: On master: COMMIT
[0m10:28:56.991277 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:56.991811 [debug] [MainThread]: On master: COMMIT
[0m10:28:56.992514 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:28:56.993037 [debug] [MainThread]: On master: Close
[0m10:28:56.993813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:56.994328 [debug] [MainThread]: Connection 'test.zap_imoveis.accepted_values_gold_floorsize_ranked_avg_prices_floor_size_rank__A__B__C__D__E.ccbcdeb990' was properly closed.
[0m10:28:56.994781 [debug] [MainThread]: Connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_kind.241f69b657' was properly closed.
[0m10:28:56.995223 [debug] [MainThread]: Connection 'test.zap_imoveis.unique_gold_floorsize_ranked_avg_prices_id.c03f700844' was properly closed.
[0m10:28:56.995646 [debug] [MainThread]: Connection 'test.zap_imoveis.not_null_gold_floorsize_ranked_avg_prices_id.21190e60b3' was properly closed.
[0m10:28:56.996190 [info ] [MainThread]: 
[0m10:28:56.996713 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m10:28:56.998684 [debug] [MainThread]: Command end result
[0m10:28:57.031026 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m10:28:57.033101 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m10:28:57.044449 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m10:28:57.045049 [info ] [MainThread]: 
[0m10:28:57.045604 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:28:57.046121 [info ] [MainThread]: 
[0m10:28:57.046621 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:28:57.047815 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.9566416, "process_in_blocks": "0", "process_kernel_time": 0.185732, "process_mem_max_rss": "118828", "process_out_blocks": "2768", "process_user_time": 3.232342}
[0m10:28:57.048457 [debug] [MainThread]: Command `dbt test` succeeded at 10:28:57.048351 after 1.96 seconds
[0m10:28:57.049006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cc6b94ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cc4836680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721cc4836920>]}
[0m10:28:57.049541 [debug] [MainThread]: Flushing usage events
[0m10:28:58.495177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:54:50.671439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b94b0d50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b94bf6a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b94bf6a530>]}


============================== 22:54:50.677424 | 86f61f08-6d0d-4931-b167-e3326c7f3da7 ==============================
[0m22:54:50.677424 [info ] [MainThread]: Running with dbt=1.9.2
[0m22:54:50.678502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/WebScrap/ZAP_IMOVEIS', 'log_path': '/home/peon/projects/WebScrap/ZAP_IMOVEIS/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:54:50.956756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86f61f08-6d0d-4931-b167-e3326c7f3da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b94bf0df60>]}
[0m22:54:51.080399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86f61f08-6d0d-4931-b167-e3326c7f3da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b94a404cd0>]}
[0m22:54:51.082909 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:54:51.246330 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m22:54:51.565279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:54:51.567365 [debug] [MainThread]: Partial parsing: updated file: zap_imoveis://models/mart/schema.yml
[0m22:54:52.409595 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart.gold_flats_avg_prices
- models.mart.gold_apartment_avg_prices
[0m22:54:52.440977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86f61f08-6d0d-4931-b167-e3326c7f3da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b948e958d0>]}
[0m22:54:52.589770 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m22:54:52.595539 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m22:54:52.625978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86f61f08-6d0d-4931-b167-e3326c7f3da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b948e60c70>]}
[0m22:54:52.626849 [info ] [MainThread]: Found 1 model, 6 data tests, 1 source, 431 macros
[0m22:54:52.627711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86f61f08-6d0d-4931-b167-e3326c7f3da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b948e60be0>]}
[0m22:54:52.630268 [info ] [MainThread]: 
[0m22:54:52.631163 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:54:52.631943 [info ] [MainThread]: 
[0m22:54:52.633003 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:54:52.634764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m22:54:52.771801 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m22:54:52.772658 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m22:54:52.773846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:52.784308 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m22:54:52.786288 [debug] [ThreadPool]: On list_foo: Close
[0m22:54:52.788320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_zap)
[0m22:54:52.799313 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m22:54:52.799982 [debug] [ThreadPool]: On list_foo_zap: BEGIN
[0m22:54:52.800512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:54:52.809190 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m22:54:52.810009 [debug] [ThreadPool]: Using postgres connection "list_foo_zap"
[0m22:54:52.810697 [debug] [ThreadPool]: On list_foo_zap: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "list_foo_zap"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'zap'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'zap'
  
[0m22:54:52.816516 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m22:54:52.818692 [debug] [ThreadPool]: On list_foo_zap: ROLLBACK
[0m22:54:52.819761 [debug] [ThreadPool]: On list_foo_zap: Close
[0m22:54:52.828419 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:52.829263 [debug] [MainThread]: On master: BEGIN
[0m22:54:52.830011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:54:52.838842 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m22:54:52.839914 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:52.841229 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:54:52.845845 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m22:54:52.848191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86f61f08-6d0d-4931-b167-e3326c7f3da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9493eb9a0>]}
[0m22:54:52.849147 [debug] [MainThread]: On master: ROLLBACK
[0m22:54:52.850229 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:52.851076 [debug] [MainThread]: On master: BEGIN
[0m22:54:52.852138 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:54:52.852890 [debug] [MainThread]: On master: COMMIT
[0m22:54:52.853681 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:52.854456 [debug] [MainThread]: On master: COMMIT
[0m22:54:52.855526 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:54:52.856493 [debug] [MainThread]: On master: Close
[0m22:54:52.860294 [debug] [Thread-1 (]: Began running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m22:54:52.861549 [info ] [Thread-1 (]: 1 of 1 START sql view model zap.gold_floorsize_ranked_avg_prices ............... [RUN]
[0m22:54:52.862601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_zap, now model.zap_imoveis.gold_floorsize_ranked_avg_prices)
[0m22:54:52.863446 [debug] [Thread-1 (]: Began compiling node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m22:54:52.877689 [debug] [Thread-1 (]: Writing injected SQL for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m22:54:52.878898 [debug] [Thread-1 (]: Began executing node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m22:54:52.944134 [debug] [Thread-1 (]: Writing runtime sql for node "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m22:54:52.945339 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m22:54:52.946018 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: BEGIN
[0m22:54:52.946588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:52.956535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m22:54:52.957644 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m22:54:52.958430 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */

  create view "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."zap"."silver_zapimoveis" 
),
rank_floorsize as (
	select 
	*, 
	case 
		when sz.floor_size <= 30
		then 'E'
		when sz.floor_size <= 60
		then 'D'
		when sz.floor_size <= 90
		then 'C'
		when sz.floor_size <= 120
		then 'B'
        WHEN sz.floor_size > 120
        THEN 'A'
	end as floor_size_rank
	from source sz 
)
select
*,
price_rent/floor_size as price_rent_per_m2
from rank_floorsize 
order by price_rent_per_m2
  );
[0m22:54:52.963786 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:54:52.973813 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m22:54:52.974757 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
alter table "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_tmp" rename to "gold_floorsize_ranked_avg_prices"
[0m22:54:52.976119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:54:52.998792 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m22:54:52.999572 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m22:54:53.000174 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: COMMIT
[0m22:54:53.002181 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:54:53.013179 [debug] [Thread-1 (]: Applying DROP to: "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup"
[0m22:54:53.020261 [debug] [Thread-1 (]: Using postgres connection "model.zap_imoveis.gold_floorsize_ranked_avg_prices"
[0m22:54:53.020994 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "zap", "target_name": "dev", "node_id": "model.zap_imoveis.gold_floorsize_ranked_avg_prices"} */
drop view if exists "foo"."zap"."gold_floorsize_ranked_avg_prices__dbt_backup" cascade
[0m22:54:53.022017 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:54:53.026693 [debug] [Thread-1 (]: On model.zap_imoveis.gold_floorsize_ranked_avg_prices: Close
[0m22:54:53.030872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86f61f08-6d0d-4931-b167-e3326c7f3da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b94c0b6dd0>]}
[0m22:54:53.031995 [info ] [Thread-1 (]: 1 of 1 OK created sql view model zap.gold_floorsize_ranked_avg_prices .......... [[32mCREATE VIEW[0m in 0.17s]
[0m22:54:53.033054 [debug] [Thread-1 (]: Finished running node model.zap_imoveis.gold_floorsize_ranked_avg_prices
[0m22:54:53.034660 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:53.035339 [debug] [MainThread]: On master: BEGIN
[0m22:54:53.035991 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:54:53.044970 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m22:54:53.045639 [debug] [MainThread]: On master: COMMIT
[0m22:54:53.046184 [debug] [MainThread]: Using postgres connection "master"
[0m22:54:53.046706 [debug] [MainThread]: On master: COMMIT
[0m22:54:53.047420 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:54:53.048030 [debug] [MainThread]: On master: Close
[0m22:54:53.048925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:54:53.049543 [debug] [MainThread]: Connection 'model.zap_imoveis.gold_floorsize_ranked_avg_prices' was properly closed.
[0m22:54:53.050126 [info ] [MainThread]: 
[0m22:54:53.050767 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m22:54:53.051988 [debug] [MainThread]: Command end result
[0m22:54:53.082900 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/manifest.json
[0m22:54:53.085190 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/semantic_manifest.json
[0m22:54:53.094970 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/WebScrap/ZAP_IMOVEIS/target/run_results.json
[0m22:54:53.095585 [info ] [MainThread]: 
[0m22:54:53.096193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:54:53.096796 [info ] [MainThread]: 
[0m22:54:53.097504 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:54:53.098838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5219984, "process_in_blocks": "39416", "process_kernel_time": 0.320431, "process_mem_max_rss": "115704", "process_out_blocks": "2640", "process_user_time": 4.39664}
[0m22:54:53.099553 [debug] [MainThread]: Command `dbt run` succeeded at 22:54:53.099438 after 2.52 seconds
[0m22:54:53.100124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b94b0d50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b94a3f2f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b94a3f3d00>]}
[0m22:54:53.100873 [debug] [MainThread]: Flushing usage events
[0m22:54:54.187423 [debug] [MainThread]: An error was encountered while trying to flush usage events
